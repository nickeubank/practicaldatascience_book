
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Merging Data to Understand the Relationship between Drug Legalization and Violent Crime &#8212; Practical Data Science with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MC77BKR89Z"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MC77BKR89Z');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MC77BKR89Z');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ids720_specific/exercises/Solutions_merging';</script>
    <link rel="icon" href="../../_static/mids_logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Practical Data Science with Python - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Practical Data Science with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Practical Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">IDS 720</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../class_schedule_720.html">Class Schedule</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting Up Your Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_python.html">Setting Up Python and conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_vscode.html">Setting Up VS Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_augmented_commandline.html">Augmenting Your Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/jupyter_in_vscode.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/jupyter_r_notebooks.html">VS Code, R, and Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Command Line</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/commandline_part1.html">Command Line Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/commandline_part2.html">Advanced Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/git_and_github.html">Git and Github</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numpy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_2/10_why_numpy.html">Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/20_intro_to_vectors.html">Working with Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/21_math_with_vectors.html">Doing Math With Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/23_type_promotion_in_vectors.html">Type Promotion in numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/10_speed_and_ease_of_use.html">The Python Ease of Use / Speed Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/11_vectorization.html">Vectorization in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/24_vector_recap.html">Vector Recap</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_2/30_subsetting_vectors.html">Subsetting Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/35_modifying_subsets_of_vectors.html">Modifying Subsets of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/37_vector_subsets_recap.html">Recap</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/10_views_and_copies.html">Views and Copies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/11_when_do_I_get_a_view.html">When Do I Get a View and When Do I Get a Copy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/13_objects_and_variables.html">Variables are pointers to objects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/12_views_and_copies_recap.html">Review of Views and Copies</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/00_welcome_to_week_3.html">Matrices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/20_matrices.html">Intro to Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/22_reshaping_matrices.html">Folding and Reshaping Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/25_images_as_matrices.html">Matrices as Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/30_subsetting_matrices.html">Subsetting Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/32_modifying_subsets.html">Editing Subsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/33_matrix_recaps.html">Review of Matrices</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/40_nd_arrays.html">Arrays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/41_broadcasting.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/42_nd_array_review.html">Review of ND-Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/03_summarizing_arrays.html">Summarizing Arrays</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/04_summarizing_arrays_example.html">Practical Example: comparing weather by counting like-values</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/04.1_color_images_as_arrays.html">Color Images as Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_4/20_random_numbers.html">Random numbers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_2/00_intro_to_pandas.html">Welcome to Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/10_pandas_series.html">Pandas Series</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/15_manipulating_series.html">Subsetting and Indexing Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/16_indexing_with_brackets.html">(OPTIONAL) Subsetting and Indexing with Single Square Brackets (<code class="docutils literal notranslate"><span class="pre">[]</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/18_object_dtype.html">The <code class="docutils literal notranslate"><span class="pre">object</span></code> Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/30_pandas_dataframes.html">Working with tabular data through Dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/35_pandas_dataframe_gotchas.html">Subsetting DataFrame Tricks and Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/45_categorical_dtype.html">The Categorical Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/50_pandas_pyarrow.html">PyArrow: An Alternative to Numpy as Pandas Backend</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_3/week_3/07_indices.html">Indexes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/10_views_and_copies_numpy_review.html">Views and Copies in Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/15_views_and_copies_in_pandas.html">Views and Copies in pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/17_views_and_copies_in_pandas_wo_CoW.html">The View/Copy Headache in pandas without Copy on Write</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/03_plaintext_files.html">Reading Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/05_binary_files.html">Binary Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/20_cleaning_identifying.html">Data Cleaning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/30_cleaning_editing_globally.html">Fixing Data Value Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/32_cleaning_editing_specific_locations.html">Editing Specific Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/33_cleaning_datatypes.html">Cleaning Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/35_cleaning_missing_data.html">Missing Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_4/00_intro_to_querying_data.html">Data Manipulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/10_combining_concatenating.html">Concatenating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15_combining_merging.html">Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15.1_combining_merging_continued.html">Combining datasets: merging</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15.2_combining_merging_practical_example.html">Practical Example</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15.3_validating_a_merge.html">Validating Merges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/20_grouping.html">Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/30_queries.html">Querying</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/1.1.2_effective_plotting_practices.html">Matplotlib Fundamentals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.1_basic_plotting_with_matplotlib.html">Plotting with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.2_ten_figure_pieces.html">A figure in 10 pieces</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.4.5_explicit_vs_implicit_syntax.html">Implicit vs explicit syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.4.4_saving_to_file.html">Saving to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.5.1_plotting_zoo.html">Plotting Zoo: multiple ways to visualize the same set of data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.6.1_plotting_with_pandas.html">Plotting with Pandas</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.4_bar_plots_deep_dive.html">Different Types of Plots</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.3_text.html">Plotting text (and a side note on axis scaling)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.5_stack_plots.html">Stack Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.6_pie_charts.html">Pie charts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.1_subplots.html">Subplots</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.2_subplots_deep_dive.html">Subplots: a deeper dive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.EXS_timeseries_worked_example.html">Exercise: Creating a subplot of timeseries (solution)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.EX_timeseries_worked_example.html">Exercise: Creating a subplot of timeseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7_scatter_plots_deep_dive.html">Doing more with scatter plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.8_errorbars.html">Visualizing ranges and uncertainty</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.9_heat_maps.html">Heat maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.1.EXS_histograms_solutions.html">Exercise: Analyzing Poker Hand Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.1.EX_histograms.html">Exercise: Analyzing Poker Hand Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.1_histograms.html">Histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.2_2d_histograms.html">Two Dimensional Histograms</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/2.1.1_the_matplotlib_model.html">Advanced Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.1.2_customizing_plot_styles.html">Customizing styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.1.3_plotting_zoo_restyled.html">Plotting Zoo - with style!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.2.1_making_plots_pretty_1.html">Making Plots Pretty Part 1: laying the foundation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.2.2_making_plots_pretty_2.html">Making pretty plots in Python: customizing plots in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/2.3.1_plotting_with_seaborn.html">Seaborn Objects and GoG</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.3.2_seaborn_recipes.html">Seaborn Object Recipes</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Big Data &amp; Performance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/10_big_data_what_is_it.html">What is Big Data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/20_big_data_strategies.html">Big Data Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/30_parquet.html">Parquet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/object_vectors.html">Object dtypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/50_performance_solutions.html">Solving Performance Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/60_parallelism.html">Parallel Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/70_dask.html">Distributed Computing with dask</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical Skills and Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/10_debugging_principles.html">Debugging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/20_debugging_in_vscode.html">Debugging Python in VS Code</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming.html">Defensive Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_tests.html">Testing in a Data Analysis Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_readability.html">Readability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_duplicate.html">Don’t Duplicate Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/iceberg_principle.html">The Iceberg Principle</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/workflow.html">Workflow Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/getting_help.html">Getting Help Online</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/vars_v_objects.html">Python: Variables vs. Objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/python_v_r.html">Python vs. R: Important Differences To Be Aware Of</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/backwards_design.html">Backwards Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/ints_and_floats.html">Numbers in Computers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/writing_good_jupyter_notebooks.html">Writing Good Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/pr_review.html">Reviewing Code on Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/conda_environments.html">conda Environments</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Modelling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/20_inference_v_prediction.html">Inference vs. Prediction Data Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/30_linear_regression_in_python.html">Linear Regression in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/15_brief_intro_categorical_variables.html">Categorical Variables, Indicator Variables and Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/35_pandas_to_numpy_with_patsy.html">Pulling Back the Curtain: Pandas to Numpy with patsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/40_linear_regression_extensions.html">OPTIONAL: Beyond The Basic Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Professional Advice</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/buying_datascience_computer.html">How To Buy A Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/llms.html">chatGPT and You</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/PhD_Advice.html">So You’re Thinking About a PhD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/ergonomics_and_adaptive_tech.html">Ergonomics and Adaptive Tech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/mids_electives.html">Duke Data Science Electives</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_1/00_interactive_console.html">Running Python in the VS Code Interactive Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_4/30_managing_python_packages.html">Understanding and Managing Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/other/fstrings.html">Combining numbers and text into strings: f-strings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book/issues/new?title=Issue%20on%20page%20%2Fids720_specific/exercises/Solutions_merging.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ids720_specific/exercises/Solutions_merging.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Merging Data to Understand the Relationship between Drug Legalization and Violent Crime</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradescope-autograding">Gradescope Autograding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submission-limits">Submission Limits</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-legalization-analysis">Pre-Legalization Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-validation">Merge Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-diagnostics">Merge Diagnostics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-arrest-rates">Comparing Arrest Rates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13">Exercise 13</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14">Exercise 14</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-with-2018-arrests">Comparing with 2018 Arrests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15">Exercise 15</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-16">Exercise 16</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-17">Exercise 17</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-18">Exercise 18</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-19">Exercise 19</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-in-difference-analysis">Difference in Difference Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-20">Exercise 20</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-21">Exercise 21</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-22">Exercise 22</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-23">Exercise 23</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="merging-data-to-understand-the-relationship-between-drug-legalization-and-violent-crime">
<h1>Merging Data to Understand the Relationship between Drug Legalization and Violent Crime<a class="headerlink" href="#merging-data-to-understand-the-relationship-between-drug-legalization-and-violent-crime" title="Link to this heading">#</a></h1>
<p>In recent years, many US states have decided to legalize the use of marijuana.</p>
<p>When these ideas were first proposed, there were many theories about the relationship between crime and the “War on Drugs” (the term given to US efforts to arrest drug users and dealers over the past several decades).</p>
<p>In this exercise, we’re going to test a few of those theories using drug arrest data from the state of California.</p>
<p>Though California has passed a number of laws lessening penalities for marijuana possession over the years, arguably the biggest changes were in  2010, when the state changed the penalty for possessing a small amount of marijuana from a criminal crime to a “civil” penality (meaning those found guilty only had to pay a fine, not go to jail), though possessing, selling, or producing larger quantities remained illegal. Then in 2016, the state fully legalized marijuana for recreational use, not only making possession of small amounts legal, but also creating a regulatory system for producing marijuana for sale.</p>
<p>Proponents of drug legalization have long argued that the war on drugs contributes to violent crime by creating an opportunity for drug dealers and organized crime to sell and distribute drugs, a business which tends to generate violence when gangs battle over territory. According to this theory, with drug legalization, we should see violent crime decrease after legalization in places where drug arrests had previously been common.</p>
<p><strong>To be clear,</strong> this is far from the only argument for drug legalization! It is simply the argument we are well positioned to analyze today.</p>
<section id="gradescope-autograding">
<h2>Gradescope Autograding<a class="headerlink" href="#gradescope-autograding" title="Link to this heading">#</a></h2>
<p>Please follow <a class="reference external" href="https://www.practicaldatascience.org/html/autograder_guidelines.html">all standard guidance</a> for submitting this assignment to the Gradescope autograder, including storing your solutions in a dictionary called <code class="docutils literal notranslate"><span class="pre">results</span></code> and ensuring your notebook runs from the start to completion without any errors.</p>
<p>For this assignment, please name your file <code class="docutils literal notranslate"><span class="pre">exercise_merging.ipynb</span></code> before uploading.</p>
<p>You can check that you have answers for all questions in your <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary with this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span>
    <span class="s2">&quot;ex6_validate_keyword&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex10_merged_successfully&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex16_num_obs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex17_drug_change&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex18_violent_change&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex21_diffindiff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex23_diffindiff_proportionate&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="submission-limits">
<h3>Submission Limits<a class="headerlink" href="#submission-limits" title="Link to this heading">#</a></h3>
<p>Please remember that you are <strong>only allowed three submissions to the autograder.</strong> Your last submission (if you submit 3 or fewer times), or your third submission (if you submit more than 3 times) will determine your grade Submissions that error out will <strong>not</strong> count against this total.</p>
</section>
</section>
<section id="pre-legalization-analysis">
<h2>Pre-Legalization Analysis<a class="headerlink" href="#pre-legalization-analysis" title="Link to this heading">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>We will begin by examining <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/tree/master/Example_Data/ca">county-level data on arrests from California in 2009</a>. This data is derived directly from data hosted by the <a class="reference external" href="https://openjustice.doj.ca.gov/data">Office of the California State Attorney General</a>, but please follow the github link above and download and import the file <code class="docutils literal notranslate"><span class="pre">ca_arrests_2009.csv</span></code> (don’t try and get it directly from the State Attorney General’s office).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;mode.copy_on_write&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="n">arrests_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/nickeubank/practicaldatascience&quot;</span>
    <span class="s2">&quot;/master/Example_Data/ca/ca_arrests_2009.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<p>Use your data exploration skills to get a feel for this data. If you need to, you can find the <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/blob/master/Example_Data/ca/arrests_codebook.pdf">original codebook here</a> (This data is a version of that data, but collapsed to one observation per county.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arrests_2009</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1682</td>
      <td>Alameda County</td>
      <td>4318</td>
      <td>4640</td>
      <td>5749</td>
      <td>260</td>
      <td>3502</td>
      <td>18469</td>
      <td>37247</td>
      <td>431</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1683</td>
      <td>Alpine County</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>83</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1684</td>
      <td>Amador County</td>
      <td>100</td>
      <td>59</td>
      <td>101</td>
      <td>5</td>
      <td>199</td>
      <td>464</td>
      <td>801</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1685</td>
      <td>Butte County</td>
      <td>641</td>
      <td>602</td>
      <td>542</td>
      <td>34</td>
      <td>429</td>
      <td>2248</td>
      <td>9026</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1686</td>
      <td>Calaveras County</td>
      <td>211</td>
      <td>83</td>
      <td>123</td>
      <td>14</td>
      <td>70</td>
      <td>501</td>
      <td>968</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<p>Figuring out what county has the most violent arrests isn’t very meaningful if we don’t normalize for size. A county with 10 people and 10 arrests for violent crimes is obviously worse than a county with 1,000,000 people an 11 arrests for violent crime.</p>
<p>To address this, also import <code class="docutils literal notranslate"><span class="pre">nhgis_county_populations.csv</span></code> from <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/tree/master/Example_Data/ca">the directory we’re working from</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/nickeubank/practicaldatascience/&quot;</span>
    <span class="s2">&quot;master/Example_Data/ca/nhgis_county_populations.csv&quot;</span>
<span class="p">)</span>
<span class="n">pop</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>49584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Baldwin County</td>
      <td>171997</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Barbour County</td>
      <td>29663</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Bibb County</td>
      <td>21464</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Blount County</td>
      <td>56804</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">YEAR</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>YEAR
2005-2009    3221
2013-2017    3220
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h3>
<p>Use your data exploration skills to get used to this data, and figure out how it relates to your 2009 arrest data.</p>
<blockquote>
<div><p>They’re both a the county-state level, but the sample of population is all states, not just CA, and the population data has two time periods (2005-2009 and 2013-2017).</p>
</div></blockquote>
</section>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h3>
<p>Once you feel like you have a good sense of the relation between our arrest and population data, merge the two datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is a bad merge, but what most people will likely do:</span>

<span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">arrests_2009</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h3>
<p>When merging data, the result will only be meaningful if your understanding of how the data sets you are merging relate to one another are correct. In some ways, this is obvious — for example, if the variable(s) that you are using to merge observations in the two datasets or to actually identifying observations that should be linked, then obviously merging using those variables will create a meaningless new dataset.</p>
<p>But other properties that matter are often more subtle. For example, it’s important to figure out whether your merge is a <code class="docutils literal notranslate"><span class="pre">1-to-1</span></code> merge (meaning there is only one observation of the variable you’re merging on in both datasets), a <code class="docutils literal notranslate"><span class="pre">1-to-many</span></code> merge (meaning there is only one observation of the variable you’re merging on in the first dataset, but multiple observations in the second), or a <code class="docutils literal notranslate"><span class="pre">many-to-many</span></code> merge (something you almost never do).</p>
<p>Being correct in your assumptions about these things is <em>very</em> important. If you think there’s only one observation per value of your merging variable in each dataset, but there are in fact 2, you’ll end up with two observations for each value after the merge. Moreover, not only is the structure of your data now a mess, but the fact you were wrong means you didn’t understand something about your data.</p>
<p>So before running a merge, it is critical to answer the following questions:</p>
<p>a) What variable(s) do you think will be consistent across these two datasets you can use for merging?</p>
<p>b) Do you think there will be exactly 1 observation for each value of this variable(s) in your arrest data?</p>
<p>c) Do you think there will be exactly 1 observation for each value of this variable(s) in your population data?</p>
<p>So in markdown, answer these three questions for this data.</p>
<p>Then also specify the type of merge you were hoping to accomplish as one of the following strings — <code class="docutils literal notranslate"><span class="pre">&quot;one-to-one&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;one-to-many&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;many-to-one&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;many-to-many&quot;</span></code> — in your <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex6_validate_keyword&quot;</span></code>. Assume that the first dataset we are talking about (e.g., the <code class="docutils literal notranslate"><span class="pre">one</span></code> in <code class="docutils literal notranslate"><span class="pre">one-to-many</span></code>, if that were your selection) is your arrests data and the second dataset (e.g., the <code class="docutils literal notranslate"><span class="pre">many</span></code> in <code class="docutils literal notranslate"><span class="pre">one-to-many</span></code>, if that were your selection).</p>
<blockquote>
<div><p>Most people think that <code class="docutils literal notranslate"><span class="pre">COUNTY</span></code> is consistent across the two datasets and that merging on it will result in a 1:1 merge. However, it is not.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex6_validate_keyword&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;one-to-one&quot;</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The correct merge for analyzing arrest rates in these &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;counties at one point in time is a </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex6_validate_keyword&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> merge.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The correct merge for analyzing arrest rates in these counties at one point in time is a one-to-one merge.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="merge-validation">
<h2>Merge Validation<a class="headerlink" href="#merge-validation" title="Link to this heading">#</a></h2>
<p>Because of the importance of answering these questions accurately, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides a utility for <em>validating</em> these assumptions when you do a merge: the <code class="docutils literal notranslate"><span class="pre">validate</span></code> keyword! Validate will accept <code class="docutils literal notranslate"><span class="pre">&quot;1:1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;1:m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;m:1&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;m:m&quot;</span></code>. It will then check to make sure your merge matches the type of merge you think it is. I <em>highly</em> recommend always using this option (…and not just because I’m the one who added <code class="docutils literal notranslate"><span class="pre">validate</span></code> to pandas).</p>
<p><em>Note:</em> <code class="docutils literal notranslate"><span class="pre">validate</span></code> only actually tests if observations are unique when a <code class="docutils literal notranslate"><span class="pre">1</span></code> is specified; if you do a <code class="docutils literal notranslate"><span class="pre">1:1</span></code> merge but pass <code class="docutils literal notranslate"><span class="pre">validate=&quot;1:m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">validate=&quot;m:1&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">validate=&quot;m:m&quot;</span></code>, you won’t get an error — a one-to-many merge that turns out to be a one-to-one isn’t nearly as dangerous as a one-to-one merge that turns out to be one-to-many.</p>
<section id="exercise-7">
<h3>Exercise 7<a class="headerlink" href="#exercise-7" title="Link to this heading">#</a></h3>
<p>Repeat the merge you conducted above, but this time use the <code class="docutils literal notranslate"><span class="pre">validate</span></code> to make sure your assumptions about the data were correct. If you find that you made a mistake, revise your data until the merge you think is correct actually takes place.</p>
<p>To aid the autograder, please make sure to comment out any code that generates an error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, we repeat our bad merge, which will now throw an error</span>
<span class="c1"># because county names repeat across states, AND because we have multiple years in the</span>
<span class="c1"># data:</span>

<span class="c1"># merged = pd.merge(arrests_2009, pop, on=&quot;COUNTY&quot;, validate=&quot;1:1&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop2009</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="n">pop</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2005-2009&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ca_pop2009</span> <span class="o">=</span> <span class="n">pop2009</span><span class="p">[</span><span class="n">pop2009</span><span class="o">.</span><span class="n">STATE</span> <span class="o">==</span> <span class="s2">&quot;California&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">merged_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">arrests_2009</span><span class="p">,</span> <span class="n">ca_pop2009</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-8">
<h3>Exercise 8<a class="headerlink" href="#exercise-8" title="Link to this heading">#</a></h3>
<p>Were your assumptions about the data correct? If not, what had you (implicitly) assumed when you did your merge in Exercise 5 that turned out not to be correct?</p>
<blockquote>
<div><p>Almost everyone will have assumed it was a 1:1 merge, not realizing that the population data had multiple years and that County names repeat across states.</p>
</div></blockquote>
</section>
</section>
<section id="merge-diagnostics">
<h2>Merge Diagnostics<a class="headerlink" href="#merge-diagnostics" title="Link to this heading">#</a></h2>
<section id="exercise-9">
<h3>Exercise 9<a class="headerlink" href="#exercise-9" title="Link to this heading">#</a></h3>
<p>Checking whether you are doing a 1-to-1, many-to-1, 1-to-many, or many-to-many merge is only the first type of diagnostic test you should run on <em>every</em> merge you conduct. The second test is to see if you data merged successfully!</p>
<p>To help with this, the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function in pandas offers a keyword option called <code class="docutils literal notranslate"><span class="pre">indicator</span></code>. If you set <code class="docutils literal notranslate"><span class="pre">indicator</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then pandas will add a column to the result of your merge called <code class="docutils literal notranslate"><span class="pre">_merge</span></code>. This variable will tell you, for each observation in your merged data, whether:</p>
<ul class="simple">
<li><p>that observation came from a successful merge of both datasets,</p></li>
<li><p>if that observation was in the left dataset (the first one you passed) but not the right dataset (the second one you passed), or</p></li>
<li><p>if that observation was in the right dataset but not the left.</p></li>
</ul>
<p>This allows you to quickly identify failed merges!</p>
<p>For example, suppose you had the following data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;mode.copy_on_write&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key1&quot;</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span><span class="p">],</span> <span class="s2">&quot;df1_var&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>df1_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>key1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>key2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key1&quot;</span><span class="p">,</span> <span class="s2">&quot;Key2&quot;</span><span class="p">],</span> <span class="s2">&quot;df2_var&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]})</span>
<span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>df2_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>key1</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Key2</td>
      <td>b</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now suppose you <em>expected</em> that all observations should merge when you merge these datasets (because you hadn’t noticed the typo in <code class="docutils literal notranslate"><span class="pre">df2</span></code> where <code class="docutils literal notranslate"><span class="pre">key2</span></code> has a capital <code class="docutils literal notranslate"><span class="pre">Key2</span></code>. If you just run a merge, it works without any problems:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And so you might carry on in life unaware your data is now corrupted: instead of two merged rows, you now have 3, only 1 of which merged correctly!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>df1_var</th>
      <th>df2_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Key2</td>
      <td>NaN</td>
      <td>b</td>
    </tr>
    <tr>
      <th>1</th>
      <td>key1</td>
      <td>1.0</td>
      <td>a</td>
    </tr>
    <tr>
      <th>2</th>
      <td>key2</td>
      <td>2.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When what you really wanted was:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2_correct</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df2_correct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df2</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Key2&quot;</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;key2&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2_correct</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>df1_var</th>
      <th>df2_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>key1</td>
      <td>1</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>key2</td>
      <td>2</td>
      <td>b</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>(in a small dataset, you’d quickly see you have 1 row instead of 2, but if you have millions of rows, a couple missing won’t be evident).</p>
<p>But now suppose we use the <code class="docutils literal notranslate"><span class="pre">indicator</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">new_data</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
left_only     1
right_only    1
both          1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We could immediately see that only one observation merged correct, and that one row from each dataset failed to merge!</p>
<p>Moreover, we can look at the failed merges:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_data</span><span class="p">[</span><span class="n">new_data</span><span class="o">.</span><span class="n">_merge</span> <span class="o">!=</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>df1_var</th>
      <th>df2_var</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Key2</td>
      <td>NaN</td>
      <td>b</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>2</th>
      <td>key2</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Allowing us to easily diagnose the problem.</p>
<p><strong>Note:</strong> The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> merge function allows users to decide whether to keep only observations that merge (<code class="docutils literal notranslate"><span class="pre">how='inner'</span></code>), all the observations from the first dataset pasted to merge (<code class="docutils literal notranslate"><span class="pre">how='left'</span></code>), all the observations from the second dataset passed to merge (<code class="docutils literal notranslate"><span class="pre">how='right'</span></code>), or all observations (<code class="docutils literal notranslate"><span class="pre">how='outer'</span></code>):</p>
<p><img alt="join_types" src="https://nickeubank.github.io/practicaldatascience_book/_images/3.4.15_merge_types.png" /></p>
<p>But one danger to using the more restrictive options (like the default, <code class="docutils literal notranslate"><span class="pre">how='inner'</span></code>) is that the merge throws away all the observations that fail to merge, and while this may be the <em>eventual</em> goal of your analysis, it means that you don’t get to see all the observations that failed to merge that maybe you thought <em>would</em> merge. In other words, it throws away the errors so you can’t look at them!</p>
<p>So to use <code class="docutils literal notranslate"><span class="pre">indicator</span></code> effectively, you have to:</p>
<ul class="simple">
<li><p>Not use <code class="docutils literal notranslate"><span class="pre">how=&quot;inner&quot;</span></code>, and</p></li>
<li><p>Check the values of <code class="docutils literal notranslate"><span class="pre">_merge</span></code> after your merge.</p></li>
</ul>
</section>
<section id="exercise-10">
<h3>Exercise 10<a class="headerlink" href="#exercise-10" title="Link to this heading">#</a></h3>
<p>Now repeat your previous merge using <em>both</em> the <code class="docutils literal notranslate"><span class="pre">validate</span></code> keyword <em>and</em> the <code class="docutils literal notranslate"><span class="pre">indicator</span></code> keyword with <code class="docutils literal notranslate"><span class="pre">how='outer'</span></code>.</p>
<p>How many observations successfully merged (were in both datasets)? Store the result in <code class="docutils literal notranslate"><span class="pre">results</span></code> under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex10_merged_successfully&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">arrests_2009</span><span class="p">,</span> <span class="n">ca_pop2009</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span>
<span class="p">)</span>
<span class="n">merged_2009</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          56
left_only      2
right_only     2
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex10_merged_successfully&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_2009</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;both&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex10_merged_successfully&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> observations merged correctly.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>56 observations merged correctly.
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-11">
<h3>Exercise 11<a class="headerlink" href="#exercise-11" title="Link to this heading">#</a></h3>
<p>You <em>should</em> be able to get to the point that all counties in our arrest data merge with population data. If that did not happen, can you figure out why that did not happen? Can you fix the data so that all arrest data merges with population data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_2009</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">merged_2009</span><span class="o">.</span><span class="n">_merge</span> <span class="o">!=</span> <span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="s2">&quot;_merge&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTY</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>Del Norte County</td>
      <td>left_only</td>
    </tr>
    <tr>
      <th>8</th>
      <td>DelNorte County</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Injo County</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Inyo County</td>
      <td>left_only</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca_pop2009</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ca_pop2009</span><span class="o">.</span><span class="n">COUNTY</span> <span class="o">==</span> <span class="s2">&quot;DelNorte County&quot;</span><span class="p">,</span> <span class="s2">&quot;COUNTY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Del Norte County&quot;</span>
<span class="n">ca_pop2009</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ca_pop2009</span><span class="o">.</span><span class="n">COUNTY</span> <span class="o">==</span> <span class="s2">&quot;Injo County&quot;</span><span class="p">,</span> <span class="s2">&quot;COUNTY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Inyo County&quot;</span>
<span class="n">merged_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">arrests_2009</span><span class="p">,</span> <span class="n">ca_pop2009</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span>
<span class="p">)</span>
<span class="n">merged_2009</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          58
left_only      0
right_only     0
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can write this as a test!</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">merged_2009</span><span class="o">.</span><span class="n">_merge</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="comparing-arrest-rates">
<h2>Comparing Arrest Rates<a class="headerlink" href="#comparing-arrest-rates" title="Link to this heading">#</a></h2>
<section id="exercise-12">
<h3>Exercise 12<a class="headerlink" href="#exercise-12" title="Link to this heading">#</a></h3>
<p>Now that we have arrest counts and population data, we can calculate arrest <em>rates</em>. For each county, create a new variable called <code class="docutils literal notranslate"><span class="pre">violent_arrest_rate_2009</span></code> that is the number of violent arrests for 2009 divided by the population of the county from 2005-2009, and a similar new variable called <code class="docutils literal notranslate"><span class="pre">drug_arrest_rate_2009</span></code> for drug arrests divided by population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_2009</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
      <th>Unnamed: 0_y</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>total_population</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1682</td>
      <td>Alameda County</td>
      <td>4318</td>
      <td>4640</td>
      <td>5749</td>
      <td>260</td>
      <td>3502</td>
      <td>18469</td>
      <td>37247</td>
      <td>431</td>
      <td>186</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>1457095</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1683</td>
      <td>Alpine County</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>83</td>
      <td>0</td>
      <td>187</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>1153</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1684</td>
      <td>Amador County</td>
      <td>100</td>
      <td>59</td>
      <td>101</td>
      <td>5</td>
      <td>199</td>
      <td>464</td>
      <td>801</td>
      <td>2</td>
      <td>188</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>38039</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1685</td>
      <td>Butte County</td>
      <td>641</td>
      <td>602</td>
      <td>542</td>
      <td>34</td>
      <td>429</td>
      <td>2248</td>
      <td>9026</td>
      <td>1</td>
      <td>189</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>217917</td>
      <td>both</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1686</td>
      <td>Calaveras County</td>
      <td>211</td>
      <td>83</td>
      <td>123</td>
      <td>14</td>
      <td>70</td>
      <td>501</td>
      <td>968</td>
      <td>3</td>
      <td>190</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>46548</td>
      <td>both</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">merged_2009</span><span class="p">[</span><span class="s2">&quot;VIOLENT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">merged_2009</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">merged_2009</span><span class="p">[</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">merged_2009</span><span class="p">[</span><span class="s2">&quot;F_DRUGOFF&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">merged_2009</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-13">
<h3>Exercise 13<a class="headerlink" href="#exercise-13" title="Link to this heading">#</a></h3>
<p>Make a scatter plot that shows the relationship between each county’s violent arrest rate and it’s drug arrest rate. Since we haven’t done a lot with plotting yet, feel free to plot in whatever manner feels most comfortable. The easiest, if you’re unsure, is just to use the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> inbuilt <code class="docutils literal notranslate"><span class="pre">.plot()</span></code> method. Just specify the <code class="docutils literal notranslate"><span class="pre">x</span></code> keyword with your x-axis variable, the <code class="docutils literal notranslate"><span class="pre">y</span></code> keyword with your y-axis variable, and use <code class="docutils literal notranslate"><span class="pre">kind=&quot;scatter&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_2009</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;scatter&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;violent_arrest_rate_2009&#39;, ylabel=&#39;drug_arrest_rate_2009&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/72d5fcc9494bd131ac48e09f21be5fde5e277b974f81e2f1865997193b1741eb.png" src="../../_images/72d5fcc9494bd131ac48e09f21be5fde5e277b974f81e2f1865997193b1741eb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Or if you want to be fancier and include a linear fit:</span>

<span class="kn">import</span> <span class="nn">seaborn.objects</span> <span class="k">as</span> <span class="nn">so</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>


<span class="n">f</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">so</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">merged_2009</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Dot</span><span class="p">())</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Line</span><span class="p">(),</span> <span class="n">so</span><span class="o">.</span><span class="n">PolyFit</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Violent Arrests and Drug Arrests&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">theme</span><span class="p">({</span><span class="o">**</span><span class="n">style</span><span class="o">.</span><span class="n">library</span><span class="p">[</span><span class="s2">&quot;seaborn-v0_8-whitegrid&quot;</span><span class="p">]})</span>
<span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/554c9601bc65269ebb25f2cb2a61ab82a413ee95831f6e5191905e622524483d.png"><img alt="../../_images/554c9601bc65269ebb25f2cb2a61ab82a413ee95831f6e5191905e622524483d.png" src="../../_images/554c9601bc65269ebb25f2cb2a61ab82a413ee95831f6e5191905e622524483d.png" style="width: 507.875px; height: 378.25px;" /></a>
</div>
</div>
</section>
<section id="exercise-14">
<h3>Exercise 14<a class="headerlink" href="#exercise-14" title="Link to this heading">#</a></h3>
<p>Based on this simple comparison of 2009 violent arrest rates and drug arrest rates, what might you conclude about the relationship between the illegal drug trade and violent crime?</p>
<blockquote>
<div><p>They seem positively related. Is it causal? Hmmm…</p>
</div></blockquote>
</section>
</section>
<section id="comparing-with-2018-arrests">
<h2>Comparing with 2018 Arrests<a class="headerlink" href="#comparing-with-2018-arrests" title="Link to this heading">#</a></h2>
<p>The preceding analysis can tell us about whether violent crime and the drug trade are correlated, but it doesn’t tell us much about whether they are <em>causally</em> related. It <em>could</em> be the case that people dealing drugs <em>cause</em> more violent crime, but it could also be that certain communities, for some other reason, tend to have <em>both</em> more drug sales <em>and</em> more violent crime.</p>
<p>To help answer this question, let’s examine whether violent crime arrest rates changed in response to drug legalization. In particular, let’s do this by comparing violent crime arrest rates in 2009 (before drug legalization) to violent crime arrest rates in 2018 (after drug legalization). If the illegal drug trade causes violent crime, then we would expect the violent crime rate to fall in response to drug legalization.</p>
<section id="exercise-15">
<h3>Exercise 15<a class="headerlink" href="#exercise-15" title="Link to this heading">#</a></h3>
<p>Just as we created violent arrest rates and drug arrest rates for 2009, now we want to do it for 2018. Using the data on 2018 arrests (also in the <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/tree/master/Example_Data/ca">same repository</a> we used before) and the same dataset of population data (you’ll have to use population from 2013-2017, as 2018 population data has yet to be released), create a dataset of arrest rates.</p>
<p>As before, <em>be careful with your merges!!!</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arrests_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/nickeubank/practicaldatascience/&quot;</span>
    <span class="s2">&quot;master/Example_Data/ca/ca_arrests_2018.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/nickeubank/practicaldatascience&quot;</span>
    <span class="s2">&quot;/master/Example_Data/ca/nhgis_county_populations.csv&quot;</span>
<span class="p">)</span>
<span class="n">pop</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2225</th>
      <td>2225</td>
      <td>2005-2009</td>
      <td>Oregon</td>
      <td>Klamath County</td>
      <td>66170</td>
    </tr>
    <tr>
      <th>1525</th>
      <td>1525</td>
      <td>2005-2009</td>
      <td>Missouri</td>
      <td>Hickory County</td>
      <td>9022</td>
    </tr>
    <tr>
      <th>238</th>
      <td>238</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Trinity County</td>
      <td>13922</td>
    </tr>
    <tr>
      <th>3383</th>
      <td>162</td>
      <td>2013-2017</td>
      <td>Arkansas</td>
      <td>Ouachita County</td>
      <td>24378</td>
    </tr>
    <tr>
      <th>106</th>
      <td>106</td>
      <td>2005-2009</td>
      <td>Arizona</td>
      <td>Pima County</td>
      <td>990213</td>
    </tr>
    <tr>
      <th>481</th>
      <td>481</td>
      <td>2005-2009</td>
      <td>Georgia</td>
      <td>McIntosh County</td>
      <td>11268</td>
    </tr>
    <tr>
      <th>1323</th>
      <td>1323</td>
      <td>2005-2009</td>
      <td>Minnesota</td>
      <td>Carver County</td>
      <td>88208</td>
    </tr>
    <tr>
      <th>593</th>
      <td>593</td>
      <td>2005-2009</td>
      <td>Idaho</td>
      <td>Valley County</td>
      <td>8667</td>
    </tr>
    <tr>
      <th>6349</th>
      <td>3128</td>
      <td>2013-2017</td>
      <td>Wyoming</td>
      <td>Johnson County</td>
      <td>8562</td>
    </tr>
    <tr>
      <th>200</th>
      <td>200</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Kern County</td>
      <td>780953</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop2017</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="n">pop</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2013-2017&quot;</span><span class="p">]</span>
<span class="n">ca_pop2017</span> <span class="o">=</span> <span class="n">pop2017</span><span class="p">[</span><span class="n">pop2017</span><span class="o">.</span><span class="n">STATE</span> <span class="o">==</span> <span class="s2">&quot;California&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">ca_pop2017</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ca_pop2017</span><span class="o">.</span><span class="n">COUNTY</span> <span class="o">==</span> <span class="s2">&quot;DelNorte County&quot;</span><span class="p">,</span> <span class="s2">&quot;COUNTY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Del Norte County&quot;</span>
<span class="n">ca_pop2017</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ca_pop2017</span><span class="o">.</span><span class="n">COUNTY</span> <span class="o">==</span> <span class="s2">&quot;Injo County&quot;</span><span class="p">,</span> <span class="s2">&quot;COUNTY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Inyo County&quot;</span>

<span class="n">merged_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">arrests_2018</span><span class="p">,</span> <span class="n">ca_pop2017</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span>
<span class="p">)</span>
<span class="n">merged_2018</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
      <th>Unnamed: 0_y</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>total_population</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19</th>
      <td>2223</td>
      <td>Madera County</td>
      <td>562</td>
      <td>200</td>
      <td>131</td>
      <td>33</td>
      <td>502</td>
      <td>1428</td>
      <td>4317</td>
      <td>6</td>
      <td>205</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>154440</td>
      <td>both</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2204</td>
      <td>Alameda County</td>
      <td>4132</td>
      <td>3051</td>
      <td>1062</td>
      <td>173</td>
      <td>2619</td>
      <td>11037</td>
      <td>28305</td>
      <td>82</td>
      <td>186</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>1629615</td>
      <td>both</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2224</td>
      <td>Marin County</td>
      <td>524</td>
      <td>323</td>
      <td>95</td>
      <td>31</td>
      <td>252</td>
      <td>1225</td>
      <td>5227</td>
      <td>56</td>
      <td>206</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>260814</td>
      <td>both</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2258</td>
      <td>Tuolumne County</td>
      <td>203</td>
      <td>122</td>
      <td>87</td>
      <td>9</td>
      <td>311</td>
      <td>732</td>
      <td>2019</td>
      <td>12</td>
      <td>240</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>53899</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2205</td>
      <td>Alpine County</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>41</td>
      <td>0</td>
      <td>187</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>1203</td>
      <td>both</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_2018</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">merged_2018</span><span class="p">[</span><span class="s2">&quot;VIOLENT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">merged_2018</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">merged_2018</span><span class="p">[</span><span class="s2">&quot;drug_arrest_rate_2018&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">merged_2018</span><span class="p">[</span><span class="s2">&quot;F_DRUGOFF&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">merged_2018</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">merged_2018</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
      <th>Unnamed: 0_y</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>total_population</th>
      <th>_merge</th>
      <th>violent_arrest_rate_2018</th>
      <th>drug_arrest_rate_2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2204</td>
      <td>Alameda County</td>
      <td>4132</td>
      <td>3051</td>
      <td>1062</td>
      <td>173</td>
      <td>2619</td>
      <td>11037</td>
      <td>28305</td>
      <td>82</td>
      <td>186</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>1629615</td>
      <td>both</td>
      <td>0.002536</td>
      <td>0.000652</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2205</td>
      <td>Alpine County</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>41</td>
      <td>0</td>
      <td>187</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>1203</td>
      <td>both</td>
      <td>0.004156</td>
      <td>0.000831</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2206</td>
      <td>Amador County</td>
      <td>72</td>
      <td>40</td>
      <td>31</td>
      <td>3</td>
      <td>142</td>
      <td>288</td>
      <td>701</td>
      <td>1</td>
      <td>188</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>37306</td>
      <td>both</td>
      <td>0.001930</td>
      <td>0.000831</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2207</td>
      <td>Butte County</td>
      <td>785</td>
      <td>437</td>
      <td>229</td>
      <td>47</td>
      <td>741</td>
      <td>2239</td>
      <td>8853</td>
      <td>1</td>
      <td>189</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>225207</td>
      <td>both</td>
      <td>0.003486</td>
      <td>0.001017</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2208</td>
      <td>Calaveras County</td>
      <td>147</td>
      <td>42</td>
      <td>29</td>
      <td>6</td>
      <td>96</td>
      <td>320</td>
      <td>897</td>
      <td>0</td>
      <td>190</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>45057</td>
      <td>both</td>
      <td>0.003263</td>
      <td>0.000644</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercise-16">
<h3>Exercise 16<a class="headerlink" href="#exercise-16" title="Link to this heading">#</a></h3>
<p>Now merge our two county-level datasets so you have one row for every county, and variables for violent arrest rates in 2018, violent arrest rates in 2009, felony drug arrest rates in 2018, and felony drug arrest rates in 2009. Store the number of observations in your final data set in your <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex16_num_obs&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_thinned_2009</span> <span class="o">=</span> <span class="n">merged_2009</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">,</span> <span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">,</span> <span class="s2">&quot;total_population&quot;</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">merged_thinned_2018</span> <span class="o">=</span> <span class="n">merged_2018</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">,</span> <span class="s2">&quot;drug_arrest_rate_2018&quot;</span><span class="p">,</span> <span class="s2">&quot;total_population&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">merged_thinned_2009</span> <span class="o">=</span> <span class="n">merged_thinned_2009</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;total_population&quot;</span><span class="p">:</span> <span class="s2">&quot;total_population_2009&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span>
<span class="p">)</span>
<span class="n">merged_thinned_2018</span> <span class="o">=</span> <span class="n">merged_thinned_2018</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;total_population&quot;</span><span class="p">:</span> <span class="s2">&quot;total_population_2018&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span>
<span class="p">)</span>

<span class="n">all_years</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">merged_thinned_2009</span><span class="p">,</span>
    <span class="n">merged_thinned_2018</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span>
    <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">all_years</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          58
left_only      0
right_only     0
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_years</span> <span class="o">=</span> <span class="n">all_years</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;_merge&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">all_years</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTY</th>
      <th>violent_arrest_rate_2009</th>
      <th>drug_arrest_rate_2009</th>
      <th>total_population_2009</th>
      <th>violent_arrest_rate_2018</th>
      <th>drug_arrest_rate_2018</th>
      <th>total_population_2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21</th>
      <td>Mariposa County</td>
      <td>0.003582</td>
      <td>0.002575</td>
      <td>17865</td>
      <td>0.001812</td>
      <td>0.000793</td>
      <td>17658</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Santa Cruz County</td>
      <td>0.002995</td>
      <td>0.003469</td>
      <td>251398</td>
      <td>0.002829</td>
      <td>0.000637</td>
      <td>273263</td>
    </tr>
    <tr>
      <th>8</th>
      <td>El Dorado County</td>
      <td>0.003240</td>
      <td>0.002291</td>
      <td>175941</td>
      <td>0.002594</td>
      <td>0.000551</td>
      <td>185015</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Tehama County</td>
      <td>0.003894</td>
      <td>0.007541</td>
      <td>60601</td>
      <td>0.003305</td>
      <td>0.000395</td>
      <td>63247</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Contra Costa County</td>
      <td>0.002930</td>
      <td>0.002851</td>
      <td>1015571</td>
      <td>0.002326</td>
      <td>0.000708</td>
      <td>1123678</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex16_num_obs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_years</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The final dataset has </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex16_num_obs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> counties, </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;which is also the total number of counties in California!&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The final dataset has 58 counties, 
which is also the total number of counties in California!
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-17">
<h3>Exercise 17<a class="headerlink" href="#exercise-17" title="Link to this heading">#</a></h3>
<p>Did drug arrests go down from 2009 to 2018 in response to drug legalization? (they sure better! This is what’s called a “sanity check” of your data and analysis. If you find drug arrests went <em>up</em>, you know something went wrong with your code or your understanding of the situations).</p>
<p>Store the average county-level change in drug arrests per capita in <code class="docutils literal notranslate"><span class="pre">results</span></code> under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex17_drug_change&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_years</span><span class="p">[</span><span class="s2">&quot;change_in_drug_2018_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">all_years</span><span class="o">.</span><span class="n">drug_arrest_rate_2018</span> <span class="o">-</span> <span class="n">all_years</span><span class="o">.</span><span class="n">drug_arrest_rate_2009</span>
<span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex17_drug_change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_years</span><span class="p">[</span><span class="s2">&quot;change_in_drug_2018_2009&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;On average, California counties experienced a change in the average </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;drug arrest rate of </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex17_drug_change&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> arrests per capita&quot;</span>
    <span class="s2">&quot;between 2009 and 2018.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>On average, California counties experienced a change in the average 
drug arrest rate of -0.00221 arrests per capitabetween 2009 and 2018.
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-18">
<h3>Exercise 18<a class="headerlink" href="#exercise-18" title="Link to this heading">#</a></h3>
<p>Now we want to look at whether violent crime decreased following drug legalization. Did the average violent arrest rate decrease? By how much? (Note: We’re assuming that arrest rates are proportionate to crime rates. If policing increased so that there were more arrests per crime committed, that would impact our interpretation of these results. But this is just an exercise, so…)</p>
<p>Store the average county-level change in violent arrests per capita in <code class="docutils literal notranslate"><span class="pre">results</span></code> under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex18_violent_change&quot;</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_years</span><span class="p">[</span><span class="s2">&quot;change_in_violent_2018_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">all_years</span><span class="o">.</span><span class="n">violent_arrest_rate_2018</span> <span class="o">-</span> <span class="n">all_years</span><span class="o">.</span><span class="n">violent_arrest_rate_2009</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex18_violent_change&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_years</span><span class="p">[</span><span class="s2">&quot;change_in_violent_2018_2009&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;On average, California counties experienced a change in the average </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;violent arrest rate of </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex18_violent_change&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> arrests per capita &quot;</span>
    <span class="s2">&quot;between 2009 and 2018.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>On average, California counties experienced a change in the average 
violent arrest rate of -0.00028 arrests per capita between 2009 and 2018.
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-19">
<h3>Exercise 19<a class="headerlink" href="#exercise-19" title="Link to this heading">#</a></h3>
<p>Based on your answers to exercises 17 and 18, what might you conclude about the relationship between the illegal drug trade and violent crime? Did legalizing drugs increase violent crime (assuming arrest rates are a good proxy for crime rates)? Decrease violent crime? Have no effect?</p>
<blockquote>
<div><p>If anything, violent arrest rates seem to have fallen, suggesting that drug legalization did not increase violent crime, and that it <em>may</em> have actually reduced it. With that said, the reduction in violent arrests it was relatively small. If this were a statistics course rather than a data wrangling course we would of course do some tests of statistical significance.</p>
</div></blockquote>
</section>
</section>
<section id="difference-in-difference-analysis">
<h2>Difference in Difference Analysis<a class="headerlink" href="#difference-in-difference-analysis" title="Link to this heading">#</a></h2>
<p>The preceding analysis is something we sometimes call a “pre-post” analysis, in that it is a comparison of how and outcome we care about (violent arrest rates) changes from before a treatment is introduced (“pre”) to after (“post”). BUT: pre-post comparisons are imperfect. If we knew that violent crime was not going to change at all in a world without drug legalization, then this comparison is perfectly valid. But what if, absent drug legalization, violent crime would have fallen on its own (maybe because of advances in policing practices or a better economy)? Or maybe it would have increased?</p>
<p>This is actually a very common problem. For example, imagine you’re trying to figure out whether taking tylenol helps with headaches. You have a patient with a headache, you give them tylenol, and then the next day you ask them if they still have a headache, and find out that they don’t — does that mean that tylenol cured the headache? Maybe… but most headaches eventually resolve on their own, so maybe the headache would have passed with or without the patient taking tylenol! In fact, there’s a term for this phenomenon in medicine — the “natural history” of a disease, which is the trajectory that we think a disease might follow absent treatment. And the natural history of the disease is almost never for it to stay exactly the same indefinitely.</p>
<p>(All of this is closely related to the discipline of causal inference, and if it makes your head to hurt, don’t worry — that means you’re doing it right! We will talk lots and lots more about it in the weeks and months to come.)</p>
<p>One way to try to overcome this problem is with something called a difference-in-difference analysis. Rather than just looking at whether violent drug arrest rates increase or decrease between 2009 and 2018, we can split our sample of counties into those that were <em>more</em> impacted by drug legalization and those that were <em>less</em> impacted by drug legalization and evaluate whether we see a greater change in the violent drug arrest rate in the counties that were more impacted.</p>
<p>What does it mean to have been “more impacted” by drug legalization? In this case, we can treat the counties that had higher drug arrest rates in 2009 as counties that were more impacted by drug legalization than those that had low drug arrest rates in 2009. After all, in a county that had no drug arrests, legalization wouldn’t do anything, would it?</p>
<section id="exercise-20">
<h3>Exercise 20<a class="headerlink" href="#exercise-20" title="Link to this heading">#</a></h3>
<p>First, split our sample into two groups: high drug arrests in 2009, and low drug arrests in 2009 (cut the sample at the average drug arrest rate in 2009).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_years</span><span class="o">.</span><span class="n">drug_arrest_rate_2009</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    58.000000
mean      0.003191
std       0.001448
min       0.001017
25%       0.002311
50%       0.002800
75%       0.003944
max       0.008613
Name: drug_arrest_rate_2009, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_years</span><span class="p">[</span><span class="s2">&quot;high_drug_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">all_years</span><span class="o">.</span><span class="n">drug_arrest_rate_2009</span> <span class="o">&gt;</span> <span class="n">all_years</span><span class="o">.</span><span class="n">drug_arrest_rate_2009</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-21">
<h3>Exercise 21<a class="headerlink" href="#exercise-21" title="Link to this heading">#</a></h3>
<p>Now, determine weather violent crime changed <em>more</em> from 2009 to 2018 in the counties that had lots of drug arrests in 2009 (where legalization likely had more of an effect) than in counties with fewer drug arrests in 2009 (where legalization likely mattered less)?</p>
<p>Calculate this difference-in-difference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">the</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">violent</span> <span class="n">crime</span> <span class="n">rate</span> <span class="n">per</span> <span class="n">capita</span> <span class="k">for</span> <span class="n">counties</span> <span class="k">with</span> <span class="n">lots</span> <span class="n">of</span> <span class="n">drug</span> <span class="n">arrests</span> <span class="ow">in</span> <span class="mi">2009</span><span class="p">)</span> 
<span class="o">-</span> <span class="p">(</span><span class="n">the</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">violent</span> <span class="n">crime</span> <span class="n">rate</span> <span class="n">per</span> <span class="n">capita</span> <span class="k">for</span> <span class="n">counties</span> <span class="k">with</span> <span class="n">few</span> <span class="n">drug</span> <span class="n">arrests</span> <span class="ow">in</span> <span class="mi">2009</span><span class="p">)</span>

</pre></div>
</div>
<p>Store your “difference-in-difference” estimate in your <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex21_diffindiff&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">change_from_09_to_18_in_high_drug_arrest_counties</span> <span class="o">=</span> <span class="n">all_years</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">all_years</span><span class="o">.</span><span class="n">high_drug_2009</span><span class="p">,</span> <span class="s2">&quot;change_in_violent_2018_2009&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">change_from_09_to_18_in_high_drug_arrest_counties</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.00043197415958967417)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">change_from_09_to_18_in_low_drug_arrest_counties</span> <span class="o">=</span> <span class="n">all_years</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="o">~</span><span class="n">all_years</span><span class="o">.</span><span class="n">high_drug_2009</span><span class="p">,</span> <span class="s2">&quot;change_in_violent_2018_2009&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">change_from_09_to_18_in_low_drug_arrest_counties</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.00018458037097611614)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dif_in_dif</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">change_from_09_to_18_in_high_drug_arrest_counties</span>
    <span class="o">-</span> <span class="n">change_from_09_to_18_in_low_drug_arrest_counties</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex21_diffindiff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dif_in_dif</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The difference in difference estimate is that county-level</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;violent arrest rates per capita changed by </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex21_diffindiff&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The difference in difference estimate is that county-level
violent arrest rates per capita changed by -0.000247.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dif_in_dif</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.000247393788613558)
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-22">
<h3>Exercise 22<a class="headerlink" href="#exercise-22" title="Link to this heading">#</a></h3>
<p>Interpret your difference in difference result.</p>
<blockquote>
<div><p>Our difference in difference result shows that violent arrest rates fell more in counties that were more impacted by drug legalization than in counties that were not. This suggests that drug legalization certainly didn’t increase violent crime, and probably decreased it at least a little. Again, if we were more focused on statistical inference in this class we would want to calculate the statistical significance of this change.</p>
</div></blockquote>
</section>
<section id="exercise-23">
<h3>Exercise 23<a class="headerlink" href="#exercise-23" title="Link to this heading">#</a></h3>
<p>The quantity we estimated above is a little difficult to interpret. Rather than calculating the <em>absolute</em> change in violent arrest rates per capita, let’s calculate the <em>proportionate</em> change.</p>
<p>Calculate, for each county:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">the</span> <span class="n">county</span><span class="o">-</span><span class="n">level</span> <span class="n">PERCENT</span> <span class="n">CHANGE</span> <span class="ow">in</span> <span class="n">violent</span> <span class="n">crime</span> <span class="n">rate</span> <span class="k">with</span> <span class="n">lots</span> <span class="n">of</span> <span class="n">drug</span> <span class="n">arrests</span> <span class="ow">in</span> <span class="mi">2009</span><span class="p">)</span> 
<span class="o">-</span> <span class="p">(</span><span class="n">the</span> <span class="n">county</span><span class="o">-</span><span class="n">level</span> <span class="n">PERCENT</span> <span class="n">CHANGE</span> <span class="ow">in</span> <span class="n">violent</span> <span class="n">crime</span> <span class="n">rate</span> <span class="k">with</span> <span class="n">few</span> <span class="n">drug</span> <span class="n">arrests</span> <span class="ow">in</span> <span class="mi">2009</span><span class="p">)</span>
</pre></div>
</div>
<p>Then take the average of those values (calculated for each county) for your high and low 2009 drug arrest rate counties.</p>
<p>Store your “difference-in-difference” estimate in your <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex23_diffindiff_proportionate&quot;</span></code>. Report your result in percentages, such that a value of <code class="docutils literal notranslate"><span class="pre">-100</span></code> would imply that the average county experienced a 100% decrease in the violent arrest rate.</p>
<p><strong>PLEASE ROUND YOUR ANSWER (IN PERCENTAGES) TO TWO DECIMAL PLACES (e.g., for 5.2789329% you would submit 5.28%)</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We could also do in percentage terms</span>
<span class="n">all_years</span><span class="p">[</span><span class="s2">&quot;pct_change_in_violent_2018_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">all_years</span><span class="o">.</span><span class="n">violent_arrest_rate_2018</span> <span class="o">-</span> <span class="n">all_years</span><span class="o">.</span><span class="n">violent_arrest_rate_2009</span>
<span class="p">)</span> <span class="o">/</span> <span class="n">all_years</span><span class="o">.</span><span class="n">violent_arrest_rate_2009</span>
<span class="n">pct_change_from_09_to_18_in_high_drug_arrest_counties</span> <span class="o">=</span> <span class="n">all_years</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">all_years</span><span class="o">.</span><span class="n">high_drug_2009</span><span class="p">,</span> <span class="s2">&quot;pct_change_in_violent_2018_2009&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">pct_change_from_09_to_18_in_low_drug_arrest_counties</span> <span class="o">=</span> <span class="n">all_years</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="o">~</span><span class="n">all_years</span><span class="o">.</span><span class="n">high_drug_2009</span><span class="p">,</span> <span class="s2">&quot;pct_change_in_violent_2018_2009&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">pct_dif_in_dif</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pct_change_from_09_to_18_in_high_drug_arrest_counties</span>
    <span class="o">-</span> <span class="n">pct_change_from_09_to_18_in_low_drug_arrest_counties</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex23_diffindiff_proportionate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pct_dif_in_dif</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The difference in difference estimate (in percentage terms) is </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ex23_diffindiff_proportionate&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">%&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The difference in difference estimate (in percentage terms) is -4.9100%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ex10_merged_successfully&#39;,
 &#39;ex16_num_obs&#39;,
 &#39;ex17_drug_change&#39;,
 &#39;ex18_violent_change&#39;,
 &#39;ex21_diffindiff&#39;,
 &#39;ex23_diffindiff_proportionate&#39;,
 &#39;ex6_validate_keyword&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span>
    <span class="s2">&quot;ex6_validate_keyword&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex10_merged_successfully&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex16_num_obs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex17_drug_change&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex18_violent_change&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex21_diffindiff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex23_diffindiff_proportionate&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ids720_specific/exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradescope-autograding">Gradescope Autograding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submission-limits">Submission Limits</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-legalization-analysis">Pre-Legalization Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-validation">Merge Validation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-diagnostics">Merge Diagnostics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-arrest-rates">Comparing Arrest Rates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13">Exercise 13</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14">Exercise 14</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-with-2018-arrests">Comparing with 2018 Arrests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15">Exercise 15</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-16">Exercise 16</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-17">Exercise 17</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-18">Exercise 18</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-19">Exercise 19</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-in-difference-analysis">Difference in Difference Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-20">Exercise 20</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-21">Exercise 21</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-22">Exercise 22</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-23">Exercise 23</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Bradbury & Nick Eubank
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>