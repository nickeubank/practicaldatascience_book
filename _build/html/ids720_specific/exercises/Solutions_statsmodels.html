
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Maternal Smoking and Birth Weight &#8212; Practical Data Science with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MC77BKR89Z"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MC77BKR89Z');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MC77BKR89Z');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ids720_specific/exercises/Solutions_statsmodels';</script>
    <link rel="icon" href="../../_static/mids_logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Practical Data Science with Python - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Practical Data Science with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Practical Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">IDS 720</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../class_schedule_720.html">Class Schedule</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting Up Your Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_python.html">Setting Up Python and conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_vscode.html">Setting Up VS Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_augmented_commandline.html">Augmenting Your Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/jupyter_in_vscode.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/jupyter_r_notebooks.html">VS Code, R, and Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Command Line</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/commandline_part1.html">Command Line Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/commandline_part2.html">Advanced Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/git_and_github.html">Git and Github</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numpy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_2/10_why_numpy.html">Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/20_intro_to_vectors.html">Working with Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/21_math_with_vectors.html">Doing Math With Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/23_type_promotion_in_vectors.html">Type Promotion in numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/10_speed_and_ease_of_use.html">The Python Ease of Use / Speed Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/11_vectorization.html">Vectorization in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/24_vector_recap.html">Vector Recap</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_2/30_subsetting_vectors.html">Subsetting Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/35_modifying_subsets_of_vectors.html">Modifying Subsets of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/37_vector_subsets_recap.html">Recap</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/10_views_and_copies.html">Views and Copies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/11_when_do_I_get_a_view.html">When Do I Get a View and When Do I Get a Copy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/13_objects_and_variables.html">Variables are pointers to objects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/12_views_and_copies_recap.html">Review of Views and Copies</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/00_welcome_to_week_3.html">Matrices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/20_matrices.html">Intro to Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/22_reshaping_matrices.html">Folding and Reshaping Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/25_images_as_matrices.html">Matrices as Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/30_subsetting_matrices.html">Subsetting Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/32_modifying_subsets.html">Editing Subsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/33_matrix_recaps.html">Review of Matrices</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/40_nd_arrays.html">Arrays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/41_broadcasting.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/42_nd_array_review.html">Review of ND-Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/03_summarizing_arrays.html">Summarizing Arrays</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/04_summarizing_arrays_example.html">Practical Example: comparing weather by counting like-values</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/04.1_color_images_as_arrays.html">Color Images as Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_4/20_random_numbers.html">Random numbers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_2/00_intro_to_pandas.html">Welcome to Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/10_pandas_series.html">Pandas Series</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/15_manipulating_series.html">Subsetting and Indexing Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/16_indexing_with_brackets.html">(OPTIONAL) Subsetting and Indexing with Single Square Brackets (<code class="docutils literal notranslate"><span class="pre">[]</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/18_object_dtype.html">The <code class="docutils literal notranslate"><span class="pre">object</span></code> Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/30_pandas_dataframes.html">Working with tabular data through Dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/35_pandas_dataframe_gotchas.html">Subsetting DataFrame Tricks and Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/45_categorical_dtype.html">The Categorical Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/50_pandas_pyarrow.html">PyArrow: An Alternative to Numpy as Pandas Backend</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_3/week_3/07_indices.html">Indexes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/10_views_and_copies_numpy_review.html">Views and Copies in Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/15_views_and_copies_in_pandas.html">Views and Copies in pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/17_views_and_copies_in_pandas_wo_CoW.html">The View/Copy Headache in pandas without Copy on Write</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/03_plaintext_files.html">Reading Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/05_binary_files.html">Binary Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/20_cleaning_identifying.html">Data Cleaning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/30_cleaning_editing_globally.html">Fixing Data Value Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/32_cleaning_editing_specific_locations.html">Editing Specific Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/33_cleaning_datatypes.html">Cleaning Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/35_cleaning_missing_data.html">Missing Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_4/00_intro_to_querying_data.html">Data Manipulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/10_combining_concatenating.html">Concatenating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15_combining_merging.html">Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15.1_combining_merging_continued.html">Combining datasets: merging</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15.2_combining_merging_practical_example.html">Practical Example</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15.3_validating_a_merge.html">Validating Merges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/20_grouping.html">Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/30_queries.html">Querying</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/1.1.2_effective_plotting_practices.html">Matplotlib Fundamentals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.1_basic_plotting_with_matplotlib.html">Plotting with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.2_ten_figure_pieces.html">A figure in 10 pieces</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.4.5_explicit_vs_implicit_syntax.html">Implicit vs explicit syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.4.4_saving_to_file.html">Saving to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.5.1_plotting_zoo.html">Plotting Zoo: multiple ways to visualize the same set of data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.6.1_plotting_with_pandas.html">Plotting with Pandas</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.4_bar_plots_deep_dive.html">Different Types of Plots</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.3_text.html">Plotting text (and a side note on axis scaling)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.5_stack_plots.html">Stack Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.6_pie_charts.html">Pie charts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.1_subplots.html">Subplots</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.2_subplots_deep_dive.html">Subplots: a deeper dive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.EXS_timeseries_worked_example.html">Exercise: Creating a subplot of timeseries (solution)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7.EX_timeseries_worked_example.html">Exercise: Creating a subplot of timeseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.7_scatter_plots_deep_dive.html">Doing more with scatter plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.8_errorbars.html">Visualizing ranges and uncertainty</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.2.9_heat_maps.html">Heat maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.1.EXS_histograms_solutions.html">Exercise: Analyzing Poker Hand Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.1.EX_histograms.html">Exercise: Analyzing Poker Hand Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.1_histograms.html">Histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/1.3.2_2d_histograms.html">Two Dimensional Histograms</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/2.1.1_the_matplotlib_model.html">Advanced Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.1.2_customizing_plot_styles.html">Customizing styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.1.3_plotting_zoo_restyled.html">Plotting Zoo - with style!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.2.1_making_plots_pretty_1.html">Making Plots Pretty Part 1: laying the foundation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.2.2_making_plots_pretty_2.html">Making pretty plots in Python: customizing plots in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_1/2.3.1_plotting_with_seaborn.html">Seaborn Objects and GoG</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_1/2.3.2_seaborn_recipes.html">Seaborn Object Recipes</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Big Data &amp; Performance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/10_big_data_what_is_it.html">What is Big Data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/20_big_data_strategies.html">Big Data Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/30_parquet.html">Parquet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/object_vectors.html">Object dtypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/50_performance_solutions.html">Solving Performance Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/60_parallelism.html">Parallel Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/70_dask.html">Distributed Computing with dask</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical Skills and Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/10_debugging_principles.html">Debugging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/20_debugging_in_vscode.html">Debugging Python in VS Code</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming.html">Defensive Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_tests.html">Testing in a Data Analysis Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_readability.html">Readability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_duplicate.html">Don’t Duplicate Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/iceberg_principle.html">The Iceberg Principle</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/workflow.html">Workflow Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/getting_help.html">Getting Help Online</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/vars_v_objects.html">Python: Variables vs. Objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/python_v_r.html">Python vs. R: Important Differences To Be Aware Of</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/backwards_design.html">Backwards Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/ints_and_floats.html">Numbers in Computers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/writing_good_jupyter_notebooks.html">Writing Good Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/pr_review.html">Reviewing Code on Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/conda_environments.html">conda Environments</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Modelling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/20_inference_v_prediction.html">Inference vs. Prediction Data Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/30_linear_regression_in_python.html">Linear Regression in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/15_brief_intro_categorical_variables.html">Categorical Variables, Indicator Variables and Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/35_pandas_to_numpy_with_patsy.html">Pulling Back the Curtain: Pandas to Numpy with patsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_5/week_3/40_linear_regression_extensions.html">OPTIONAL: Beyond The Basic Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Professional Advice</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/buying_datascience_computer.html">How To Buy A Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/llms.html">chatGPT and You</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/PhD_Advice.html">So You’re Thinking About a PhD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/ergonomics_and_adaptive_tech.html">Ergonomics and Adaptive Tech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/mids_electives.html">Duke Data Science Electives</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_1/00_interactive_console.html">Running Python in the VS Code Interactive Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_4/30_managing_python_packages.html">Understanding and Managing Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/other/fstrings.html">Combining numbers and text into strings: f-strings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book/issues/new?title=Issue%20on%20page%20%2Fids720_specific/exercises/Solutions_statsmodels.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ids720_specific/exercises/Solutions_statsmodels.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Maternal Smoking and Birth Weight</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradescope-autograding">Gradescope Autograding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submission-limits">Submission Limits</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statsmodels-versus-r">statsmodels versus R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weighting">Weighting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="maternal-smoking-and-birth-weight">
<h1>Maternal Smoking and Birth Weight<a class="headerlink" href="#maternal-smoking-and-birth-weight" title="Link to this heading">#</a></h1>
<section id="gradescope-autograding">
<h2>Gradescope Autograding<a class="headerlink" href="#gradescope-autograding" title="Link to this heading">#</a></h2>
<p>Please follow <a class="reference external" href="https://www.practicaldatascience.org/html/autograder_guidelines.html">all standard guidance</a> for submitting this assignment to the Gradescope autograder, including storing your solutions in a dictionary called <code class="docutils literal notranslate"><span class="pre">results</span></code> and ensuring your notebook runs from the start to completion without any errors.</p>
<p>For this assignment, please name your file <code class="docutils literal notranslate"><span class="pre">exercise_statsmodels.ipynb</span></code> before uploading.</p>
<p>You can check that you have answers for all questions in your <code class="docutils literal notranslate"><span class="pre">results</span></code> dictionary with this code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span>
    <span class="s2">&quot;ex2_birth_weight_lower&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex3_smoking_coefficient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex4_smoking_coefficient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex6_compare_white_black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex6_compare_white_black_tstat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex7_predictions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex8_smoking_coefficient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex10_num_high_drug_arrest&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex11_diff_in_diff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex12_diff_in_diff_weighted&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="submission-limits">
<h3>Submission Limits<a class="headerlink" href="#submission-limits" title="Link to this heading">#</a></h3>
<p>Please remember that you are <strong>only allowed three submissions to the autograder.</strong> Your last submission (if you submit 3 or fewer times), or your third submission (if you submit more than 3 times) will determine your grade Submissions that error out will <strong>not</strong> count against this total.</p>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>For these exercises, we will borrow some data and exercises from another MIDS course on Statistical Modeling:</p>
<p>These days, it is widely understood that mothers who smoke during pregnancy risk exposing their babies to many health problems. This was not common knowledge fifty years ago. One of the first studies that addressed the issue of pregnancy and smoking was the Child Health and Development Studies, a comprehensive study of all babies born between 1960 and 1967 at the Kaiser Foundation Hospital in Oakland, CA. The original reference for the study is Yerushalmy (1964, American Journal of Obstetrics and Gynecology, pp. 505-518). The data and a summary of the study are in Nolan and Speed (2000, Stat Labs, Chapter 10) and can be found at <a class="reference external" href="https://www.stat.berkeley.edu/users/statlabs/">the book’s website.</a></p>
<p>There were about 15,000 families in the study. We will only analyze a subset of the data, in particular 869 male single births where the baby lived at least 28 days. The researchers interviewed mothers early in their pregnancy to collect information on socioeconomic and demographic characteristics, including an indicator of whether the mother smoked during pregnancy. The variables in the dataset are described in the <a class="reference external" href="https://ids-702-f19.github.io/Course-Website/hw/hw-02.html">code book here</a>. In this exercise, we will attempt to use this data to answer the following questions:</p>
<ol class="arabic simple">
<li><p>Do mothers who smoke tend to give birth to babies with lower weights than mothers who do not smoke?</p></li>
<li><p>What is a likely range for the difference in birth weights for smokers and non-smokers?</p></li>
<li><p>Is there any evidence that the association between smoking and birth weight differs by mother’s race? If so, characterize those differences.</p></li>
<li><p>Are there other interesting associations with birth weight that are worth mentioning?</p></li>
</ol>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>Load the data “smoking.csv”, which includes information on both biometrics of infants at birth, and information on mothers (variables prefixed with the letter “m”), from <a class="reference external" href="https://github.com/nickeubank/MIDS_Data">this MIDS repo</a>. (Yup, I’m giving you CLEAN DATA! I think this is the only time I’ve done this in this course! Enjoy it. :)).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;mode.copy_on_write&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">smoking_and_bw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://media.githubusercontent.com/media/&quot;</span>
    <span class="s2">&quot;nickeubank/MIDS_Data/master/smoking.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1598, 1527, 1563, 1503, 1638, 1705, 1444, 1405, 1669, 1476, 1562,
       1691, 1548, 1362, 1376, 1629, 1496, 1538, 1604, 1540, 1461, 1451,
       1665, 1408, 1453, 1416, 1428, 1369, 1602, 1407, 1704, 1529, 1459,
       1622, 1355, 1358, 1431, 1566, 1440, 1494, 1467, 1423, 1360, 1555,
       1601, 1535, 1490, 1712, 1564, 1620, 1388, 1383, 1600, 1635, 1370,
       1493, 1575, 1690, 1698, 1508, 1670, 1689, 1514, 1680, 1648, 1591,
       1512, 1636, 1554, 1649, 1418, 1363, 1714, 1381, 1586, 1545, 1553,
       1365, 1671, 1596, 1541, 1618, 1441, 1400, 1434, 1661, 1526, 1569,
       1420, 1414, 1539, 1520, 1479, 1491, 1550, 1675, 1662, 1521, 1524,
       1708, 1537, 1616, 1463, 1505, 1679, 1615, 1695, 1499, 1592, 1415,
       1525, 1484, 1374, 1506, 1694, 1681, 1427, 1593, 1546, 1572, 1424,
       1672, 1419, 1628, 1472, 1481, 1630, 1557, 1353, 1378, 1627, 1660,
       1637, 1653, 1450, 1701, 1684, 1547, 1658, 1533, 1666, 1654, 1674,
       1518, 1583, 1656, 1468, 1640, 1396, 1398, 1664, 1480, 1613, 1399,
       1605, 1702, 1522, 1448, 1659, 1706, 1587, 1449, 1579, 1607, 1544,
       1351, 1442, 1391, 1624, 1466, 1634, 1585, 1549, 1401, 1422, 1385,
       1371, 1697, 1532, 1421, 1645, 1470, 1437, 1641, 1657, 1386, 1646,
       1683, 1588, 1599, 1663, 1559, 1574, 1692, 1364, 1568, 1565, 1433,
       1359, 1581, 1603, 1516, 1447, 1667, 1507, 1367, 1380, 1457, 1411,
       1471, 1703, 1693, 1696, 1584, 1567, 1462, 1551, 1387, 1354, 1625,
       1511, 1611, 1501, 1413, 1644, 1573, 1580, 1594, 1377, 1485, 1571,
       1438, 1536, 1542, 1589, 1504, 1465, 1642, 1460, 1606, 1685, 1394,
       1382, 1390, 1489, 1556, 1700, 1558, 1673, 1576, 1492, 1486, 1417,
       1404, 1412, 1515, 1379, 1668, 1639, 1699, 1560, 1469, 1612, 1475,
       1651, 1647, 1609, 1384, 1626, 1406, 1456, 1477, 1498, 1393, 1375,
       1389, 1426, 1682, 1578, 1482, 1707, 1713, 1436, 1350, 1474, 1483,
       1464, 1677, 1621, 1608, 1432, 1686, 1531, 1402, 1445, 1409, 1410,
       1517, 1373, 1361, 1688, 1513, 1710, 1619, 1623, 1510, 1403, 1500,
       1676, 1617, 1352, 1357, 1473, 1614, 1709, 1455, 1650, 1452, 1488,
       1446, 1495, 1425, 1687, 1652, 1487, 1711, 1577, 1528, 1655, 1443,
       1561, 1509, 1392, 1435, 1678, 1633, 1552, 1590])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1096</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(254)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.int64(364)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">smoke</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>smoke
0    466
1    403
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<p>Start by plotting the relationship between infant weight at birth and gestation (length of pregnancy (in days) at time of birth) for both mothers who smoke and those who do not in a single plot. Include regression lines for both populations (again, all on one plot).</p>
<p>Limit attention in the plot (and in subsequent questions) to children born after <em>more than</em> 225 days of gestation (there aren’t really any observations for parents who smoke for less than that, so we don’t get common support).</p>
<p>Does it seem like birthweights tend to be lower for the children of parents who smoke at a given gestational period? Store your answer as either <code class="docutils literal notranslate"><span class="pre">&quot;yes&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;no&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">ex2_birth_weight_lower</span></code>.</p>
<p><strong>NOTE:</strong> This dataset has at least one column name that cause issues with Python (and seaborn. and statsmodels).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span> <span class="o">=</span> <span class="n">smoking_and_bw</span><span class="p">[</span><span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">gestation</span> <span class="o">&gt;</span> <span class="mi">225</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span> <span class="o">=</span> <span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;bwt.oz&quot;</span><span class="p">:</span> <span class="s2">&quot;bwt_oz&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn.objects</span> <span class="k">as</span> <span class="nn">so</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">style</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
<span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;smoke&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;smoke&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;bool&quot;</span><span class="p">)</span>
<span class="p">(</span>
    <span class="n">so</span><span class="o">.</span><span class="n">Plot</span><span class="p">(</span><span class="n">smoking_and_bw</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;gestation&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;bwt_oz&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;smoke&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Dots</span><span class="p">())</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">Lines</span><span class="p">(),</span> <span class="n">so</span><span class="o">.</span><span class="n">PolyFit</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gestational Period and Birth Weight (by Maternal Smoking)&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">theme</span><span class="p">({</span><span class="o">**</span><span class="n">style</span><span class="o">.</span><span class="n">library</span><span class="p">[</span><span class="s2">&quot;seaborn-v0_8-whitegrid&quot;</span><span class="p">]})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="../../_images/3de586c7731edd74209db6c141e7a7662a3f5f161435ef1629db39e8670349d0.png"><img alt="../../_images/3de586c7731edd74209db6c141e7a7662a3f5f161435ef1629db39e8670349d0.png" src="../../_images/3de586c7731edd74209db6c141e7a7662a3f5f161435ef1629db39e8670349d0.png" style="width: 595px; height: 378.25px;" /></a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex2_birth_weight_lower&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;yes&quot;</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Yup. Those linear models cross out past 315 days or so, but there’s basically no data there, so doesn’t mean much. Through the bulk of the distribution the children of smoking mothers weigh less.</p>
</div></blockquote>
</section>
</section>
<section id="linear-regression">
<h2>Linear Regression<a class="headerlink" href="#linear-regression" title="Link to this heading">#</a></h2>
<p><strong>PLEASE CONTINUE TO SUBSET FOR GESTATION GREATER THAN 225 DAYS for this section</strong></p>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<p>Now check this relationship using <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. Regress birthweight on gestational period and whether the infant’s mother smoked. Is your conclusion from the previous exercise confirmed? Store the coefficient for smoking in results under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex3_smoking_coefficient&quot;</span></code>.</p>
<p><em>Note:</em> coefficients are stored in the <code class="docutils literal notranslate"><span class="pre">.params</span></code> attribute of your fit model. If you have trouble figuring out how to access the parameters from a fitted model, check out the docs <a class="reference external" href="https://www.statsmodels.org/dev/generated/statsmodels.regression.linear_model.OLS.html">here</a>.</p>
<p><em>Note 2:</em> you may hit a problem because of the name of one of your columns. You should probably be able to guess the problem given your experience with Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">s_and_bw_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s2">&quot;bwt_oz ~ gestation + smoke&quot;</span><span class="p">,</span> <span class="n">smoking_and_bw</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">s_and_bw_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>bwt_oz</td>      <th>  R-squared:         </th> <td>   0.208</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.206</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   112.6</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 07 Nov 2024</td> <th>  Prob (F-statistic):</th> <td>3.68e-44</td>
</tr>
<tr>
  <th>Time:</th>                 <td>10:51:32</td>     <th>  Log-Likelihood:    </th> <td> -3606.9</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   862</td>      <th>  AIC:               </th> <td>   7220.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   859</td>      <th>  BIC:               </th> <td>   7234.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>     <td>  -13.4386</td> <td>   10.878</td> <td>   -1.235</td> <td> 0.217</td> <td>  -34.790</td> <td>    7.913</td>
</tr>
<tr>
  <th>smoke[T.True]</th> <td>   -7.8784</td> <td>    1.090</td> <td>   -7.227</td> <td> 0.000</td> <td>  -10.018</td> <td>   -5.739</td>
</tr>
<tr>
  <th>gestation</th>     <td>    0.4860</td> <td>    0.039</td> <td>   12.544</td> <td> 0.000</td> <td>    0.410</td> <td>    0.562</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 6.654</td> <th>  Durbin-Watson:     </th> <td>   1.950</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.036</td> <th>  Jarque-Bera (JB):  </th> <td>   7.760</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.114</td> <th>  Prob(JB):          </th> <td>  0.0206</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.405</td> <th>  Cond. No.          </th> <td>5.61e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 5.61e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex3_smoking_coefficient&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_and_bw_model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smoke[T.True]&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Yup! Smoking results in markedly reduced birth weight!</p>
</div></blockquote>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h3>
<p>Now let’s expand our model to also take into account mothers’ pregnancy weight and race (make sure to treat race as a categorical variable!). Don’t try to do any recoding of <code class="docutils literal notranslate"><span class="pre">mrace</span></code>, just turn it into a categorical. Does your interpretation of the <code class="docutils literal notranslate"><span class="pre">smoke</span></code> coefficient change? Store the new coefficient under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex4_smoking_coefficient&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_and_bw_model2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span>
    <span class="s2">&quot;bwt_oz ~ gestation + smoke + mpregwt + C(mrace)&quot;</span><span class="p">,</span> <span class="n">smoking_and_bw</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">s_and_bw_model2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>bwt_oz</td>      <th>  R-squared:         </th> <td>   0.255</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.245</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   24.23</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 07 Nov 2024</td> <th>  Prob (F-statistic):</th> <td>6.80e-47</td>
</tr>
<tr>
  <th>Time:</th>                 <td>10:51:32</td>     <th>  Log-Likelihood:    </th> <td> -3580.3</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   862</td>      <th>  AIC:               </th> <td>   7187.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   849</td>      <th>  BIC:               </th> <td>   7248.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>    12</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>     <td>  -17.3203</td> <td>   11.138</td> <td>   -1.555</td> <td> 0.120</td> <td>  -39.181</td> <td>    4.541</td>
</tr>
<tr>
  <th>smoke[T.True]</th> <td>   -7.8958</td> <td>    1.081</td> <td>   -7.303</td> <td> 0.000</td> <td>  -10.018</td> <td>   -5.774</td>
</tr>
<tr>
  <th>C(mrace)[T.1]</th> <td>   -1.8441</td> <td>    2.776</td> <td>   -0.664</td> <td> 0.507</td> <td>   -7.293</td> <td>    3.605</td>
</tr>
<tr>
  <th>C(mrace)[T.2]</th> <td>   -5.6291</td> <td>    3.749</td> <td>   -1.502</td> <td> 0.134</td> <td>  -12.987</td> <td>    1.729</td>
</tr>
<tr>
  <th>C(mrace)[T.3]</th> <td>   -0.5249</td> <td>    2.477</td> <td>   -0.212</td> <td> 0.832</td> <td>   -5.387</td> <td>    4.337</td>
</tr>
<tr>
  <th>C(mrace)[T.4]</th> <td>    0.9884</td> <td>    2.497</td> <td>    0.396</td> <td> 0.692</td> <td>   -3.912</td> <td>    5.889</td>
</tr>
<tr>
  <th>C(mrace)[T.5]</th> <td>   -0.6721</td> <td>    1.767</td> <td>   -0.380</td> <td> 0.704</td> <td>   -4.141</td> <td>    2.796</td>
</tr>
<tr>
  <th>C(mrace)[T.6]</th> <td>    4.3084</td> <td>    3.235</td> <td>    1.332</td> <td> 0.183</td> <td>   -2.041</td> <td>   10.658</td>
</tr>
<tr>
  <th>C(mrace)[T.7]</th> <td>   -6.4570</td> <td>    1.477</td> <td>   -4.372</td> <td> 0.000</td> <td>   -9.356</td> <td>   -3.558</td>
</tr>
<tr>
  <th>C(mrace)[T.8]</th> <td>   -7.1764</td> <td>    2.849</td> <td>   -2.519</td> <td> 0.012</td> <td>  -12.767</td> <td>   -1.585</td>
</tr>
<tr>
  <th>C(mrace)[T.9]</th> <td>   -1.9153</td> <td>    4.098</td> <td>   -0.467</td> <td> 0.640</td> <td>   -9.959</td> <td>    6.128</td>
</tr>
<tr>
  <th>gestation</th>     <td>    0.4417</td> <td>    0.039</td> <td>   11.441</td> <td> 0.000</td> <td>    0.366</td> <td>    0.517</td>
</tr>
<tr>
  <th>mpregwt</th>       <td>    0.1396</td> <td>    0.027</td> <td>    5.242</td> <td> 0.000</td> <td>    0.087</td> <td>    0.192</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 8.387</td> <th>  Durbin-Watson:     </th> <td>   1.968</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.015</td> <th>  Jarque-Bera (JB):  </th> <td>  11.377</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.078</td> <th>  Prob(JB):          </th> <td> 0.00338</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.541</td> <th>  Cond. No.          </th> <td>6.50e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 6.5e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex4_smoking_coefficient&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_and_bw_model2</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smoke[T.True]&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h3>
<p>Now let’s test for whether there is an interaction between the mother’s race and the effect of smoking by adding an interaction term to this regression.</p>
<p>Note that race is coded as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mrace    mother’s race or ethnicity
         0-5= white
         6  = mexican
         7 = black
         8 = asian
         9 = mix
         99 = unknown
</pre></div>
</div>
<p>As most variation in this data is between “white” and other categories, first recode race to be an indicator for white and non-white for easier interpretation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;mrace&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;mrace&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">s_and_bw_model3</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span>
    <span class="s2">&quot;bwt_oz ~ gestation + mpregwt + C(white)*smoke&quot;</span><span class="p">,</span> <span class="n">smoking_and_bw</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">s_and_bw_model3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>bwt_oz</td>      <th>  R-squared:         </th> <td>   0.243</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.238</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   54.81</td>
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 07 Nov 2024</td> <th>  Prob (F-statistic):</th> <td>1.91e-49</td>
</tr>
<tr>
  <th>Time:</th>                 <td>10:51:32</td>     <th>  Log-Likelihood:    </th> <td> -3587.5</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   862</td>      <th>  AIC:               </th> <td>   7187.</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   856</td>      <th>  BIC:               </th> <td>   7216.</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     5</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
                 <td></td>                   <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                      <td>  -21.8908</td> <td>   10.949</td> <td>   -1.999</td> <td> 0.046</td> <td>  -43.381</td> <td>   -0.401</td>
</tr>
<tr>
  <th>C(white)[T.True]</th>               <td>    4.3761</td> <td>    1.575</td> <td>    2.778</td> <td> 0.006</td> <td>    1.284</td> <td>    7.468</td>
</tr>
<tr>
  <th>smoke[T.True]</th>                  <td>   -8.8601</td> <td>    2.077</td> <td>   -4.267</td> <td> 0.000</td> <td>  -12.936</td> <td>   -4.784</td>
</tr>
<tr>
  <th>C(white)[T.True]:smoke[T.True]</th> <td>    1.0069</td> <td>    2.421</td> <td>    0.416</td> <td> 0.678</td> <td>   -3.746</td> <td>    5.759</td>
</tr>
<tr>
  <th>gestation</th>                      <td>    0.4446</td> <td>    0.039</td> <td>   11.510</td> <td> 0.000</td> <td>    0.369</td> <td>    0.520</td>
</tr>
<tr>
  <th>mpregwt</th>                        <td>    0.1319</td> <td>    0.026</td> <td>    5.132</td> <td> 0.000</td> <td>    0.081</td> <td>    0.182</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 8.544</td> <th>  Durbin-Watson:     </th> <td>   1.956</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.014</td> <th>  Jarque-Bera (JB):  </th> <td>  11.787</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.071</td> <th>  Prob(JB):          </th> <td> 0.00276</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.555</td> <th>  Cond. No.          </th> <td>6.35e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 6.35e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h3>
<p>Now, using <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLSResults.t_test.html">post-regression test syntax</a> (not by running a new regression on a subpopulation), recover the coefficient and t-statistic for <em>whether smoking reduces birth weight for white mothers.</em>  Store the t-statistic of your test in <code class="docutils literal notranslate"><span class="pre">ex6_compare_white_black_tstat</span></code>.</p>
<p><strong>Hint:</strong> Read to the BOTTOM of the post-regression test syntax documentation for how to specify hypotheses with strings.</p>
<p>How does this coefficient compare to that for non-White mothers?</p>
<p>Is the reduction in birth weight associated with smoking for White mothers larger or smaller than for non-White mothers (the effect of smoking is negative for everyone, so basically I’m asking whether the <em>absolute value</em> of this negative value is larger or smaller for White mothers than non-White mothers)? Store your answer as either <code class="docutils literal notranslate"><span class="pre">&quot;larger&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;smaller&quot;</span></code> under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex6_compare_white_black&quot;</span></code>.</p>
<p><strong>Note:</strong> Please ensure your t-stat is stored as a single number, not an array or an array of arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hypotheses</span> <span class="o">=</span> <span class="s2">&quot;smoke[T.True] + C(white)[T.True]:smoke[T.True] = 0&quot;</span>
<span class="n">t_test</span> <span class="o">=</span> <span class="n">s_and_bw_model3</span><span class="o">.</span><span class="n">t_test</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">)</span>
<span class="n">t_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;statsmodels.stats.contrast.ContrastResults&#39;&gt;
                             Test for Constraints                             
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
c0            -7.8532      1.253     -6.266      0.000     -10.313      -5.393
==============================================================================
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>The reduction in birth weight associated with smoking for white mothers appears to be about 40% that of the penalty of black mothers.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex6_compare_white_black&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;smaller&quot;</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex6_compare_white_black_tstat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t_test</span><span class="o">.</span><span class="n">tvalue</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-7">
<h3>Exercise 7<a class="headerlink" href="#exercise-7" title="Link to this heading">#</a></h3>
<p>Now let’s use this model to predict some values. Let’s generate some hypothetical newborns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">newborns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;smoke&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;white&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="s2">&quot;gestation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">253</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">287</span><span class="p">],</span>
        <span class="s2">&quot;mpregwt&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">132</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">139</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Using the model you ran above with gestation, smoke, mpregwt, white, and the interaction of white and smoke, predict birth weights for these newborns. Store your predictions <strong>in a list</strong> under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex7_predictions&quot;</span></code>.</p>
<p>Note that if you have different data types from those in this pretend dataset or different column names from those in the dataset you used to fit your model, you’ll get an error—just adjust the column names / data types to match the data you used to fit your model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newborns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;smoke&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;white&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
        <span class="s2">&quot;gestation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">253</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">287</span><span class="p">],</span>
        <span class="s2">&quot;mpregwt&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">132</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">139</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_and_bw_model3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">newborns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    104.523084
1    119.639155
2    111.208810
3    124.039095
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex7_predictions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s_and_bw_model3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">newborns</span><span class="p">))</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex7_predictions&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[104.5230842774327, 119.63915539293477, 111.20881028285336, 124.03909471463662]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="statsmodels-versus-r">
<h2>statsmodels versus R<a class="headerlink" href="#statsmodels-versus-r" title="Link to this heading">#</a></h2>
<p>A quick but important note: the tools that are made available in different packages is often a function of who uses those packages, and how they use them. By and large, nearly all statisticians use R, and so many stats tools (like automatic forward-model-selection or backwards-model-selection) have “convenience implementations” (single functions that do all the things you’d want to accomplish) in R, but aren’t available as convenience packages in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>. That’s because <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> was mostly written by economists and social scientists who tend to feel model selection should be a function of theory not statistical performance (not taking sides: just reporting a difference that exists).</p>
<p>To be clear, you can still implement things like forward model selection yourself in Python – just write a loop that tries different regressors and plots the resulting AICs! – but it will often take a little more work. (Indeed, you can find examples of people <a class="reference external" href="https://planspace.org/20150423-forward_selection_with_statsmodels/">writing these loops on the web</a>). And that’s not to say that <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> doesn’t have a TON of stuff (take a minute to just look over all the <a class="reference external" href="http://www.statsmodels.org/stable/examples/index.html">examples of cool things you can do in statsmodels here</a>). Just don’t be surprised if you ommissions that seem odd given what you see emphasized in stats courses.</p>
<p>This is one of the reasons that languages are sticky: once a group of people have invested in adding all the bells and whistles they like to a language, there are good reasons to not move to another language, even if the other language has some advantages. A statistician who likes the basic language organization of Python more than R, for example, may still stay with R because the packages already do everything a statistician wants to do, and so it’s not worth having to re-implement common tasks in a new language.</p>
</section>
<section id="logistic-regression">
<h2>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Link to this heading">#</a></h2>
<section id="exercise-8">
<h3>Exercise 8<a class="headerlink" href="#exercise-8" title="Link to this heading">#</a></h3>
<p>Now, using statsmodels, evaluate the impact of smoking on the likelihood a child is born prematurely <strong>using a logistic regression</strong>  (where “premature” is defined as gestation of <em>less than</em> 252 days).</p>
<p>For obvious reasons, <strong>DO NOT USE OUR SUBSET FOR GESTATION GREATER THAN 225 DAYS</strong> from above for this section.</p>
<p>For this model, please include mother’s pre-pregnancy weight, smoking status, and whether the mother is White (if you use all the racial categories, the model won’t converge). Please don’t include the interaction we used in the last question. Store the coefficient for smoking in <code class="docutils literal notranslate"><span class="pre">ex8_smoking_coefficient</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoking_and_bw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://media.githubusercontent.com/media/&quot;</span>
    <span class="s2">&quot;nickeubank/MIDS_Data/master/smoking.csv&quot;</span>
<span class="p">)</span>

<span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;premature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;gestation&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">252</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">smoking_and_bw</span> <span class="o">=</span> <span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;bwt.oz&quot;</span><span class="p">:</span> <span class="s2">&quot;bwt_oz&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;white&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;mrace&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">smoking_and_bw</span><span class="p">[</span><span class="s2">&quot;mrace&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">smoking_and_bw</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;date&#39;, &#39;gestation&#39;, &#39;bwt_oz&#39;, &#39;parity&#39;, &#39;mrace&#39;, &#39;mage&#39;, &#39;med&#39;,
       &#39;mht&#39;, &#39;mpregwt&#39;, &#39;inc&#39;, &#39;smoke&#39;, &#39;premature&#39;, &#39;white&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">premature_fit</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="s2">&quot;premature ~ smoke + white + mpregwt&quot;</span><span class="p">,</span> <span class="n">smoking_and_bw</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.187899
         Iterations 7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">premature_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>premature</td>    <th>  No. Observations:  </th>  <td>   869</td> 
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>  <td>   865</td> 
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>  <td>     3</td> 
</tr>
<tr>
  <th>Date:</th>            <td>Thu, 07 Nov 2024</td> <th>  Pseudo R-squ.:     </th>  <td>0.04614</td>
</tr>
<tr>
  <th>Time:</th>                <td>10:51:32</td>     <th>  Log-Likelihood:    </th> <td> -163.28</td>
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th> <td> -171.18</td>
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>0.001248</td>
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>           <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>     <td>   -1.5353</td> <td>    1.024</td> <td>   -1.499</td> <td> 0.134</td> <td>   -3.542</td> <td>    0.472</td>
</tr>
<tr>
  <th>white[T.True]</th> <td>   -1.2247</td> <td>    0.320</td> <td>   -3.833</td> <td> 0.000</td> <td>   -1.851</td> <td>   -0.598</td>
</tr>
<tr>
  <th>smoke</th>         <td>    0.4253</td> <td>    0.320</td> <td>    1.331</td> <td> 0.183</td> <td>   -0.201</td> <td>    1.052</td>
</tr>
<tr>
  <th>mpregwt</th>       <td>   -0.0070</td> <td>    0.008</td> <td>   -0.907</td> <td> 0.364</td> <td>   -0.022</td> <td>    0.008</td>
</tr>
</table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex8_smoking_coefficient&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">premature_fit</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;smoke&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Smoking appears to increase the likelihood of a premature birth marginally, though the statistical significance of the effect is low, so it may just be a spurious correlation.</p>
</div></blockquote>
</section>
</section>
<section id="weighting">
<h2>Weighting<a class="headerlink" href="#weighting" title="Link to this heading">#</a></h2>
<p>Let’s now try using statsmodels on another dataset.</p>
<p>In our merging exercises, we ran a difference-in-difference analysis on crime in California counties to see if, following drug legalization, there was a larger decline in violent crime in counties that had previously also had high drug arrest rates (to test the idea that violence was being generated by the drug trade, and that legalization would decrease this violence).</p>
<p>In those analyses, we treated counties as equally-weighted units of analysis. If we think that each county is a single “community”, and we think crime and arrests is shaped at the level of communities (particularly when our community division is related to administrative boundaries that impact policing and government services, and is the case with counties), then this is reasonable.</p>
<p>But one might think that crime is determined at the individual level, or maybe neighborhood level, and so big counties should “count more” in our analysis.</p>
<p>(More formally, when we are fitting a regression model that picks parameter values to minimize the overall sum of squared errors, maybe we should pick values that to a better job of minimizing the errors for populous counties at the expense of not doing quite as good a job of minimizing the errors for smaller counties)</p>
<p>Here, let’s use weighted least squares to weight observations based on population. This will allow bigger counties to influence our estimates more.</p>
<section id="exercise-9">
<h3>Exercise 9<a class="headerlink" href="#exercise-9" title="Link to this heading">#</a></h3>
<p>To begin, read in our data on California arrest rates and population from <a class="reference external" href="https://github.com/nickeubank/MIDS_Data/blob/master/arrest_rates_and_population.parquet">github</a>. You will see I’ve reshaped the data to long format for convenience. This data is stored as a parquet file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">arrests</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/nickeubank/MIDS_Data/blob/&quot;</span>
    <span class="s2">&quot;master/arrest_rates_and_population.parquet?raw=true&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arrests</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>variable</th>
      <th>COUNTY</th>
      <th>year</th>
      <th>drug_arrest_rate</th>
      <th>total_population</th>
      <th>violent_arrest_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>75</th>
      <td>San Francisco County</td>
      <td>2018</td>
      <td>0.000915</td>
      <td>864263.0</td>
      <td>0.002377</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Mendocino County</td>
      <td>2018</td>
      <td>0.001371</td>
      <td>87497.0</td>
      <td>0.004354</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Shasta County</td>
      <td>2009</td>
      <td>0.002419</td>
      <td>179387.0</td>
      <td>0.002587</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Marin County</td>
      <td>2018</td>
      <td>0.000364</td>
      <td>260814.0</td>
      <td>0.002009</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alameda County</td>
      <td>2018</td>
      <td>0.000652</td>
      <td>1629615.0</td>
      <td>0.002536</td>
    </tr>
    <tr>
      <th>72</th>
      <td>San Diego County</td>
      <td>2009</td>
      <td>0.002560</td>
      <td>2987543.0</td>
      <td>0.003284</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Imperial County</td>
      <td>2009</td>
      <td>0.004562</td>
      <td>160034.0</td>
      <td>0.003743</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Merced County</td>
      <td>2018</td>
      <td>0.000621</td>
      <td>267390.0</td>
      <td>0.003848</td>
    </tr>
    <tr>
      <th>110</th>
      <td>Ventura County</td>
      <td>2009</td>
      <td>0.002575</td>
      <td>792313.0</td>
      <td>0.002871</td>
    </tr>
    <tr>
      <th>108</th>
      <td>Tuolumne County</td>
      <td>2009</td>
      <td>0.003748</td>
      <td>55761.0</td>
      <td>0.002869</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercise-10">
<h3>Exercise 10<a class="headerlink" href="#exercise-10" title="Link to this heading">#</a></h3>
<p>To run our difference-in-difference in a regression framework, we need both an indicator variable for observations that occur after legalization (i.e. year == 2018), and an indicator for the population we consider treated (those who had drug arrest rates above the average 2009 drug arrest rate). Re-create those here. Remember that your “high drug arrest rate in 2009” variable should only take on a single value for each county (regardless of the year of the observation).</p>
<p>As a check, store the number of counties that have a high drug arrest rate in 2009 under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex10_num_high_drug_arrest&quot;</span></code>.</p>
<p><em>Note:</em> if you want, you can also use the 2009 drug arrest rates as a continuous variable. This is a kind of “generalized difference-in-difference”, in which we’re just doing the continuous analogue of the thing we do when we split the sample into “high” and “low” 2009 arrest rates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Legalization indicator.</span>
<span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;after_legalization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arrests</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2018</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bit of a weird manipulation...</span>

<span class="n">arrests</span> <span class="o">=</span> <span class="n">arrests</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;drug_arrest_rate&quot;</span><span class="p">:</span> <span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">arrests</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">arrests</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="mi">2018</span><span class="p">,</span> <span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># Propagate 2009 values across observations in both time periods.</span>
<span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arrests</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>

<span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;high_2009_drug_arrest_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;drug_arrest_rate_2009&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arrests</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>variable</th>
      <th>COUNTY</th>
      <th>year</th>
      <th>drug_arrest_rate_2009</th>
      <th>total_population</th>
      <th>violent_arrest_rate</th>
      <th>after_legalization</th>
      <th>high_2009_drug_arrest_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alameda County</td>
      <td>2009</td>
      <td>0.003946</td>
      <td>1457095.0</td>
      <td>0.002963</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alameda County</td>
      <td>2018</td>
      <td>0.003946</td>
      <td>1629615.0</td>
      <td>0.002536</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alpine County</td>
      <td>2009</td>
      <td>0.001735</td>
      <td>1153.0</td>
      <td>0.006938</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alpine County</td>
      <td>2018</td>
      <td>0.001735</td>
      <td>1203.0</td>
      <td>0.004156</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Amador County</td>
      <td>2009</td>
      <td>0.002655</td>
      <td>38039.0</td>
      <td>0.002629</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex10_num_high_drug_arrest&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arrests</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;high_2009_drug_arrest_rate&quot;</span><span class="p">],</span> <span class="s2">&quot;COUNTY&quot;</span>
<span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex10_num_high_drug_arrest&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>23
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-11">
<h3>Exercise 11<a class="headerlink" href="#exercise-11" title="Link to this heading">#</a></h3>
<p>Now regression the violent arrest rate on your two indicators and their interaction. The coefficient on the interaction is your “difference-in-difference” estimate! If you go back to your old homeworks, you should find the coefficient is exactly what you calculated. Store this coefficient under the key  <code class="docutils literal notranslate"><span class="pre">&quot;ex11_diff_in_diff&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arrests</span><span class="o">.</span><span class="n">high_2009_drug_arrest_rate</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count       116
unique        2
top       False
freq         70
Name: high_2009_drug_arrest_rate, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here&#39;s with the discrete split of the sample</span>
<span class="n">arrest_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span>
    <span class="s2">&quot;violent_arrest_rate ~ high_2009_drug_arrest_rate &quot;</span>
    <span class="s2">&quot;+ after_legalization + after_legalization:high_2009_drug_arrest_rate&quot;</span><span class="p">,</span>
    <span class="n">arrests</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">arrest_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>    <td>violent_arrest_rate</td> <th>  R-squared:         </th> <td>   0.100</td>
</tr>
<tr>
  <th>Model:</th>                    <td>OLS</td>         <th>  Adj. R-squared:    </th> <td>   0.076</td>
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>    <th>  F-statistic:       </th> <td>   4.166</td>
</tr>
<tr>
  <th>Date:</th>              <td>Thu, 07 Nov 2024</td>   <th>  Prob (F-statistic):</th>  <td>0.00773</td>
</tr>
<tr>
  <th>Time:</th>                  <td>10:51:35</td>       <th>  Log-Likelihood:    </th> <td>  630.00</td>
</tr>
<tr>
  <th>No. Observations:</th>       <td>   116</td>        <th>  AIC:               </th> <td>  -1252.</td>
</tr>
<tr>
  <th>Df Residuals:</th>           <td>   112</td>        <th>  BIC:               </th> <td>  -1241.</td>
</tr>
<tr>
  <th>Df Model:</th>               <td>     3</td>        <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>      <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
                                <td></td>                                   <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                                                     <td>    0.0034</td> <td>    0.000</td> <td>   18.669</td> <td> 0.000</td> <td>    0.003</td> <td>    0.004</td>
</tr>
<tr>
  <th>high_2009_drug_arrest_rate[T.True]</th>                            <td>    0.0008</td> <td>    0.000</td> <td>    2.679</td> <td> 0.008</td> <td>    0.000</td> <td>    0.001</td>
</tr>
<tr>
  <th>after_legalization[T.True]</th>                                    <td>   -0.0002</td> <td>    0.000</td> <td>   -0.716</td> <td> 0.475</td> <td>   -0.001</td> <td>    0.000</td>
</tr>
<tr>
  <th>after_legalization[T.True]:high_2009_drug_arrest_rate[T.True]</th> <td>   -0.0002</td> <td>    0.000</td> <td>   -0.604</td> <td> 0.547</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>24.084</td> <th>  Durbin-Watson:     </th> <td>   1.239</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  33.273</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 1.057</td> <th>  Prob(JB):          </th> <td>5.95e-08</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.554</td> <th>  Cond. No.          </th> <td>    6.40</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex11_diff_in_diff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arrest_model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span>
    <span class="s2">&quot;after_legalization[T.True]:high_2009_drug_arrest_rate[T.True]&quot;</span>
<span class="p">]</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex11_diff_in_diff&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.00024739378861355775)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># And here&#39;s with the the continuous variable</span>
<span class="c1"># Note that interpretation of the magnitude of that coefficient is a little harder,</span>
<span class="c1"># as you have to evaluate it at reasonable values of drug_arrest_rate_2009.</span>
<span class="n">continuous_arrest_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span>
    <span class="s2">&quot;violent_arrest_rate ~ drug_arrest_rate_2009 + after_legalization &quot;</span>
    <span class="s2">&quot;+ after_legalization:drug_arrest_rate_2009&quot;</span><span class="p">,</span>
    <span class="n">arrests</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">continuous_arrest_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>    <td>violent_arrest_rate</td> <th>  R-squared:         </th> <td>   0.067</td>
</tr>
<tr>
  <th>Model:</th>                    <td>OLS</td>         <th>  Adj. R-squared:    </th> <td>   0.042</td>
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>    <th>  F-statistic:       </th> <td>   2.674</td>
</tr>
<tr>
  <th>Date:</th>              <td>Thu, 07 Nov 2024</td>   <th>  Prob (F-statistic):</th>  <td>0.0508</td> 
</tr>
<tr>
  <th>Time:</th>                  <td>10:51:36</td>       <th>  Log-Likelihood:    </th> <td>  627.87</td>
</tr>
<tr>
  <th>No. Observations:</th>       <td>   116</td>        <th>  AIC:               </th> <td>  -1248.</td>
</tr>
<tr>
  <th>Df Residuals:</th>           <td>   112</td>        <th>  BIC:               </th> <td>  -1237.</td>
</tr>
<tr>
  <th>Df Model:</th>               <td>     3</td>        <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>      <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
                          <td></td>                            <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                                        <td>    0.0029</td> <td>    0.000</td> <td>    8.367</td> <td> 0.000</td> <td>    0.002</td> <td>    0.004</td>
</tr>
<tr>
  <th>after_legalization[T.True]</th>                       <td>    0.0003</td> <td>    0.000</td> <td>    0.599</td> <td> 0.551</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
<tr>
  <th>drug_arrest_rate_2009</th>                            <td>    0.2409</td> <td>    0.100</td> <td>    2.399</td> <td> 0.018</td> <td>    0.042</td> <td>    0.440</td>
</tr>
<tr>
  <th>after_legalization[T.True]:drug_arrest_rate_2009</th> <td>   -0.1818</td> <td>    0.142</td> <td>   -1.280</td> <td> 0.203</td> <td>   -0.463</td> <td>    0.100</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>19.333</td> <th>  Durbin-Watson:     </th> <td>   1.161</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td> <th>  Jarque-Bera (JB):  </th> <td>  23.764</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.941</td> <th>  Prob(JB):          </th> <td>6.92e-06</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.174</td> <th>  Cond. No.          </th> <td>1.82e+03</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.82e+03. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</div></div>
</div>
</section>
<section id="exercise-12">
<h3>Exercise 12<a class="headerlink" href="#exercise-12" title="Link to this heading">#</a></h3>
<p>Now let’s do the same analysis, but this time using county population as a weight in a Weighted Least Squares regression (<code class="docutils literal notranslate"><span class="pre">smf.wls</span></code>). Just pass the keyword argument <code class="docutils literal notranslate"><span class="pre">weights</span></code> as a vector to weights (in this case, <code class="docutils literal notranslate"><span class="pre">arrests['total_population']</span></code>). Note that the <code class="docutils literal notranslate"><span class="pre">weights</span></code> argument is <em>outside</em> the formula, so you have to pass an actual vector of values, not just the name of a column.</p>
<p>Does your interpretation of the effects of drug legalization change? Store the new difference-in-difference coefficient under the key <code class="docutils literal notranslate"><span class="pre">&quot;ex12_diff_in_diff_weighted&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weighted_arrest_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">wls</span><span class="p">(</span>
    <span class="s2">&quot;violent_arrest_rate ~ high_2009_drug_arrest_rate&quot;</span>
    <span class="s2">&quot;+ after_legalization + after_legalization:high_2009_drug_arrest_rate&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">arrests</span><span class="p">,</span>
    <span class="n">weights</span><span class="o">=</span><span class="n">arrests</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">weighted_arrest_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>WLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>    <td>violent_arrest_rate</td> <th>  R-squared:         </th> <td>   0.396</td>
</tr>
<tr>
  <th>Model:</th>                    <td>WLS</td>         <th>  Adj. R-squared:    </th> <td>   0.380</td>
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>    <th>  F-statistic:       </th> <td>   24.52</td>
</tr>
<tr>
  <th>Date:</th>              <td>Thu, 07 Nov 2024</td>   <th>  Prob (F-statistic):</th> <td>2.86e-12</td>
</tr>
<tr>
  <th>Time:</th>                  <td>10:51:36</td>       <th>  Log-Likelihood:    </th> <td>  608.13</td>
</tr>
<tr>
  <th>No. Observations:</th>       <td>   116</td>        <th>  AIC:               </th> <td>  -1208.</td>
</tr>
<tr>
  <th>Df Residuals:</th>           <td>   112</td>        <th>  BIC:               </th> <td>  -1197.</td>
</tr>
<tr>
  <th>Df Model:</th>               <td>     3</td>        <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>      <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
                                <td></td>                                   <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                                                     <td>    0.0028</td> <td>    0.000</td> <td>   21.484</td> <td> 0.000</td> <td>    0.003</td> <td>    0.003</td>
</tr>
<tr>
  <th>high_2009_drug_arrest_rate[T.True]</th>                            <td>    0.0011</td> <td>    0.000</td> <td>    5.938</td> <td> 0.000</td> <td>    0.001</td> <td>    0.001</td>
</tr>
<tr>
  <th>after_legalization[T.True]</th>                                    <td>   -0.0004</td> <td>    0.000</td> <td>   -1.972</td> <td> 0.051</td> <td>   -0.001</td> <td> 1.76e-06</td>
</tr>
<tr>
  <th>after_legalization[T.True]:high_2009_drug_arrest_rate[T.True]</th> <td>   -0.0003</td> <td>    0.000</td> <td>   -1.171</td> <td> 0.244</td> <td>   -0.001</td> <td>    0.000</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 6.397</td> <th>  Durbin-Watson:     </th> <td>   1.073</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.041</td> <th>  Jarque-Bera (JB):  </th> <td>  10.179</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.125</td> <th>  Prob(JB):          </th> <td> 0.00616</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.429</td> <th>  Cond. No.          </th> <td>    7.31</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex12_diff_in_diff_weighted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weighted_arrest_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">params</span><span class="p">[</span>
    <span class="s2">&quot;after_legalization[T.True]:high_2009_drug_arrest_rate[T.True]&quot;</span>
<span class="p">]</span>
<span class="n">results</span><span class="p">[</span><span class="s2">&quot;ex12_diff_in_diff_weighted&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.00028837095306356473)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Not substantively really different.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ex10_num_high_drug_arrest&#39;,
 &#39;ex11_diff_in_diff&#39;,
 &#39;ex12_diff_in_diff_weighted&#39;,
 &#39;ex2_birth_weight_lower&#39;,
 &#39;ex3_smoking_coefficient&#39;,
 &#39;ex4_smoking_coefficient&#39;,
 &#39;ex6_compare_white_black&#39;,
 &#39;ex6_compare_white_black_tstat&#39;,
 &#39;ex7_predictions&#39;,
 &#39;ex8_smoking_coefficient&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="p">{</span>
    <span class="s2">&quot;ex10_num_high_drug_arrest&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex11_diff_in_diff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex12_diff_in_diff_weighted&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex2_birth_weight_lower&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex3_smoking_coefficient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex4_smoking_coefficient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex6_compare_white_black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex6_compare_white_black_tstat&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex7_predictions&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ex8_smoking_coefficient&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ids720_specific/exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradescope-autograding">Gradescope Autograding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#submission-limits">Submission Limits</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regression">Linear Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statsmodels-versus-r">statsmodels versus R</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weighting">Weighting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Bradbury & Nick Eubank
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>