
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Project: gathering, inspecting, and cleaning the data &#8212; Practical Data Science with Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Practical Data Science with Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Practical Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Setting Up Your Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_python.html">
   Setting Up Python and conda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_vscode.html">
   Setting Up VS Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_augmented_commandline.html">
   Augmenting Your Command Line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/jupyter_in_vscode.html">
   Jupyter Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/jupyter_r_notebooks.html">
   VS Code, R, and Jupyter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Command Line
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/commandline_part1.html">
   Command Line Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/commandline_part2.html">
     Advanced Command Line Tutorial
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Numpy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_2/week_2/10_why_numpy.html">
   Vectors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_2/20_intro_to_vectors.html">
     Working with Vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_2/21_math_with_vectors.html">
     Doing Math With Vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_2/23_type_promotion_in_vectors.html">
     Type Promotion in numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_4/10_speed_and_ease_of_use.html">
     The Python Ease of Use / Speed Tradeoff
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_4/11_vectorization.html">
     Vectorization in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_2/24_vector_recap.html">
     Vector Recap
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_2/week_2/30_subsetting_vectors.html">
   Subsetting Vectors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_2/35_modifying_subsets_of_vectors.html">
     Modifying Subsets of Vectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_2/37_vector_subsets_recap.html">
     Recap
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_2/week_3/10_views_and_copies.html">
   Views and Copies
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/11_when_do_I_get_a_view.html">
     When Do I Get a View and When Do I Get a Copy?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/13_objects_and_variables.html">
     Variables are pointers to objects
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/12_views_and_copies_recap.html">
     Review of Views and Copies
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_2/week_3/00_welcome_to_week_3.html">
   Matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/20_matrices.html">
     Intro to Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/22_reshaping_matrices.html">
     Folding and Reshaping Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/25_images_as_matrices.html">
     Matrices as Images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/30_subsetting_matrices.html">
     Subsetting Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/32_modifying_subsets.html">
     Editing Subsets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/33_matrix_recaps.html">
     Review of Matrices
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_2/week_3/40_nd_arrays.html">
   Arrays
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/41_broadcasting.html">
     Broadcasting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_3/42_nd_array_review.html">
     Review of ND-Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_4/03_summarizing_arrays.html">
     Summarizing Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_4/04_summarizing_arrays_example.html">
     Practical Example: comparing weather by counting like-values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_2/week_4/04.1_color_images_as_arrays.html">
     Color Images as Arrays
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../class_2/week_4/20_random_numbers.html">
   Random numbers
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_3/week_2/00_intro_to_pandas.html">
   Working with tabular data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_2/10_pandas_series.html">
     Pandas Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_2/15_manipulating_series.html">
     Subsetting and Indexing Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_2/16_indexing_with_brackets.html">
     (OPTIONAL) Subsetting and Indexing with Single Square Brackets (
     <code class="docutils literal notranslate">
      <span class="pre">
       []
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_2/30_pandas_dataframes.html">
     Working with tabular data through Dataframes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_2/35_pandas_dataframe_gotchas.html">
     Subsetting DataFrame Tricks and Gotchas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_3/week_3/00_plaintext_files.html">
   Ways To Store and Read Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/05_binary_files.html">
     Ways To Store and Read Data: Binary Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/10_views_and_copies_numpy_review.html">
     Views and Copies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/15_views_and_copies_in_pandas.html">
     Views and Copies in pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/17_views_and_copies_in_pandas_wo_CoW.html">
     The View/Copy Headache in pandas without Copy on Write
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/20_cleaning_identifying.html">
     Identifying Data Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/30_cleaning_editing_globally.html">
     Fixing Data Value Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/32_cleaning_editing_specific_locations.html">
     Editing Specific Locations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/33_cleaning_datatypes.html">
     Cleaning Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_3/35_cleaning_missing_data.html">
     Missing Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../class_3/week_4/00_intro_to_querying_data.html">
   Combining, grouping, and querying data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_4/10_combining_concatenating.html">
     Concatenating
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_4/15_combining_merging.html">
     Merging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_4/20_grouping.html">
     Grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../class_3/week_4/30_queries.html">
     Querying
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Practical Skills and Concepts
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/10_debugging_principles.html">
   Debugging
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/20_debugging_in_vscode.html">
     Debugging Python in VS Code
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming.html">
   Defensive Programming
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/iceberg_principle.html">
     The Iceberg Principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/workflow.html">
   Workflow Management
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/getting_help.html">
   Getting Help Online
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/vars_v_objects.html">
   Python: Variables vs. Objects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/python_v_r.html">
     Python vs. R: Important Differences To Be Aware Of
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/backwards_design.html">
   Backwards Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/ints_and_floats.html">
   Numbers in Computers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/writing_good_jupyter_notebooks.html">
   Writing Good Jupyter Notebooks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Miscellaneous
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../class_2/week_1/00_interactive_console.html">
   Running Python in the VS Code Interactive Window
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../class_2/week_4/30_managing_python_packages.html">
   Understanding and Managing Python Packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../other/fstrings.html">
   Combining numbers and text into strings: f-strings
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/nickeubank/practicaldatascience_book/main?urlpath=tree/docs/notebooks/class_5/week_5/55_project_data_gathering.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/nickeubank/practicaldatascience_book/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/nickeubank/practicaldatascience_book//issues/new?title=Issue%20on%20page%20%2Fnotebooks/class_5/week_5/55_project_data_gathering.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/notebooks/class_5/week_5/55_project_data_gathering.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-sources">
   Data Sources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-exploration">
   Data Exploration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-1-of-4-carbon-dioxide-emissions-data">
     Dataset 1 of 4: Carbon dioxide emissions data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-2-of-4-income-per-person">
     Dataset 2 of 4: Income per person
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-3-of-4-population">
     Dataset 3 of 4: Population
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-4-of-4-continents-global-regions">
     Dataset 4 of 4: Continents / global regions
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Project: gathering, inspecting, and cleaning the data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-sources">
   Data Sources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-exploration">
   Data Exploration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-1-of-4-carbon-dioxide-emissions-data">
     Dataset 1 of 4: Carbon dioxide emissions data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-2-of-4-income-per-person">
     Dataset 2 of 4: Income per person
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-3-of-4-population">
     Dataset 3 of 4: Population
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dataset-4-of-4-continents-global-regions">
     Dataset 4 of 4: Continents / global regions
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="project-gathering-inspecting-and-cleaning-the-data">
<h1>Project: gathering, inspecting, and cleaning the data<a class="headerlink" href="#project-gathering-inspecting-and-cleaning-the-data" title="Permalink to this headline">#</a></h1>
<p>In this step of the project, we’ll gather the data that we need</p>
<ol class="simple">
<li><p>Carbon dioxide emissions by country</p></li>
<li><p>Income (as measured by GDP per capita) by country</p></li>
<li><p>Population by country (so we can convert CO2 emissions into per capita emissions)</p></li>
<li><p>List of territories by continent (since we want to be able to group the countries by region of the world)</p></li>
</ol>
<p>As we load each dataset we will explore it and perform some pre-processing steps to prepare the data for merging it together for our plots. We’ll be on the lookout for any inconsistencies in the data (numbers and text mixed up in the data), missing data which may dictate which years we will be able to plot in our final plot.</p>
<section id="data-sources">
<h2>Data Sources<a class="headerlink" href="#data-sources" title="Permalink to this headline">#</a></h2>
<p>Let’s start by loading our four data sources. The first three sources are provided on the GapMinder website, but each has a slightly different source.</p>
<ol class="simple">
<li><p><a class="reference external" href="https://www.gapminder.org/tools/#%24model%24markers%24spreadsheet%24encoding%24number%24data%24concept=co2_emissions_tonnes_per_person&amp;space&#64;=country&amp;=time%3B%3B&amp;scale%24domain:null&amp;type:null&amp;zoomed:null%3B%3B&amp;label%24data%24concept=name%3B%3B&amp;frame%24value=2018&amp;data%24concept=time%3B%3B%3B%3B%3B%3B&amp;chart-type=spreadsheet&amp;url=v1"><strong>Carbon dioxide emissions</strong></a> (tonnes per person). These data are corbon dioxide emissions from the burning of fossil fuels in the units of metric tonnes pf CO2 per person. These data are sourced from the <a class="reference external" href="https://cdiac.ess-dive.lbl.gov/">Carbon Dioxide Information Analysis Center</a> at Lawrence Berkeley National Laboratory. If you download these data as a CSV you will get the file ‘co2_emissions_tonnes_per_person.csv’, which we have included in the <code class="docutils literal notranslate"><span class="pre">data/</span></code> folder.</p></li>
<li><p><a class="reference external" href="https://www.gapminder.org/tools/#%24model%24markers%24spreadsheet%24encoding%24number%24data%24concept=income_per_person_gdppercapita_ppp_inflation_adjusted&amp;space&#64;=country&amp;=time%3B%3B&amp;scale%24domain:null&amp;type:null&amp;zoomed:null%3B%3B&amp;label%24data%24concept=name%3B%3B&amp;frame%24value=2018&amp;data%24concept=time%3B%3B%3B%3B%3B%3B&amp;chart-type=spreadsheet&amp;url=v1"><strong>Income per person</strong></a> (gross domestic product per capita, in international dollars, inflation-adjusted to 2011 prices). These data are sourced from the Gapminder based on World Bank, A. Maddison, M. Lindgren, International Monetary Fund, and others:  <a class="reference external" href="https://www.gapminder.org/data/documentation/gd001/">link to more information on the data source</a>. If you download these data as a CSV you will get the file ‘income_per_person_gdppercapita_ppp_inflation_adjusted.csv’, which we have included in the <code class="docutils literal notranslate"><span class="pre">data/</span></code> folder.</p></li>
<li><p><a class="reference external" href="https://www.gapminder.org/tools/#%24model%24markers%24spreadsheet%24encoding%24number%24data%24concept=population_total&amp;space&#64;=country&amp;=time%3B%3B&amp;scale%24domain:null&amp;type:null&amp;zoomed:null%3B%3B&amp;label%24data%24concept=name%3B%3B&amp;frame%24value=2018&amp;data%24concept=time%3B%3B%3B%3B%3B%3B&amp;chart-type=spreadsheet&amp;url=v1"><strong>Population</strong></a>. These data are sourced from Gapminder based on Maddison and the United Nations: <a class="reference external" href="http://gapm.io/dpop">link to more information on the data source</a>. If you download these data as a CSV you will get the file ‘population_total.csv’, which we have included in the <code class="docutils literal notranslate"><span class="pre">data/</span></code> folder.</p></li>
<li><p><a class="reference external" href="https://unstats.un.org/unsd/methodology/m49/overview"><strong>Territories by continent</strong></a>. These data are sourced from the United Nations. These data are provided in the file ‘united_nations_continents.csv’ which we have included in the <code class="docutils literal notranslate"><span class="pre">data/</span></code> folder.</p></li>
</ol>
<p>At each of the above links you could have clicked the “CSV” button to grab the data, but we have done that and provided all of the data in the <code class="docutils literal notranslate"><span class="pre">data/</span></code> folder so you can get started exploring these data right away, but we have not changed the content of each dataset at all.</p>
</section>
<section id="data-exploration">
<h2>Data Exploration<a class="headerlink" href="#data-exploration" title="Permalink to this headline">#</a></h2>
<p>Before you begin using any dataset, you should get to know it a bit to understand its content, check for missing or anomalous values, and determine whether any additional processing is needed before you analyze it further. We’ll walk through each of these four datasets, starting with carbon dioxide emissions.</p>
<section id="dataset-1-of-4-carbon-dioxide-emissions-data">
<h3>Dataset 1 of 4: Carbon dioxide emissions data<a class="headerlink" href="#dataset-1-of-4-carbon-dioxide-emissions-data" title="Permalink to this headline">#</a></h3>
<p>Let’s start by loading our data into a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and take a look at the first 10 rows of content:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">co2_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/co2_emissions_tonnes_per_person.csv&#39;</span><span class="p">)</span>
<span class="n">co2_all</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>1799</th>
      <th>1800</th>
      <th>1801</th>
      <th>1802</th>
      <th>1803</th>
      <th>1804</th>
      <th>1805</th>
      <th>1806</th>
      <th>1807</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.238</td>
      <td>0.29</td>
      <td>0.406</td>
      <td>0.345</td>
      <td>0.28</td>
      <td>0.253</td>
      <td>0.262</td>
      <td>0.245</td>
      <td>0.247</td>
      <td>0.254</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.230</td>
      <td>1.24</td>
      <td>1.250</td>
      <td>1.350</td>
      <td>1.28</td>
      <td>1.640</td>
      <td>1.220</td>
      <td>1.180</td>
      <td>1.140</td>
      <td>1.120</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.470</td>
      <td>1.56</td>
      <td>1.790</td>
      <td>1.690</td>
      <td>1.69</td>
      <td>1.900</td>
      <td>1.600</td>
      <td>1.570</td>
      <td>1.610</td>
      <td>1.590</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>6.120</td>
      <td>6.12</td>
      <td>5.870</td>
      <td>5.920</td>
      <td>5.90</td>
      <td>5.830</td>
      <td>5.970</td>
      <td>6.070</td>
      <td>6.270</td>
      <td>6.120</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>20.900</td>
      <td>18.30</td>
      <td>18.900</td>
      <td>23.800</td>
      <td>23.70</td>
      <td>24.200</td>
      <td>20.700</td>
      <td>21.700</td>
      <td>21.100</td>
      <td>21.400</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.420</td>
      <td>4.57</td>
      <td>4.610</td>
      <td>4.600</td>
      <td>4.56</td>
      <td>4.560</td>
      <td>4.640</td>
      <td>4.600</td>
      <td>4.550</td>
      <td>4.410</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.510</td>
      <td>1.48</td>
      <td>1.730</td>
      <td>1.990</td>
      <td>1.91</td>
      <td>1.910</td>
      <td>1.650</td>
      <td>1.760</td>
      <td>1.700</td>
      <td>1.890</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Antigua and Barbuda</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>5.880</td>
      <td>5.96</td>
      <td>5.750</td>
      <td>5.800</td>
      <td>5.73</td>
      <td>5.700</td>
      <td>5.840</td>
      <td>5.900</td>
      <td>5.890</td>
      <td>5.880</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Australia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>18.800</td>
      <td>18.40</td>
      <td>18.000</td>
      <td>17.800</td>
      <td>17.10</td>
      <td>16.700</td>
      <td>16.800</td>
      <td>17.000</td>
      <td>17.000</td>
      <td>16.900</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Austria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.054</td>
      <td>NaN</td>
      <td>...</td>
      <td>8.100</td>
      <td>8.60</td>
      <td>8.300</td>
      <td>7.950</td>
      <td>7.97</td>
      <td>7.490</td>
      <td>7.700</td>
      <td>7.700</td>
      <td>7.940</td>
      <td>7.750</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 220 columns</p>
</div></div></div>
</div>
<p>Let’s also use the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method to summarize the contents:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_all</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1799</th>
      <th>1800</th>
      <th>1801</th>
      <th>1802</th>
      <th>1803</th>
      <th>1804</th>
      <th>1805</th>
      <th>1806</th>
      <th>1807</th>
      <th>1808</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>7.000000</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>...</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
      <td>194.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.523786</td>
      <td>0.517832</td>
      <td>0.659911</td>
      <td>0.570422</td>
      <td>0.489042</td>
      <td>0.590578</td>
      <td>0.611746</td>
      <td>0.526380</td>
      <td>0.599746</td>
      <td>0.593316</td>
      <td>...</td>
      <td>4.623215</td>
      <td>4.725098</td>
      <td>4.668183</td>
      <td>4.722525</td>
      <td>4.638652</td>
      <td>4.598566</td>
      <td>4.496805</td>
      <td>4.466514</td>
      <td>4.490955</td>
      <td>4.499112</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.093672</td>
      <td>1.085826</td>
      <td>1.065140</td>
      <td>1.201775</td>
      <td>1.083367</td>
      <td>1.224113</td>
      <td>1.279321</td>
      <td>1.148889</td>
      <td>1.252499</td>
      <td>1.239320</td>
      <td>...</td>
      <td>6.102350</td>
      <td>6.137543</td>
      <td>6.049405</td>
      <td>6.201106</td>
      <td>5.915767</td>
      <td>6.024297</td>
      <td>5.802658</td>
      <td>5.636840</td>
      <td>5.647153</td>
      <td>5.604449</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.007330</td>
      <td>0.007160</td>
      <td>0.006980</td>
      <td>0.006810</td>
      <td>0.006650</td>
      <td>0.006490</td>
      <td>0.006330</td>
      <td>0.006180</td>
      <td>0.006030</td>
      <td>0.005880</td>
      <td>...</td>
      <td>0.022700</td>
      <td>0.030400</td>
      <td>0.036600</td>
      <td>0.034200</td>
      <td>0.041900</td>
      <td>0.038300</td>
      <td>0.036700</td>
      <td>0.025400</td>
      <td>0.024400</td>
      <td>0.024300</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.042200</td>
      <td>0.029300</td>
      <td>0.038150</td>
      <td>0.028300</td>
      <td>0.050025</td>
      <td>0.051700</td>
      <td>0.047300</td>
      <td>0.043425</td>
      <td>0.043800</td>
      <td>0.044700</td>
      <td>...</td>
      <td>0.543500</td>
      <td>0.609000</td>
      <td>0.622500</td>
      <td>0.635000</td>
      <td>0.670250</td>
      <td>0.677000</td>
      <td>0.672500</td>
      <td>0.694250</td>
      <td>0.686750</td>
      <td>0.688750</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.044200</td>
      <td>0.043800</td>
      <td>0.049400</td>
      <td>0.046800</td>
      <td>0.052050</td>
      <td>0.053400</td>
      <td>0.049700</td>
      <td>0.054600</td>
      <td>0.052600</td>
      <td>0.049200</td>
      <td>...</td>
      <td>2.380000</td>
      <td>2.420000</td>
      <td>2.375000</td>
      <td>2.490000</td>
      <td>2.460000</td>
      <td>2.510000</td>
      <td>2.525000</td>
      <td>2.500000</td>
      <td>2.535000</td>
      <td>2.540000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.045200</td>
      <td>0.048900</td>
      <td>1.018350</td>
      <td>0.050200</td>
      <td>0.068625</td>
      <td>0.061300</td>
      <td>0.055400</td>
      <td>0.113550</td>
      <td>0.056300</td>
      <td>0.056800</td>
      <td>...</td>
      <td>6.142500</td>
      <td>6.437500</td>
      <td>6.635000</td>
      <td>6.575000</td>
      <td>6.235000</td>
      <td>6.182500</td>
      <td>5.895000</td>
      <td>6.062500</td>
      <td>6.032500</td>
      <td>6.015000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.480000</td>
      <td>2.460000</td>
      <td>2.450000</td>
      <td>2.720000</td>
      <td>2.700000</td>
      <td>2.780000</td>
      <td>2.900000</td>
      <td>2.870000</td>
      <td>2.840000</td>
      <td>2.810000</td>
      <td>...</td>
      <td>41.500000</td>
      <td>38.800000</td>
      <td>39.200000</td>
      <td>42.500000</td>
      <td>36.000000</td>
      <td>43.100000</td>
      <td>41.300000</td>
      <td>38.500000</td>
      <td>39.800000</td>
      <td>38.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 215 columns</p>
</div></div></div>
</div>
<p>Looking at the data we learn a few things. First, the dataset contains data on CO2 starting in 1799 and going through 2017. For the plot we will be creating, we only need to plot one year of data, likely the most recent year. Since we only have data up to 2017, we’ll need to use that as the common year. Going forward, we’ll only concern ourselves with data from 2017.</p>
<p>Second, we see that many of those early years have <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values, which indicates there is no data present. We can see in the “count” row of the description above that in 1799 and 1800, only 5 entries are non-empty, and this number is 194 from 2008 forward. Let’s see how many countries we have in total, by using the <code class="docutils literal notranslate"><span class="pre">shape</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">co2_all</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_all</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(194, 220)
</pre></div>
</div>
</div>
</div>
<p>We have 194 rows and 194 non-empty values in the later years that are included, so we have one value for each country on this list in 2017. We’ll want to use the latest data that we have to make the plot as relevant as possible, so the last thing to do is to just extract the 2017 data. We’ll need the 2017 column for the data as well as the corresponding country/territory so we can combine the data later with income and population:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span> <span class="o">=</span> <span class="n">co2_all</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">]]</span>
<span class="n">co2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.254</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.120</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>1.590</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>6.120</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>21.400</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Samoa</td>
      <td>1.320</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Yemen</td>
      <td>0.356</td>
    </tr>
    <tr>
      <th>191</th>
      <td>South Africa</td>
      <td>8.100</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zambia</td>
      <td>0.302</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Zimbabwe</td>
      <td>0.850</td>
    </tr>
  </tbody>
</table>
<p>194 rows × 2 columns</p>
</div></div></div>
</div>
<p>One last step: since we’ll eventually be merging our columns together, let’s rename the ‘2017’ column so that it is more self-explanatory and call it ‘co2’ using the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;2017&#39;</span><span class="p">:</span><span class="s1">&#39;co2&#39;</span><span class="p">})</span>
<span class="n">co2</span>
</pre></div>
</div>
</div>
</div>
<p>The CO2 emissions data is ready for use! Let’s move on to exploring income per person.</p>
</section>
<section id="dataset-2-of-4-income-per-person">
<h3>Dataset 2 of 4: Income per person<a class="headerlink" href="#dataset-2-of-4-income-per-person" title="Permalink to this headline">#</a></h3>
<p>Again, let’s start by loading and viewing the first 10 rows of our data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/income_per_person_gdppercapita_ppp_inflation_adjusted.csv&#39;</span><span class="p">)</span>
<span class="n">income_all</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>1799</th>
      <th>1800</th>
      <th>1801</th>
      <th>1802</th>
      <th>1803</th>
      <th>1804</th>
      <th>1805</th>
      <th>1806</th>
      <th>1807</th>
      <th>...</th>
      <th>2040</th>
      <th>2041</th>
      <th>2042</th>
      <th>2043</th>
      <th>2044</th>
      <th>2045</th>
      <th>2046</th>
      <th>2047</th>
      <th>2048</th>
      <th>2049</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>683</td>
      <td>...</td>
      <td>2690</td>
      <td>2750</td>
      <td>2810</td>
      <td>2870</td>
      <td>2930</td>
      <td>2990</td>
      <td>3060</td>
      <td>3120</td>
      <td>3190</td>
      <td>3260</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>700</td>
      <td>702</td>
      <td>705</td>
      <td>709</td>
      <td>711</td>
      <td>714</td>
      <td>718</td>
      <td>721</td>
      <td>725</td>
      <td>...</td>
      <td>8000</td>
      <td>8170</td>
      <td>8350</td>
      <td>8530</td>
      <td>8710</td>
      <td>8900</td>
      <td>9090</td>
      <td>9280</td>
      <td>9480</td>
      <td>9690</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>755</td>
      <td>755</td>
      <td>755</td>
      <td>755</td>
      <td>755</td>
      <td>756</td>
      <td>756</td>
      <td>756</td>
      <td>756</td>
      <td>...</td>
      <td>25.1k</td>
      <td>25.6k</td>
      <td>26.2k</td>
      <td>26.7k</td>
      <td>27.3k</td>
      <td>27.9k</td>
      <td>28.5k</td>
      <td>29.1k</td>
      <td>29.7k</td>
      <td>30.4k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>1360</td>
      <td>1360</td>
      <td>1360</td>
      <td>1360</td>
      <td>1370</td>
      <td>1370</td>
      <td>1370</td>
      <td>1370</td>
      <td>1380</td>
      <td>...</td>
      <td>68.9k</td>
      <td>70.4k</td>
      <td>71.9k</td>
      <td>73.4k</td>
      <td>75k</td>
      <td>76.6k</td>
      <td>78.3k</td>
      <td>80k</td>
      <td>81.7k</td>
      <td>83.4k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>1130</td>
      <td>1130</td>
      <td>1140</td>
      <td>1140</td>
      <td>1150</td>
      <td>1150</td>
      <td>1160</td>
      <td>1160</td>
      <td>1160</td>
      <td>...</td>
      <td>101k</td>
      <td>103k</td>
      <td>105k</td>
      <td>107k</td>
      <td>110k</td>
      <td>112k</td>
      <td>114k</td>
      <td>117k</td>
      <td>119k</td>
      <td>122k</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Argentina</td>
      <td>1730</td>
      <td>1730</td>
      <td>1740</td>
      <td>1740</td>
      <td>1750</td>
      <td>1760</td>
      <td>1760</td>
      <td>1770</td>
      <td>1770</td>
      <td>...</td>
      <td>30.5k</td>
      <td>31.1k</td>
      <td>31.8k</td>
      <td>32.5k</td>
      <td>33.2k</td>
      <td>33.9k</td>
      <td>34.7k</td>
      <td>35.4k</td>
      <td>36.2k</td>
      <td>36.9k</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Armenia</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>582</td>
      <td>...</td>
      <td>24.7k</td>
      <td>25.2k</td>
      <td>25.8k</td>
      <td>26.3k</td>
      <td>26.9k</td>
      <td>27.5k</td>
      <td>28.1k</td>
      <td>28.7k</td>
      <td>29.3k</td>
      <td>29.9k</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Antigua and Barbuda</td>
      <td>857</td>
      <td>857</td>
      <td>857</td>
      <td>857</td>
      <td>857</td>
      <td>857</td>
      <td>857</td>
      <td>858</td>
      <td>858</td>
      <td>...</td>
      <td>26.4k</td>
      <td>27k</td>
      <td>27.6k</td>
      <td>28.1k</td>
      <td>28.8k</td>
      <td>29.4k</td>
      <td>30k</td>
      <td>30.7k</td>
      <td>31.3k</td>
      <td>32k</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Australia</td>
      <td>925</td>
      <td>930</td>
      <td>936</td>
      <td>941</td>
      <td>947</td>
      <td>952</td>
      <td>956</td>
      <td>962</td>
      <td>968</td>
      <td>...</td>
      <td>72k</td>
      <td>73.5k</td>
      <td>75.1k</td>
      <td>76.7k</td>
      <td>78.4k</td>
      <td>80.1k</td>
      <td>81.8k</td>
      <td>83.5k</td>
      <td>85.3k</td>
      <td>87.2k</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Austria</td>
      <td>2090</td>
      <td>2100</td>
      <td>2110</td>
      <td>2120</td>
      <td>2130</td>
      <td>2130</td>
      <td>2140</td>
      <td>2150</td>
      <td>2160</td>
      <td>...</td>
      <td>77.8k</td>
      <td>79.5k</td>
      <td>81.2k</td>
      <td>83k</td>
      <td>84.7k</td>
      <td>86.6k</td>
      <td>88.4k</td>
      <td>90.3k</td>
      <td>92.3k</td>
      <td>94.3k</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 252 columns</p>
</div></div></div>
</div>
<p>As we look over the dataset here, we can see we have data that goes from 1799 through 2049. So clearly the later years are projections rather than measured data (unless the data providers have a time traveler on staff!).</p>
<p>We know that we’re only concerned with the year 2017 from our discussion of CO2 data, so let’s extract the year 2017 and the country:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_2017</span> <span class="o">=</span> <span class="n">income_all</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">]]</span>
<span class="n">income_2017</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2030</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>6930</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>13.3k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>58.3k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>67k</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Samoa</td>
      <td>6390</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Yemen</td>
      <td>2660</td>
    </tr>
    <tr>
      <th>192</th>
      <td>South Africa</td>
      <td>13.9k</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Zambia</td>
      <td>3520</td>
    </tr>
    <tr>
      <th>194</th>
      <td>Zimbabwe</td>
      <td>3920</td>
    </tr>
  </tbody>
</table>
<p>195 rows × 2 columns</p>
</div></div></div>
</div>
<p>But notice something odd here… Some of the values have the letter ‘k’ at the end of a number. While ‘k’ is the SI shorthand for a thousand units (representing “kilo”). But what is it doing in our dataset? Let’s take a look at the data types in our data. We’d expect those to be numbers: floats or integers or something similar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income_2017</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country    object
2017       object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>OK, the data from 2017 are objects, not floats or integers, just like the column for ‘country’. Let’s take a look at one of the entries in 2017 and see what’s going on with the data there.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_entry</span> <span class="o">=</span> <span class="n">income_2017</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">first_entry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;2030&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">first_entry</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>str
</pre></div>
</div>
</div>
</div>
<p>It’s a string! It’s not a number. The authors of the data represented the number 12,000 as the string ‘12k’ instead. We need to correct this since all data that we plot will need to be numerical.</p>
<p>For each value, we’ll need to read in the string - if there are no letters in the entry, we just need to convert it to a number. If there is a letter k in it, we need to remove that letter and THEN convert the rest into a number and multiply it by 1,000. Let’s create a function that does that:</p>
<p><strong>EXERCISE: Write a function that takes a string as input and outputs the correct numerical representation of the number as a float. That is, if the input is ‘20’ then the output should be the number 20.0; if the input is ‘20k’ then the output should be the number 20000.0</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># BREAK HERE AND DIRECT STUDENTS TO GRADED LAB</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">string2num</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;k&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">1000</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">number</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">string2num</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string2num</span><span class="p">(</span><span class="s1">&#39;2k&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
2000.0
</pre></div>
</div>
</div>
</div>
<p>Now let’s apply our function to our data for each entry in 2017. But before we do, let’s make a copy of our data so we don’t edit the original (<code class="docutils literal notranslate"><span class="pre">deep</span> <span class="pre">=</span> <span class="pre">True</span></code> ensures all the data are a copy rather than a view):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income</span> <span class="o">=</span> <span class="n">income_2017</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> method <code class="docutils literal notranslate"><span class="pre">apply()</span></code> to apply our <code class="docutils literal notranslate"><span class="pre">string2num</span></code> function to <em>each entry</em> in our ‘2017’ column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">income_2017</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">string2num</span><span class="p">)</span>
<span class="n">income</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2030.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>6930.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>13300.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>58300.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>67000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Samoa</td>
      <td>6390.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Yemen</td>
      <td>2660.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>South Africa</td>
      <td>13900.0</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Zambia</td>
      <td>3520.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>Zimbabwe</td>
      <td>3920.0</td>
    </tr>
  </tbody>
</table>
<p>195 rows × 2 columns</p>
</div></div></div>
</div>
<p>While it looks like we have successfully converted the strings to floats, let’s look at our data types again to ensure we fixed the issue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country     object
2017       float64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Great! We have a column of floats now, so it looks like our fix worked. Let’s make one more check to see whether there are any <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values introduced - we want to avoid introducing anything like that into the mix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>No <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values - so we’re all set!</p>
<p>And as our last step, let’s also rename the column header from ‘2017’ to ‘income’, similar to what we did with <code class="docutils literal notranslate"><span class="pre">co2</span></code> above, so that its content is clear and it will be ready to be merged together after we’ve loaded each of our four datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income</span> <span class="o">=</span> <span class="n">income</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;2017&#39;</span><span class="p">:</span><span class="s1">&#39;income&#39;</span><span class="p">})</span>
<span class="n">income</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2030.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>6930.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>13300.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>58300.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>67000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Samoa</td>
      <td>6390.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Yemen</td>
      <td>2660.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>South Africa</td>
      <td>13900.0</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Zambia</td>
      <td>3520.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>Zimbabwe</td>
      <td>3920.0</td>
    </tr>
  </tbody>
</table>
<p>195 rows × 2 columns</p>
</div></div></div>
</div>
<p>With both CO2 and income data prepared, population is next!</p>
</section>
<section id="dataset-3-of-4-population">
<h3>Dataset 3 of 4: Population<a class="headerlink" href="#dataset-3-of-4-population" title="Permalink to this headline">#</a></h3>
<p>As is our standard practice at this point, let’s load in and view the first 10 entries in our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/population_total.csv&#39;</span><span class="p">)</span>
<span class="n">pop_all</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>1799</th>
      <th>1800</th>
      <th>1801</th>
      <th>1802</th>
      <th>1803</th>
      <th>1804</th>
      <th>1805</th>
      <th>1806</th>
      <th>1807</th>
      <th>...</th>
      <th>2090</th>
      <th>2091</th>
      <th>2092</th>
      <th>2093</th>
      <th>2094</th>
      <th>2095</th>
      <th>2096</th>
      <th>2097</th>
      <th>2098</th>
      <th>2099</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>3.28M</td>
      <td>...</td>
      <td>76.6M</td>
      <td>76.4M</td>
      <td>76.3M</td>
      <td>76.1M</td>
      <td>76M</td>
      <td>75.8M</td>
      <td>75.6M</td>
      <td>75.4M</td>
      <td>75.2M</td>
      <td>74.9M</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>1.57M</td>
      <td>...</td>
      <td>168M</td>
      <td>170M</td>
      <td>172M</td>
      <td>175M</td>
      <td>177M</td>
      <td>179M</td>
      <td>182M</td>
      <td>184M</td>
      <td>186M</td>
      <td>188M</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>400k</td>
      <td>402k</td>
      <td>404k</td>
      <td>405k</td>
      <td>407k</td>
      <td>409k</td>
      <td>411k</td>
      <td>413k</td>
      <td>414k</td>
      <td>...</td>
      <td>1.33M</td>
      <td>1.3M</td>
      <td>1.27M</td>
      <td>1.25M</td>
      <td>1.22M</td>
      <td>1.19M</td>
      <td>1.17M</td>
      <td>1.14M</td>
      <td>1.11M</td>
      <td>1.09M</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>2650</td>
      <td>...</td>
      <td>63k</td>
      <td>62.9k</td>
      <td>62.9k</td>
      <td>62.8k</td>
      <td>62.7k</td>
      <td>62.7k</td>
      <td>62.6k</td>
      <td>62.5k</td>
      <td>62.5k</td>
      <td>62.4k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>40.2k</td>
      <td>...</td>
      <td>12.3M</td>
      <td>12.4M</td>
      <td>12.5M</td>
      <td>12.5M</td>
      <td>12.6M</td>
      <td>12.7M</td>
      <td>12.7M</td>
      <td>12.8M</td>
      <td>12.8M</td>
      <td>12.9M</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Argentina</td>
      <td>534k</td>
      <td>520k</td>
      <td>506k</td>
      <td>492k</td>
      <td>479k</td>
      <td>466k</td>
      <td>453k</td>
      <td>441k</td>
      <td>429k</td>
      <td>...</td>
      <td>57.5M</td>
      <td>57.5M</td>
      <td>57.4M</td>
      <td>57.3M</td>
      <td>57.2M</td>
      <td>57.2M</td>
      <td>57.1M</td>
      <td>57M</td>
      <td>56.9M</td>
      <td>56.8M</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Armenia</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>413k</td>
      <td>...</td>
      <td>2.18M</td>
      <td>2.16M</td>
      <td>2.15M</td>
      <td>2.13M</td>
      <td>2.12M</td>
      <td>2.1M</td>
      <td>2.09M</td>
      <td>2.07M</td>
      <td>2.05M</td>
      <td>2.04M</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Antigua and Barbuda</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>37k</td>
      <td>...</td>
      <td>105k</td>
      <td>104k</td>
      <td>104k</td>
      <td>104k</td>
      <td>104k</td>
      <td>103k</td>
      <td>103k</td>
      <td>103k</td>
      <td>102k</td>
      <td>102k</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Australia</td>
      <td>200k</td>
      <td>205k</td>
      <td>211k</td>
      <td>216k</td>
      <td>222k</td>
      <td>227k</td>
      <td>233k</td>
      <td>239k</td>
      <td>246k</td>
      <td>...</td>
      <td>41.1M</td>
      <td>41.3M</td>
      <td>41.5M</td>
      <td>41.7M</td>
      <td>41.9M</td>
      <td>42.1M</td>
      <td>42.3M</td>
      <td>42.5M</td>
      <td>42.7M</td>
      <td>42.9M</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Austria</td>
      <td>3M</td>
      <td>3.02M</td>
      <td>3.04M</td>
      <td>3.05M</td>
      <td>3.07M</td>
      <td>3.09M</td>
      <td>3.11M</td>
      <td>3.12M</td>
      <td>3.14M</td>
      <td>...</td>
      <td>8.65M</td>
      <td>8.65M</td>
      <td>8.65M</td>
      <td>8.65M</td>
      <td>8.65M</td>
      <td>8.66M</td>
      <td>8.66M</td>
      <td>8.67M</td>
      <td>8.67M</td>
      <td>8.68M</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 302 columns</p>
</div></div></div>
</div>
<p>These data go well into the future, all the way out to 2099. Let’s begin by grabbing the 2017 data and dive a bit deeper.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_2017</span> <span class="o">=</span> <span class="n">pop_all</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">]]</span>
<span class="n">pop_2017</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>37.2M</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>30.8M</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>2.88M</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>77k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>9.63M</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Samoa</td>
      <td>196k</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Yemen</td>
      <td>28.5M</td>
    </tr>
    <tr>
      <th>194</th>
      <td>South Africa</td>
      <td>57.8M</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Zambia</td>
      <td>17.4M</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Zimbabwe</td>
      <td>14.4M</td>
    </tr>
  </tbody>
</table>
<p>197 rows × 2 columns</p>
</div></div></div>
</div>
<p>It looks like we have suffixes of ‘k’ and ‘M’ (representing millions). We will have to apply a similar function to what we used for income here to prepare these data. But we have to ask the question: are ‘k’ and ‘M’ the <em>only</em> suffixes included in the data or are there others? Let’s write a function to figure that out.</p>
<p><strong>EXERCISE: Create a function that takes in a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array (into which we will pass the 2017 population values of <code class="docutils literal notranslate"><span class="pre">pop_2017['2017'].values</span></code>) and searches through them to find any alphabetic letters that are present.</strong> Hint: we recommend looking into the string method <code class="docutils literal notranslate"><span class="pre">isalpha()</span></code> and the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> method <code class="docutils literal notranslate"><span class="pre">unique()</span></code> to help with this exercise.</p>
<p>For example, if your array of strings contained the following:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>string list</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘13k’</p></td>
</tr>
<tr class="row-odd"><td><p>‘546’</p></td>
</tr>
<tr class="row-even"><td><p>‘9M’</p></td>
</tr>
<tr class="row-odd"><td><p>‘12M’</p></td>
</tr>
<tr class="row-even"><td><p>‘900k’</p></td>
</tr>
</tbody>
</table>
<p>Desited output: [‘k’, ‘M’]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># BREAK HERE AND DIRECT STUDENTS TO GRADED LAB</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SOLUTION</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">getcharacters</span><span class="p">(</span><span class="n">string_list</span><span class="p">):</span>
    <span class="n">characters</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">string_list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">character</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">character</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                <span class="n">characters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">character</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">characters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;B&#39;, &#39;M&#39;, &#39;k&#39;], dtype=&#39;&lt;U1&#39;)
</pre></div>
</div>
</div>
</div>
<p>Let’s apply the function we created to our dataset to see what string values are present:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_characters</span> <span class="o">=</span> <span class="n">getcharacters</span><span class="p">(</span><span class="n">pop_2017</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">unique_characters</span>
</pre></div>
</div>
</div>
</div>
<p>Great! we now know that we need to handle thousands (‘k’), millions (‘M’), and billions (‘B’).</p>
<p><strong>EXERCISE: adjust your <code class="docutils literal notranslate"><span class="pre">string2num()</span></code> function that we created earlier to accommodate replacing the ‘k’, ‘M’ and ‘B’ characters</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># BREAK HERE AND DIRECT STUDENTS TO GRADED LAB</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">string2num</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;k&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mi">1000</span>
    <span class="k">elif</span> <span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">1e6</span>
    <span class="k">elif</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">1e9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">number</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">string2num</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string2num</span><span class="p">(</span><span class="s1">&#39;2k&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string2num</span><span class="p">(</span><span class="s1">&#39;2M&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">string2num</span><span class="p">(</span><span class="s1">&#39;2B&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
2000.0
2000000.0
2000000000.0
</pre></div>
</div>
</div>
</div>
<p>Just like we did for the case of income, let’s apply our updated <code class="docutils literal notranslate"><span class="pre">string2num()</span></code> function to our population dataset. Since we’re modifying our data, let’s be sure to make a copy of it first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">pop_2017</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pop</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop_2017</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">string2num</span><span class="p">)</span>
<span class="n">pop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>37200000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>30800000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>2880000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>77000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>9630000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Samoa</td>
      <td>196000.0</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Yemen</td>
      <td>28500000.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>South Africa</td>
      <td>57800000.0</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Zambia</td>
      <td>17400000.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Zimbabwe</td>
      <td>14400000.0</td>
    </tr>
  </tbody>
</table>
<p>197 rows × 2 columns</p>
</div></div></div>
</div>
<p>This looks good, let’s double check our data types again to make sure everything was converted over to floats and make sure there were no <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values introduced during processing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country     object
2017       float64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Lastly, let’s rename the column header from ‘2017’ to ‘population’ so that its column label is clear and descriptive for when we merge these data frames later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;2017&quot;</span><span class="p">:</span> <span class="s2">&quot;population&quot;</span><span class="p">})</span>
<span class="n">pop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>37200000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>30800000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>2880000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>77000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>9630000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Samoa</td>
      <td>196000.0</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Yemen</td>
      <td>28500000.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>South Africa</td>
      <td>57800000.0</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Zambia</td>
      <td>17400000.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Zimbabwe</td>
      <td>14400000.0</td>
    </tr>
  </tbody>
</table>
<p>197 rows × 2 columns</p>
</div></div></div>
</div>
<p>With that done, we now have prepared our data for <code class="docutils literal notranslate"><span class="pre">co2</span></code>, <code class="docutils literal notranslate"><span class="pre">income</span></code>, and <code class="docutils literal notranslate"><span class="pre">pop</span></code>. All we need now is a way to identify the corresponding continent / region of the world for for each country, and for that, we can look at our UN data.</p>
</section>
<section id="dataset-4-of-4-continents-global-regions">
<h3>Dataset 4 of 4: Continents / global regions<a class="headerlink" href="#dataset-4-of-4-continents-global-regions" title="Permalink to this headline">#</a></h3>
<p>Once again, let’s start by loading in and inspecting the next and final dataset we’ll be incorporating: the UN data on continents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">undata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/united_nations_continents.csv&#39;</span><span class="p">)</span>
<span class="n">undata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ParserError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">m6</span><span class="o">/</span><span class="mi">8</span><span class="n">k94r84d6qq_67mq2lnhvrzh0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_25074</span><span class="o">/</span><span class="mf">3862084882.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">undata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/united_nations_continents.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">undata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/util/_decorators.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>                     <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>                 <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">311</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span> 
<span class="g g-Whitespace">    </span><span class="mi">313</span>         <span class="k">return</span> <span class="n">wrapper</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span> 
<span class="ne">--&gt; </span><span class="mi">586</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> 
<span class="g g-Whitespace">    </span><span class="mi">588</span> 

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">486</span> 
<span class="g g-Whitespace">    </span><span class="mi">487</span>     <span class="k">with</span> <span class="n">parser</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">488</span>         <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span> 
<span class="g g-Whitespace">    </span><span class="mi">490</span> 

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">read</span><span class="nt">(self, nrows)</span>
<span class="g g-Whitespace">   </span><span class="mi">1045</span>     <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1046</span>         <span class="n">nrows</span> <span class="o">=</span> <span class="n">validate_integer</span><span class="p">(</span><span class="s2">&quot;nrows&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1047</span>         <span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">col_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1048</span> 
<span class="g g-Whitespace">   </span><span class="mi">1049</span>         <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/io/parsers/c_parser_wrapper.py</span> in <span class="ni">read</span><span class="nt">(self, nrows)</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">low_memory</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">223</span>                 <span class="n">chunks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span><span class="o">.</span><span class="n">read_low_memory</span><span class="p">(</span><span class="n">nrows</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">224</span>                 <span class="c1"># destructive to chunks</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>                 <span class="n">data</span> <span class="o">=</span> <span class="n">_concatenate_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/_libs/parsers.pyx</span> in <span class="ni">pandas._libs.parsers.TextReader.read_low_memory</span><span class="nt">()</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/_libs/parsers.pyx</span> in <span class="ni">pandas._libs.parsers.TextReader._read_rows</span><span class="nt">()</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/_libs/parsers.pyx</span> in <span class="ni">pandas._libs.parsers.TextReader._tokenize_rows</span><span class="nt">()</span>

<span class="nn">~/opt/anaconda3/envs/ds/lib/python3.9/site-packages/pandas/_libs/parsers.pyx</span> in <span class="ni">pandas._libs.parsers.raise_parser_error</span><span class="nt">()</span>

<span class="ne">ParserError</span>: Error tokenizing data. C error: Expected 1 fields in line 67, saw 2
</pre></div>
</div>
</div>
</div>
<p>Well that was unexpected! Whenever we see an error like this, it’s good to look directly at our data to see if we missed something about the data that prevented it from loading. Let’s take a look into the first few lines of the ‘united_nations_continents.csv’ file and see if anything odd is going on there:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Global Code;Global Name;Region Code;Region Name;Sub-region Code;Sub-region Name;Intermediate Region Code;Intermediate Region Name;Country or Area;M49 Code;ISO-alpha2 Code;ISO-alpha3 Code;Least Developed Countries (LDC);Land Locked Developing Countries (LLDC);Small Island Developing States (SIDS)
001;World;002;Africa;015;Northern Africa;;;Algeria;012;DZ;DZA;;;
001;World;002;Africa;015;Northern Africa;;;Egypt;818;EG;EGY;;;
001;World;002;Africa;015;Northern Africa;;;Libya;434;LY;LBY;;;
001;World;002;Africa;015;Northern Africa;;;Morocco;504;MA;MAR;;;
001;World;002;Africa;015;Northern Africa;;;Sudan;729;SD;SDN;x;;
</pre></div>
</div>
<p>There is definitely something odd going on here! A CSV file stands for “comma separated values” however, this file is not comma separated, it’s semicolon separated! To address this, we will need to adjust our data loading code to accommodate. We can do this with the <code class="docutils literal notranslate"><span class="pre">sep</span></code> keyword for the <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> method to let it know the separator is a semicolon and otherwise proceed as it would with the comma.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">undata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/united_nations_continents.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">undata</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Global Code</th>
      <th>Global Name</th>
      <th>Region Code</th>
      <th>Region Name</th>
      <th>Sub-region Code</th>
      <th>Sub-region Name</th>
      <th>Intermediate Region Code</th>
      <th>Intermediate Region Name</th>
      <th>Country or Area</th>
      <th>M49 Code</th>
      <th>ISO-alpha2 Code</th>
      <th>ISO-alpha3 Code</th>
      <th>Least Developed Countries (LDC)</th>
      <th>Land Locked Developing Countries (LLDC)</th>
      <th>Small Island Developing States (SIDS)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Algeria</td>
      <td>12</td>
      <td>DZ</td>
      <td>DZA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Egypt</td>
      <td>818</td>
      <td>EG</td>
      <td>EGY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Libya</td>
      <td>434</td>
      <td>LY</td>
      <td>LBY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Morocco</td>
      <td>504</td>
      <td>MA</td>
      <td>MAR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sudan</td>
      <td>729</td>
      <td>SD</td>
      <td>SDN</td>
      <td>x</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Tunisia</td>
      <td>788</td>
      <td>TN</td>
      <td>TUN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>15.0</td>
      <td>Northern Africa</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Western Sahara</td>
      <td>732</td>
      <td>EH</td>
      <td>ESH</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>202.0</td>
      <td>Sub-Saharan Africa</td>
      <td>14.0</td>
      <td>Eastern Africa</td>
      <td>British Indian Ocean Territory</td>
      <td>86</td>
      <td>IO</td>
      <td>IOT</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>202.0</td>
      <td>Sub-Saharan Africa</td>
      <td>14.0</td>
      <td>Eastern Africa</td>
      <td>Burundi</td>
      <td>108</td>
      <td>BI</td>
      <td>BDI</td>
      <td>x</td>
      <td>x</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>World</td>
      <td>2.0</td>
      <td>Africa</td>
      <td>202.0</td>
      <td>Sub-Saharan Africa</td>
      <td>14.0</td>
      <td>Eastern Africa</td>
      <td>Comoros</td>
      <td>174</td>
      <td>KM</td>
      <td>COM</td>
      <td>x</td>
      <td>NaN</td>
      <td>x</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>While there’s a lot of information here, what we need are two columns: ‘Region Name’ and ‘Country or Area’. Let’s extract just those from the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">continent</span> <span class="o">=</span> <span class="n">undata</span><span class="p">[[</span><span class="s1">&#39;Region Name&#39;</span><span class="p">,</span><span class="s1">&#39;Country or Area&#39;</span><span class="p">]]</span>
<span class="n">continent</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region Name</th>
      <th>Country or Area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>Algeria</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Africa</td>
      <td>Egypt</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Africa</td>
      <td>Libya</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Africa</td>
      <td>Morocco</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Africa</td>
      <td>Sudan</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Africa</td>
      <td>Tunisia</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Africa</td>
      <td>Western Sahara</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Africa</td>
      <td>British Indian Ocean Territory</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Africa</td>
      <td>Burundi</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Africa</td>
      <td>Comoros</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For ease of reference, let’s rename the columns ‘Region Name’ and ‘Country or Area’ to ‘continent’ and ‘country’ respectively:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">continent</span> <span class="o">=</span> <span class="n">continent</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Region Name&quot;</span><span class="p">:</span> <span class="s2">&quot;continent&quot;</span><span class="p">,</span> <span class="s2">&quot;Country or Area&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">})</span>
<span class="n">continent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>continent</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>Algeria</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Africa</td>
      <td>Egypt</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Africa</td>
      <td>Libya</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Africa</td>
      <td>Morocco</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Africa</td>
      <td>Sudan</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>244</th>
      <td>Oceania</td>
      <td>Samoa</td>
    </tr>
    <tr>
      <th>245</th>
      <td>Oceania</td>
      <td>Tokelau</td>
    </tr>
    <tr>
      <th>246</th>
      <td>Oceania</td>
      <td>Tonga</td>
    </tr>
    <tr>
      <th>247</th>
      <td>Oceania</td>
      <td>Tuvalu</td>
    </tr>
    <tr>
      <th>248</th>
      <td>Oceania</td>
      <td>Wallis and Futuna Islands</td>
    </tr>
  </tbody>
</table>
<p>249 rows × 2 columns</p>
</div></div></div>
</div>
<p>Let’s also sort <code class="docutils literal notranslate"><span class="pre">continent</span></code> by ‘country’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">continent</span> <span class="o">=</span> <span class="n">continent</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">])</span>
<span class="n">continent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>continent</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>141</th>
      <td>Asia</td>
      <td>Afghanistan</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Europe</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>Algeria</td>
    </tr>
    <tr>
      <th>239</th>
      <td>Oceania</td>
      <td>American Samoa</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Europe</td>
      <td>Andorra</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Africa</td>
      <td>Western Sahara</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Asia</td>
      <td>Yemen</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Africa</td>
      <td>Zambia</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Africa</td>
      <td>Zimbabwe</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Europe</td>
      <td>Åland Islands</td>
    </tr>
  </tbody>
</table>
<p>249 rows × 2 columns</p>
</div></div></div>
</div>
<p>Now we have each of the pieces of the puzzle that we need: <code class="docutils literal notranslate"><span class="pre">co2</span></code>, <code class="docutils literal notranslate"><span class="pre">income</span></code>, <code class="docutils literal notranslate"><span class="pre">pop</span></code> and <code class="docutils literal notranslate"><span class="pre">continents</span></code>. Getting the data ready for use requires significant effort, but it’s best if it can be done in a way that is easily reproducible. Imagine that we received an update to the data for 2023 and the first time through we had done all of the steps above manually in the original CSV files. We would then have to go through that process all over again. However, because we automated each process, we can easily rerun the above steps on new data, so our investment in time would pay off going forward.</p>
<p>Now that we have each of the four data sources separately, in the next lesson we will merge these into one dataset that we can then plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Not for inclusion - just to save contents from this notebook</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="n">pickle_path</span> <span class="o">=</span> <span class="s1">&#39;data/pickle/&#39;</span>

<span class="n">to_pickle</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span><span class="s1">&#39;income&#39;</span><span class="p">,</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">to_pickle</span><span class="p">:</span>
    <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1">.to_pickle(</span><span class="se">\&#39;</span><span class="si">{</span><span class="n">pickle_path</span><span class="si">}{</span><span class="n">item</span><span class="si">}</span><span class="s1">.pkl</span><span class="se">\&#39;</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/class_5/week_5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Kyle Bradbury & Nick Eubank<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>