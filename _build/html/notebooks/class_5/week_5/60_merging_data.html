

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Project: Data merging &#8212; Practical Data Science with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/class_5/week_5/60_merging_data';</script>
    <link rel="shortcut icon" href="../../../_static/mids_logo.svg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Practical Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting Up Your Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_python.html">Setting Up Python and conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_vscode.html">Setting Up VS Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_augmented_commandline.html">Augmenting Your Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/jupyter_in_vscode.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/jupyter_r_notebooks.html">VS Code, R, and Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Command Line</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/commandline_part1.html">Command Line Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/commandline_part2.html">Advanced Command Line</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numpy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_2/10_why_numpy.html">Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/20_intro_to_vectors.html">Working with Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/21_math_with_vectors.html">Doing Math With Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/23_type_promotion_in_vectors.html">Type Promotion in numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/10_speed_and_ease_of_use.html">The Python Ease of Use / Speed Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/11_vectorization.html">Vectorization in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/24_vector_recap.html">Vector Recap</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_2/30_subsetting_vectors.html">Subsetting Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/35_modifying_subsets_of_vectors.html">Modifying Subsets of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/37_vector_subsets_recap.html">Recap</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_3/10_views_and_copies.html">Views and Copies</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/11_when_do_I_get_a_view.html">When Do I Get a View and When Do I Get a Copy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/13_objects_and_variables.html">Variables are pointers to objects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/12_views_and_copies_recap.html">Review of Views and Copies</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_3/00_welcome_to_week_3.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/20_matrices.html">Intro to Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/22_reshaping_matrices.html">Folding and Reshaping Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/25_images_as_matrices.html">Matrices as Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/30_subsetting_matrices.html">Subsetting Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/32_modifying_subsets.html">Editing Subsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/33_matrix_recaps.html">Review of Matrices</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_3/40_nd_arrays.html">Arrays</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/41_broadcasting.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/42_nd_array_review.html">Review of ND-Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/03_summarizing_arrays.html">Summarizing Arrays</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/04_summarizing_arrays_example.html">Practical Example: comparing weather by counting like-values</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/04.1_color_images_as_arrays.html">Color Images as Arrays</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../class_2/week_4/20_random_numbers.html">Random numbers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_3/week_2/00_intro_to_pandas.html">Welcome to Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_2/10_pandas_series.html">Pandas Series</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_2/15_manipulating_series.html">Subsetting and Indexing Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_2/16_indexing_with_brackets.html">(OPTIONAL) Subsetting and Indexing with Single Square Brackets (<code class="docutils literal notranslate"><span class="pre">[]</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_2/30_pandas_dataframes.html">Working with tabular data through Dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_2/35_pandas_dataframe_gotchas.html">Subsetting DataFrame Tricks and Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_2/50_pandas_pyarrow.html">PyArrow: An Alternative to Numpy as Pandas Backend</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_3/week_3/10_views_and_copies_numpy_review.html">Views and Copies in Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/15_views_and_copies_in_pandas.html">Views and Copies in pandas</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/17_views_and_copies_in_pandas_wo_CoW.html">The View/Copy Headache in pandas without Copy on Write</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_3/week_3/00_plaintext_files.html">Binary Data</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/05_binary_files.html">Ways To Store and Read Data: Binary Files</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_3/week_3/20_cleaning_identifying.html">Data Cleaning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/30_cleaning_editing_globally.html">Fixing Data Value Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/32_cleaning_editing_specific_locations.html">Editing Specific Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/33_cleaning_datatypes.html">Cleaning Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_3/35_cleaning_missing_data.html">Missing Data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_3/week_4/00_intro_to_querying_data.html">Data Manipulations</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_4/10_combining_concatenating.html">Concatenating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_4/15_combining_merging.html">Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_4/20_grouping.html">Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_3/week_4/30_queries.html">Querying</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_2/10_plotting_in_python.html">Plotting in Python</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_2/20_plotting_with_seaborn.html">seaborn and the Grammar of Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/30_matplotlib.html">Matplotlib</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical Skills and Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/10_debugging_principles.html">Debugging</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/20_debugging_in_vscode.html">Debugging Python in VS Code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming.html">Defensive Programming</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/iceberg_principle.html">The Iceberg Principle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/workflow.html">Workflow Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/getting_help.html">Getting Help Online</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/vars_v_objects.html">Python: Variables vs. Objects</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/python_v_r.html">Python vs. R: Important Differences To Be Aware Of</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/backwards_design.html">Backwards Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/ints_and_floats.html">Numbers in Computers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/writing_good_jupyter_notebooks.html">Writing Good Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/pr_review.html">Reviewing Code on Github</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Professional Advice</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/buying_datascience_computer.html">How To Buy A Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/llms.html">chatGPT and You</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/PhD_Advice.html">So You’re Thinking About a PhD</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../class_2/week_1/00_interactive_console.html">Running Python in the VS Code Interactive Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_2/week_4/30_managing_python_packages.html">Understanding and Managing Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/fstrings.html">Combining numbers and text into strings: f-strings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/class_5/week_5/60_merging_data.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/class_5/week_5/60_merging_data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project: Data merging</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-data-from-being-divided-into-continents-to-4-global-regions">Changing the data from being divided into continents to 4 global regions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Not for inclusion - just to load contents from previous notebook</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pickle_path</span> <span class="o">=</span> <span class="s1">&#39;data/pickle/&#39;</span>

<span class="n">to_pickle</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">,</span><span class="s1">&#39;income&#39;</span><span class="p">,</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">to_pickle</span><span class="p">:</span>
    <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s1">=pd.read_pickle(</span><span class="se">\&quot;</span><span class="si">{</span><span class="n">pickle_path</span><span class="si">}{</span><span class="n">item</span><span class="si">}</span><span class="s1">.pkl</span><span class="se">\&quot;</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="project-data-merging">
<h1>Project: Data merging<a class="headerlink" href="#project-data-merging" title="Permalink to this headline">#</a></h1>
<p>Recall our goal is to produce a plot that explores the relationship between carbon dioxide emissions, income, and population for each country/territory. In this step of the project, we’ll merge our four data sources together on:</p>
<ol class="arabic simple">
<li><p>Carbon dioxide emissions by country</p></li>
<li><p>Income (as measured by GDP per capita) by country</p></li>
<li><p>Population by country (so we can convert CO2 emissions into per capita emissions)</p></li>
<li><p>List of territories by continent (since we want to be able to group the countries by region of the world)</p></li>
</ol>
<p>In the last lesson, we loaded the data we needed for reach of those as: <code class="docutils literal notranslate"><span class="pre">co2</span></code>, <code class="docutils literal notranslate"><span class="pre">income</span></code>, <code class="docutils literal notranslate"><span class="pre">pop</span></code> and <code class="docutils literal notranslate"><span class="pre">continents</span></code> and created a series of steps that we could reuse if we need to process a different year of data. Now, we need to merge these into one <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> so that we can plot it. To refresh our memories, let’s take a look at our four datasets that we need to merge together and think about how we will merge them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.254</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.120</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>1.590</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>6.120</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>21.400</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Samoa</td>
      <td>1.320</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Yemen</td>
      <td>0.356</td>
    </tr>
    <tr>
      <th>191</th>
      <td>South Africa</td>
      <td>8.100</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zambia</td>
      <td>0.302</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Zimbabwe</td>
      <td>0.850</td>
    </tr>
  </tbody>
</table>
<p>194 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">income</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2030.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>6930.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>13300.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>58300.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>67000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Samoa</td>
      <td>6390.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Yemen</td>
      <td>2660.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>South Africa</td>
      <td>13900.0</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Zambia</td>
      <td>3520.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>Zimbabwe</td>
      <td>3920.0</td>
    </tr>
  </tbody>
</table>
<p>195 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>37200000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>30800000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>2880000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>77000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>9630000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Samoa</td>
      <td>196000.0</td>
    </tr>
    <tr>
      <th>193</th>
      <td>Yemen</td>
      <td>28500000.0</td>
    </tr>
    <tr>
      <th>194</th>
      <td>South Africa</td>
      <td>57800000.0</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Zambia</td>
      <td>17400000.0</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Zimbabwe</td>
      <td>14400000.0</td>
    </tr>
  </tbody>
</table>
<p>197 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">continent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>continent</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>141</th>
      <td>Asia</td>
      <td>Afghanistan</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Europe</td>
      <td>Albania</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Africa</td>
      <td>Algeria</td>
    </tr>
    <tr>
      <th>239</th>
      <td>Oceania</td>
      <td>American Samoa</td>
    </tr>
    <tr>
      <th>196</th>
      <td>Europe</td>
      <td>Andorra</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Africa</td>
      <td>Western Sahara</td>
    </tr>
    <tr>
      <th>167</th>
      <td>Asia</td>
      <td>Yemen</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Africa</td>
      <td>Zambia</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Africa</td>
      <td>Zimbabwe</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Europe</td>
      <td>Åland Islands</td>
    </tr>
  </tbody>
</table>
<p>249 rows × 2 columns</p>
</div></div></div>
</div>
<p>The first observation when looking across these four datasets is that they each have a different number of rows! 194, 195, 197, and 249, respectively. This means they don’t all contain the same countries. But we need to combine them to plot them.</p>
<p>Think about what type of merge would be appropriate here? Left, right, inner, or outer? We only want to save the rows that are matching, so an inner merge seems like the right approach. Let’s start by merging co2 and income based on the ‘country’ column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">co2</span><span class="p">,</span><span class="n">income</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.254</td>
      <td>2030.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.120</td>
      <td>6930.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>1.590</td>
      <td>13300.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>6.120</td>
      <td>58300.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>21.400</td>
      <td>67000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>188</th>
      <td>Samoa</td>
      <td>1.320</td>
      <td>6390.0</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Yemen</td>
      <td>0.356</td>
      <td>2660.0</td>
    </tr>
    <tr>
      <th>190</th>
      <td>South Africa</td>
      <td>8.100</td>
      <td>13900.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Zambia</td>
      <td>0.302</td>
      <td>3520.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zimbabwe</td>
      <td>0.850</td>
      <td>3920.0</td>
    </tr>
  </tbody>
</table>
<p>193 rows × 3 columns</p>
</div></div></div>
</div>
<p>Excellent - we have 193 rows, which is as expected given the smallest size among the two dataframes being merged. Next lets add in population:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">pop</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.254</td>
      <td>2030.0</td>
      <td>37200000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.120</td>
      <td>6930.0</td>
      <td>30800000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>1.590</td>
      <td>13300.0</td>
      <td>2880000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>6.120</td>
      <td>58300.0</td>
      <td>77000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>21.400</td>
      <td>67000.0</td>
      <td>9630000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>188</th>
      <td>Samoa</td>
      <td>1.320</td>
      <td>6390.0</td>
      <td>196000.0</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Yemen</td>
      <td>0.356</td>
      <td>2660.0</td>
      <td>28500000.0</td>
    </tr>
    <tr>
      <th>190</th>
      <td>South Africa</td>
      <td>8.100</td>
      <td>13900.0</td>
      <td>57800000.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Zambia</td>
      <td>0.302</td>
      <td>3520.0</td>
      <td>17400000.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zimbabwe</td>
      <td>0.850</td>
      <td>3920.0</td>
      <td>14400000.0</td>
    </tr>
  </tbody>
</table>
<p>193 rows × 4 columns</p>
</div></div></div>
</div>
<p>And again we have 193 merged columns - looks like we have everything except for the continent labels added in. Adding in the continent labels is a little bit trickier, however, because if we look at the lists of the country/territory names in our <code class="docutils literal notranslate"><span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">continent</span></code> frames, we can see that some of the names that are the same are simply written a bit differently. For example the following pairs represent the same territory:</p>
<ul class="simple">
<li><p>‘Brunei’, ‘Brunei Darussalam’</p></li>
<li><p>‘Bolivia’, ‘Bolivia (Plurinational State of)’</p></li>
<li><p>‘Venezuela’,’Venezuela (Bolivarian Republic of)’</p></li>
<li><p>‘St. Vincent and the Grenadines’, ‘Saint Vincent and the Grenadines’</p></li>
<li><p>‘Cote d’Ivoire’, ‘Côte d’Ivoire’</p></li>
</ul>
<p>This means that these will not be merged together using the <code class="docutils literal notranslate"><span class="pre">merge()</span></code> method because their values are not identical.</p>
<p>We will create a method for idnetifying matching pairs of all names that we can confidently match, and will manually label the continent for the remaining territories. Looking at the data, it looks like we have 4 general categories:</p>
<ol class="arabic simple">
<li><p><strong>Exact matches</strong>. Character-for-character equality. E.g., ‘Burundi’ &lt;-&gt; ‘Burundi’</p></li>
<li><p><strong>Subset matches</strong>. The “shorthand” name is a subset of the full name. E.g., ‘Bolivia’ &lt;-&gt; ‘Bolivia (Plurinational State of)’</p></li>
<li><p><strong>Near matches</strong>. The names are VERY similar, but a few characters may be different. E.g., ‘Cape Verde’ &lt;-&gt; ‘Cabo Verde’</p></li>
<li><p><strong>Unmatched examples</strong>. Cases that do not have corresponding pairs. E.g. ‘Holy See’</p></li>
</ol>
<p>Since the lists to be merged are of length 193 and 249, respectively, then a simple approach to merging them is to manually correct the names of countries/territories in the <code class="docutils literal notranslate"><span class="pre">continents</span></code> frame to match the rest. This approach is fine, however, this is not practical for larger lists which will commonly be encountered. Instead, we will find a way to minimize the need for manual intervention and identify the nearest match from one list to the other by considering the four possible cases above. As with many aspects of data science, we cannot always eliminate the need for some manual effort in preparing the data, but we will reduce it greatly.</p>
<p><strong>EXERCISE: Create a function that takes as input two arrays of strings and returns a list the most likely matches</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_matches</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">):</span>
    <span class="k">pass</span>
    <span class="c1"># Returns a list of tuples of matches:</span>
    <span class="c1">#   [ (match_string_1, match_string_2, similarity_score)]</span>
</pre></div>
</div>
</div>
</div>
<p>As a recommended approach, use the list of 4 categories above and test for each. What is important here is that order matters. If you perform a match, the matched strings should be removed from further consideration going forward so you don’t create duplicate matches. Additionally, match those quantities that the most likely matches first (e.g. exact matches before subset matches, before near matches). Since the lengths of the territory lists are 193 and 249, at most there will be 193 matches.</p>
<p>You’re encouraged to read about and use the <code class="docutils literal notranslate"><span class="pre">difflib</span></code> package and the <code class="docutils literal notranslate"><span class="pre">SequenceMatcher</span></code> object and <code class="docutils literal notranslate"><span class="pre">get_close_matches</span></code> function. <code class="docutils literal notranslate"><span class="pre">SequenceMatcher</span></code> provides a similarity score for comparing two strings and takes on values between 0 and 1 where 1 is an exact match and 0 is no match at all. The <code class="docutils literal notranslate"><span class="pre">get_close_matches</span></code> function provides a list of the closest matches to the input string based on the <code class="docutils literal notranslate"><span class="pre">SequenceMatcher</span></code> similarity score.</p>
<p>Therefore, pseudocode for this function should be:</p>
<ol class="arabic simple">
<li><p>Identify any exact matches and remove them from the list of strings to match</p></li>
<li><p>Identify subset matches and remove them from the list of strings to match</p></li>
<li><p>One at a time, create near matches based on the similarity score of each possible match</p></li>
<li><p>Repeat (3) until all 193 of the territories have been matched</p></li>
<li><p>Return the list of tuples with each match and its corresponding similarity score (set all exact matches and subset matches to a similarity score of 1)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># BREAK HERE AND DIRECT STUDENTS TO GRADED LAB</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">difflib</span> <span class="kn">import</span> <span class="n">SequenceMatcher</span><span class="p">,</span> <span class="n">get_close_matches</span>

<span class="k">def</span> <span class="nf">similar</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">SequenceMatcher</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">ratio</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">closest</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">get_close_matches</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">B</span><span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">long</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">continent</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">short</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">long_strings</span> <span class="o">=</span> <span class="n">long</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">short_strings</span> <span class="o">=</span> <span class="n">short</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># First pass, match those with exact subsets</span>
<span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">short</span><span class="p">:</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">long</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">:</span>
            <span class="n">candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="n">closest</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span><span class="n">candidates</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sim</span> <span class="o">=</span> <span class="n">similar</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span><span class="n">selected</span><span class="p">)</span>
        <span class="n">long_strings</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>
        <span class="n">short_strings</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
        <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ss</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Second pass, match what remains using proximity</span>
<span class="n">slength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">short_strings</span><span class="p">)</span>
<span class="k">while</span> <span class="n">slength</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">matching_options</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">similarity</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">short_strings</span><span class="p">:</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="n">closest</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span><span class="n">long_strings</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">similarity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">similar</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span><span class="n">selected</span><span class="p">))</span>
        <span class="n">matching_options</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ss</span><span class="p">,</span><span class="n">selected</span><span class="p">])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">max_index</span> <span class="o">=</span> <span class="n">similarity</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">similarity</span><span class="p">))</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">similarity</span><span class="p">)</span>
    <span class="n">long_strings</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">matching_options</span><span class="p">[</span><span class="n">max_index</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">short_strings</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">matching_options</span><span class="p">[</span><span class="n">max_index</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">matching_options</span><span class="p">[</span><span class="n">max_index</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">matching_options</span><span class="p">[</span><span class="n">max_index</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">sim</span><span class="p">])</span>
    <span class="n">slength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">short_strings</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SS = </span><span class="si">{</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">, LS = </span><span class="si">{</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, Sim = </span><span class="si">{</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SS = Afghanistan, LS = Afghanistan, Sim = 1
SS = Angola, LS = Angola, Sim = 1
SS = Albania, LS = Albania, Sim = 1
SS = Andorra, LS = Andorra, Sim = 1
SS = United Arab Emirates, LS = United Arab Emirates, Sim = 1
SS = Argentina, LS = Argentina, Sim = 1
SS = Armenia, LS = Armenia, Sim = 1
SS = Antigua and Barbuda, LS = Antigua and Barbuda, Sim = 1
SS = Australia, LS = Australia, Sim = 1
SS = Austria, LS = Austria, Sim = 1
SS = Azerbaijan, LS = Azerbaijan, Sim = 1
SS = Burundi, LS = Burundi, Sim = 1
SS = Belgium, LS = Belgium, Sim = 1
SS = Benin, LS = Benin, Sim = 1
SS = Burkina Faso, LS = Burkina Faso, Sim = 1
SS = Bangladesh, LS = Bangladesh, Sim = 1
SS = Bulgaria, LS = Bulgaria, Sim = 1
SS = Bahrain, LS = Bahrain, Sim = 1
SS = Bahamas, LS = Bahamas, Sim = 1
SS = Bosnia and Herzegovina, LS = Bosnia and Herzegovina, Sim = 1
SS = Belarus, LS = Belarus, Sim = 1
SS = Belize, LS = Belize, Sim = 1
SS = Bolivia, LS = Bolivia (Plurinational State of), Sim = 1
SS = Brazil, LS = Brazil, Sim = 1
SS = Barbados, LS = Barbados, Sim = 1
SS = Brunei, LS = Brunei Darussalam, Sim = 1
SS = Bhutan, LS = Bhutan, Sim = 1
SS = Botswana, LS = Botswana, Sim = 1
SS = Central African Republic, LS = Central African Republic, Sim = 1
SS = Canada, LS = Canada, Sim = 1
SS = Switzerland, LS = Switzerland, Sim = 1
SS = Chile, LS = Chile, Sim = 1
SS = China, LS = China, Sim = 1
SS = Cameroon, LS = Cameroon, Sim = 1
SS = Colombia, LS = Colombia, Sim = 1
SS = Comoros, LS = Comoros, Sim = 1
SS = Costa Rica, LS = Costa Rica, Sim = 1
SS = Cuba, LS = Cuba, Sim = 1
SS = Cyprus, LS = Cyprus, Sim = 1
SS = Germany, LS = Germany, Sim = 1
SS = Djibouti, LS = Djibouti, Sim = 1
SS = Dominica, LS = Dominica, Sim = 1
SS = Denmark, LS = Denmark, Sim = 1
SS = Dominican Republic, LS = Dominican Republic, Sim = 1
SS = Algeria, LS = Algeria, Sim = 1
SS = Ecuador, LS = Ecuador, Sim = 1
SS = Egypt, LS = Egypt, Sim = 1
SS = Eritrea, LS = Eritrea, Sim = 1
SS = Spain, LS = Spain, Sim = 1
SS = Estonia, LS = Estonia, Sim = 1
SS = Ethiopia, LS = Ethiopia, Sim = 1
SS = Finland, LS = Finland, Sim = 1
SS = Fiji, LS = Fiji, Sim = 1
SS = France, LS = France, Sim = 1
SS = Gabon, LS = Gabon, Sim = 1
SS = United Kingdom, LS = United Kingdom of Great Britain and Northern Ireland, Sim = 1
SS = Georgia, LS = Georgia, Sim = 1
SS = Ghana, LS = Ghana, Sim = 1
SS = Guinea, LS = Guinea, Sim = 1
SS = Gambia, LS = Gambia, Sim = 1
SS = Guinea-Bissau, LS = Guinea-Bissau, Sim = 1
SS = Equatorial Guinea, LS = Equatorial Guinea, Sim = 1
SS = Greece, LS = Greece, Sim = 1
SS = Grenada, LS = Grenada, Sim = 1
SS = Guatemala, LS = Guatemala, Sim = 1
SS = Guyana, LS = Guyana, Sim = 1
SS = Honduras, LS = Honduras, Sim = 1
SS = Croatia, LS = Croatia, Sim = 1
SS = Haiti, LS = Haiti, Sim = 1
SS = Hungary, LS = Hungary, Sim = 1
SS = Indonesia, LS = Indonesia, Sim = 1
SS = India, LS = India, Sim = 1
SS = Ireland, LS = Ireland, Sim = 1
SS = Iran, LS = Iran (Islamic Republic of), Sim = 1
SS = Iraq, LS = Iraq, Sim = 1
SS = Iceland, LS = Iceland, Sim = 1
SS = Israel, LS = Israel, Sim = 1
SS = Italy, LS = Italy, Sim = 1
SS = Jamaica, LS = Jamaica, Sim = 1
SS = Jordan, LS = Jordan, Sim = 1
SS = Japan, LS = Japan, Sim = 1
SS = Kazakhstan, LS = Kazakhstan, Sim = 1
SS = Kenya, LS = Kenya, Sim = 1
SS = Cambodia, LS = Cambodia, Sim = 1
SS = Kiribati, LS = Kiribati, Sim = 1
SS = Kuwait, LS = Kuwait, Sim = 1
SS = Lao, LS = Lao People&#39;s Democratic Republic, Sim = 1
SS = Lebanon, LS = Lebanon, Sim = 1
SS = Liberia, LS = Liberia, Sim = 1
SS = Libya, LS = Libya, Sim = 1
SS = Sri Lanka, LS = Sri Lanka, Sim = 1
SS = Lesotho, LS = Lesotho, Sim = 1
SS = Lithuania, LS = Lithuania, Sim = 1
SS = Luxembourg, LS = Luxembourg, Sim = 1
SS = Latvia, LS = Latvia, Sim = 1
SS = Morocco, LS = Morocco, Sim = 1
SS = Moldova, LS = Republic of Moldova, Sim = 1
SS = Madagascar, LS = Madagascar, Sim = 1
SS = Maldives, LS = Maldives, Sim = 1
SS = Mexico, LS = Mexico, Sim = 1
SS = Marshall Islands, LS = Marshall Islands, Sim = 1
SS = North Macedonia, LS = North Macedonia, Sim = 1
SS = Mali, LS = Mali, Sim = 1
SS = Malta, LS = Malta, Sim = 1
SS = Myanmar, LS = Myanmar, Sim = 1
SS = Montenegro, LS = Montenegro, Sim = 1
SS = Mongolia, LS = Mongolia, Sim = 1
SS = Mozambique, LS = Mozambique, Sim = 1
SS = Mauritania, LS = Mauritania, Sim = 1
SS = Mauritius, LS = Mauritius, Sim = 1
SS = Malawi, LS = Malawi, Sim = 1
SS = Malaysia, LS = Malaysia, Sim = 1
SS = Namibia, LS = Namibia, Sim = 1
SS = Niger, LS = Niger, Sim = 1
SS = Nigeria, LS = Nigeria, Sim = 1
SS = Nicaragua, LS = Nicaragua, Sim = 1
SS = Netherlands, LS = Netherlands, Sim = 1
SS = Norway, LS = Norway, Sim = 1
SS = Nepal, LS = Nepal, Sim = 1
SS = Nauru, LS = Nauru, Sim = 1
SS = New Zealand, LS = New Zealand, Sim = 1
SS = Oman, LS = Oman, Sim = 1
SS = Pakistan, LS = Pakistan, Sim = 1
SS = Panama, LS = Panama, Sim = 1
SS = Peru, LS = Peru, Sim = 1
SS = Philippines, LS = Philippines, Sim = 1
SS = Palau, LS = Palau, Sim = 1
SS = Papua New Guinea, LS = Papua New Guinea, Sim = 1
SS = Poland, LS = Poland, Sim = 1
SS = Portugal, LS = Portugal, Sim = 1
SS = Paraguay, LS = Paraguay, Sim = 1
SS = Palestine, LS = State of Palestine, Sim = 1
SS = Qatar, LS = Qatar, Sim = 1
SS = Romania, LS = Romania, Sim = 1
SS = Russia, LS = Russian Federation, Sim = 1
SS = Rwanda, LS = Rwanda, Sim = 1
SS = Saudi Arabia, LS = Saudi Arabia, Sim = 1
SS = Sudan, LS = Sudan, Sim = 1
SS = Senegal, LS = Senegal, Sim = 1
SS = Singapore, LS = Singapore, Sim = 1
SS = Solomon Islands, LS = Solomon Islands, Sim = 1
SS = Sierra Leone, LS = Sierra Leone, Sim = 1
SS = El Salvador, LS = El Salvador, Sim = 1
SS = Somalia, LS = Somalia, Sim = 1
SS = Serbia, LS = Serbia, Sim = 1
SS = South Sudan, LS = South Sudan, Sim = 1
SS = Sao Tome and Principe, LS = Sao Tome and Principe, Sim = 1
SS = Suriname, LS = Suriname, Sim = 1
SS = Slovenia, LS = Slovenia, Sim = 1
SS = Sweden, LS = Sweden, Sim = 1
SS = Eswatini, LS = Eswatini, Sim = 1
SS = Seychelles, LS = Seychelles, Sim = 1
SS = Syria, LS = Syrian Arab Republic, Sim = 1
SS = Chad, LS = Chad, Sim = 1
SS = Togo, LS = Togo, Sim = 1
SS = Thailand, LS = Thailand, Sim = 1
SS = Tajikistan, LS = Tajikistan, Sim = 1
SS = Turkmenistan, LS = Turkmenistan, Sim = 1
SS = Timor-Leste, LS = Timor-Leste, Sim = 1
SS = Tonga, LS = Tonga, Sim = 1
SS = Trinidad and Tobago, LS = Trinidad and Tobago, Sim = 1
SS = Tunisia, LS = Tunisia, Sim = 1
SS = Tuvalu, LS = Tuvalu, Sim = 1
SS = Tanzania, LS = United Republic of Tanzania, Sim = 1
SS = Uganda, LS = Uganda, Sim = 1
SS = Ukraine, LS = Ukraine, Sim = 1
SS = Uruguay, LS = Uruguay, Sim = 1
SS = United States, LS = United States of America, Sim = 1
SS = Uzbekistan, LS = Uzbekistan, Sim = 1
SS = Venezuela, LS = Venezuela (Bolivarian Republic of), Sim = 1
SS = Vanuatu, LS = Vanuatu, Sim = 1
SS = Samoa, LS = Samoa, Sim = 1
SS = Yemen, LS = Yemen, Sim = 1
SS = South Africa, LS = South Africa, Sim = 1
SS = Zambia, LS = Zambia, Sim = 1
SS = Zimbabwe, LS = Zimbabwe, Sim = 1
SS = St. Vincent and the Grenadines, LS = Saint Vincent and the Grenadines, Sim = 0.9354838709677419
SS = St. Kitts and Nevis, LS = Saint Kitts and Nevis, Sim = 0.9
SS = Cote d&#39;Ivoire, LS = Côte d’Ivoire, Sim = 0.8461538461538461
SS = Cape Verde, LS = Cabo Verde, Sim = 0.8
SS = St. Lucia, LS = Saint Lucia, Sim = 0.8
SS = Vietnam, LS = Viet Nam, Sim = 0.8
SS = Micronesia, Fed. Sts., LS = Micronesia (Federated States of), Sim = 0.6792452830188679
SS = Congo, Rep., LS = Congo, Sim = 0.625
SS = Turkey, LS = Türkiye, Sim = 0.6153846153846154
SS = Slovak Republic, LS = Slovakia, Sim = 0.6086956521739131
SS = Czech Republic, LS = Czechia, Sim = 0.5714285714285714
SS = Kyrgyz Republic, LS = Republic of Korea, Sim = 0.5
SS = South Korea, LS = French Southern Territories, Sim = 0.47368421052631576
SS = North Korea, LS = Northern Mariana Islands, Sim = 0.45714285714285713
SS = Taiwan, LS = Pitcairn, Sim = 0.42857142857142855
SS = Hong Kong, China, LS = China, Hong Kong Special Administrative Region, Sim = 0.41935483870967744
SS = Congo, Dem. Rep., LS = Holy See, Sim = 0.3333333333333333
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">match</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">continent</span> <span class="o">=</span> <span class="n">continent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">continent</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
      <th>population</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.254</td>
      <td>2030.0</td>
      <td>37200000.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.120</td>
      <td>6930.0</td>
      <td>30800000.0</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>1.590</td>
      <td>13300.0</td>
      <td>2880000.0</td>
      <td>Europe</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>6.120</td>
      <td>58300.0</td>
      <td>77000.0</td>
      <td>Europe</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>21.400</td>
      <td>67000.0</td>
      <td>9630000.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>188</th>
      <td>Samoa</td>
      <td>1.320</td>
      <td>6390.0</td>
      <td>196000.0</td>
      <td>Oceania</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Yemen</td>
      <td>0.356</td>
      <td>2660.0</td>
      <td>28500000.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>190</th>
      <td>South Africa</td>
      <td>8.100</td>
      <td>13900.0</td>
      <td>57800000.0</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Zambia</td>
      <td>0.302</td>
      <td>3520.0</td>
      <td>17400000.0</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zimbabwe</td>
      <td>0.850</td>
      <td>3920.0</td>
      <td>14400000.0</td>
      <td>Africa</td>
    </tr>
  </tbody>
</table>
<p>193 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
      <th>population</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35</th>
      <td>Congo, Dem. Rep.</td>
      <td>0.0243</td>
      <td>1090.0</td>
      <td>84100000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Hong Kong, China</td>
      <td>5.8600</td>
      <td>61100.0</td>
      <td>7370000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Kyrgyz Republic</td>
      <td>1.6000</td>
      <td>5130.0</td>
      <td>6300000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>94</th>
      <td>South Korea</td>
      <td>12.9000</td>
      <td>42000.0</td>
      <td>51200000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>140</th>
      <td>North Korea</td>
      <td>1.1800</td>
      <td>1860.0</td>
      <td>25500000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Taiwan</td>
      <td>11.6000</td>
      <td>51900.0</td>
      <td>23700000.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">continent</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Asia&#39;, &#39;Europe&#39;, &#39;Africa&#39;, &#39;Oceania&#39;, &#39;Americas&#39;, nan],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Africa&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Asia&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Asia&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">94</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Asia&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Asia&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">177</span><span class="p">,</span> <span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Asia&#39;</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
      <th>population</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0.254</td>
      <td>2030.0</td>
      <td>37200000.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Angola</td>
      <td>1.120</td>
      <td>6930.0</td>
      <td>30800000.0</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Albania</td>
      <td>1.590</td>
      <td>13300.0</td>
      <td>2880000.0</td>
      <td>Europe</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>6.120</td>
      <td>58300.0</td>
      <td>77000.0</td>
      <td>Europe</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Arab Emirates</td>
      <td>21.400</td>
      <td>67000.0</td>
      <td>9630000.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>188</th>
      <td>Samoa</td>
      <td>1.320</td>
      <td>6390.0</td>
      <td>196000.0</td>
      <td>Oceania</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Yemen</td>
      <td>0.356</td>
      <td>2660.0</td>
      <td>28500000.0</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>190</th>
      <td>South Africa</td>
      <td>8.100</td>
      <td>13900.0</td>
      <td>57800000.0</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Zambia</td>
      <td>0.302</td>
      <td>3520.0</td>
      <td>17400000.0</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zimbabwe</td>
      <td>0.850</td>
      <td>3920.0</td>
      <td>14400000.0</td>
      <td>Africa</td>
    </tr>
  </tbody>
</table>
<p>193 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country       False
co2           False
income        False
population    False
continent     False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
      <th>population</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>co2</th>
      <th>income</th>
      <th>population</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Wonderful! We have our dataset successfully merged.</p>
<section id="changing-the-data-from-being-divided-into-continents-to-4-global-regions">
<h2>Changing the data from being divided into continents to 4 global regions<a class="headerlink" href="#changing-the-data-from-being-divided-into-continents-to-4-global-regions" title="Permalink to this headline">#</a></h2>
<p>We just have one final data processing step before we create our plot. If you look at the chart on GapMinder’s website, instead of using 7 continent categories, they use four categories for the world grouping Asia and Oceania into Asia. Let’s do the same here by replacing any instances of “Oceania” with “Asia”. Here we can use the <code class="docutils literal notranslate"><span class="pre">replace()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Asia&#39;, &#39;Africa&#39;, &#39;Europe&#39;, &#39;Americas&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Oceania&quot;</span><span class="p">,</span><span class="s2">&quot;Asia&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Phew! We have done a LOT of data processing to get ready to make our plot, which we’ll do in the next lesson. Our data are the fuel for all the analyses we do in data science and often its takes some effort to prepare them for use. Having a clean dataset like we do now is entirely worth it as we can now explore these data by plotting them!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Not for inclusion - just to save contents from this notebook</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="n">pickle_path</span> <span class="o">=</span> <span class="s1">&#39;data/pickle/&#39;</span>

<span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pickle_path</span><span class="si">}</span><span class="s1">data.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/class_5/week_5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-data-from-being-divided-into-continents-to-4-global-regions">Changing the data from being divided into continents to 4 global regions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Bradbury & Nick Eubank
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>