
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Big Data Exercises &#8212; Practical Data Science with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ids720_specific/exercises/Solutions_bigdata';</script>
    <link rel="icon" href="../../_static/mids_logo.svg"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Practical Data Science with Python - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Practical Data Science with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Practical Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting Up Your Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_python.html">Setting Up Python and conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_vscode.html">Setting Up VS Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/setup_augmented_commandline.html">Augmenting Your Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/jupyter_in_vscode.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/00_setup_env/jupyter_r_notebooks.html">VS Code, R, and Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Command Line</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/commandline_part1.html">Command Line Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/10_commandline/commandline_part2.html">Advanced Command Line</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numpy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_2/10_why_numpy.html">Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/20_intro_to_vectors.html">Working with Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/21_math_with_vectors.html">Doing Math With Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/23_type_promotion_in_vectors.html">Type Promotion in numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/10_speed_and_ease_of_use.html">The Python Ease of Use / Speed Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/11_vectorization.html">Vectorization in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/24_vector_recap.html">Vector Recap</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_2/30_subsetting_vectors.html">Subsetting Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/35_modifying_subsets_of_vectors.html">Modifying Subsets of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_2/37_vector_subsets_recap.html">Recap</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/10_views_and_copies.html">Views and Copies</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/11_when_do_I_get_a_view.html">When Do I Get a View and When Do I Get a Copy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/13_objects_and_variables.html">Variables are pointers to objects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/12_views_and_copies_recap.html">Review of Views and Copies</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/00_welcome_to_week_3.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/20_matrices.html">Intro to Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/22_reshaping_matrices.html">Folding and Reshaping Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/25_images_as_matrices.html">Matrices as Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/30_subsetting_matrices.html">Subsetting Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/32_modifying_subsets.html">Editing Subsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/33_matrix_recaps.html">Review of Matrices</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_2/week_3/40_nd_arrays.html">Arrays</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/41_broadcasting.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_3/42_nd_array_review.html">Review of ND-Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/03_summarizing_arrays.html">Summarizing Arrays</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/04_summarizing_arrays_example.html">Practical Example: comparing weather by counting like-values</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_2/week_4/04.1_color_images_as_arrays.html">Color Images as Arrays</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_4/20_random_numbers.html">Random numbers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_2/00_intro_to_pandas.html">Welcome to Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/10_pandas_series.html">Pandas Series</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/15_manipulating_series.html">Subsetting and Indexing Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/16_indexing_with_brackets.html">(OPTIONAL) Subsetting and Indexing with Single Square Brackets (<code class="docutils literal notranslate"><span class="pre">[]</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/18_object_dtype.html">The <code class="docutils literal notranslate"><span class="pre">object</span></code> Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/30_pandas_dataframes.html">Working with tabular data through Dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/35_pandas_dataframe_gotchas.html">Subsetting DataFrame Tricks and Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/45_categorical_dtype.html">The Categorical Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_2/50_pandas_pyarrow.html">PyArrow: An Alternative to Numpy as Pandas Backend</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_3/week_3/07_indices.html">Indexes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/10_views_and_copies_numpy_review.html">Views and Copies in Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/15_views_and_copies_in_pandas.html">Views and Copies in pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/17_views_and_copies_in_pandas_wo_CoW.html">The View/Copy Headache in pandas without Copy on Write</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/03_plaintext_files.html">Reading Data</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/05_binary_files.html">Binary Data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_3/20_cleaning_identifying.html">Data Cleaning</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/30_cleaning_editing_globally.html">Fixing Data Value Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/32_cleaning_editing_specific_locations.html">Editing Specific Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/33_cleaning_datatypes.html">Cleaning Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_3/35_cleaning_missing_data.html">Missing Data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_3/week_4/00_intro_to_querying_data.html">Data Manipulations</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/10_combining_concatenating.html">Concatenating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/15_combining_merging.html">Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/20_grouping.html">Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_3/week_4/30_queries.html">Querying</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/class_5/week_2/10_plotting_in_python.html">Plotting in Python</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_2/20_plotting_with_seaborn.html">seaborn and the Grammar of Graphics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_5/45_plotting_with_matplotlib.html">Plotting with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/class_5/week_5/46_making_plots_pretty.html">Making pretty plots in Python: customizing plots in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Big Data &amp; Performance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/10_big_data_what_is_it.html">What is Big Data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/20_big_data_strategies.html">Big Data Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/30_parquet.html">Parquet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/object_vectors.html">Object dtypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/50_performance_solutions.html">Solving Performance Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/60_parallelism.html">Parallel Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/30_big_data/70_dask.html">Distributed Computing with dask</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical Skills and Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/10_debugging_principles.html">Debugging</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/20_debugging_in_vscode.html">Debugging Python in VS Code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming.html">Defensive Programming</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/iceberg_principle.html">The Iceberg Principle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/workflow.html">Workflow Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/getting_help.html">Getting Help Online</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/vars_v_objects.html">Python: Variables vs. Objects</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/python_v_r.html">Python vs. R: Important Differences To Be Aware Of</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/backwards_design.html">Backwards Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/ints_and_floats.html">Numbers in Computers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/writing_good_jupyter_notebooks.html">Writing Good Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/pr_review.html">Reviewing Code on Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/20_programming_concepts/conda_environments.html">conda Environments</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Professional Advice</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/buying_datascience_computer.html">How To Buy A Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/llms.html">chatGPT and You</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/PDS_not_yet_in_coursera/99_advice/PhD_Advice.html">So You’re Thinking About a PhD</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_1/00_interactive_console.html">Running Python in the VS Code Interactive Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/class_2/week_4/30_managing_python_packages.html">Understanding and Managing Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/other/fstrings.html">Combining numbers and text into strings: f-strings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book/issues/new?title=Issue%20on%20page%20%2Fids720_specific/exercises/Solutions_bigdata.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ids720_specific/exercises/Solutions_bigdata.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Big Data Exercises</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-more-practice">Want More Practice?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="big-data-exercises">
<h1>Big Data Exercises<a class="headerlink" href="#big-data-exercises" title="Link to this heading">#</a></h1>
<p>In these exercises we will work on data from a series of global weather monitoring stations used to measure climate trends to examine long-term trends in temperature for your home locality. This data comes from the Global Historical Climatology Network, and is the actual raw data provided by NOAA. The only changes I have made to this data are a few small formatting changes to help meet the learning goals of this exercise.</p>
<p>To do these excercises, first please download the data for this exercise <a class="reference external" href="https://www.dropbox.com/s/oq36w90hm9ltgvc/global_climate_data.zip?dl=0">from here</a>. Note this is a big file (this is a big-data exercise, after all), so be patient.</p>
<p><strong>(1)</strong> The data we’ll be working with can be found in the file <code class="docutils literal notranslate"><span class="pre">ghcnd_daily.tar.gz</span></code>. It includes daily weather data from thousands of weather stations around the work over many decades.</p>
<p>Begin by unzipping the file and checking it’s size – it should come out to be <em>about</em> 4gb, but will expand to about 12 gb in RAM, which means there’s just no way most students (who usually have, at most, 16gb of RAM) can import this dataset into pandas and manipulate it directly.</p>
<p>(Note: what we’re doing can be applied to much bigger datasets, but they sometimes takes hours to work with, so we’re working with data that’s just a <em>little</em> big so we can get exercises done in reasonable time).</p>
<p><strong>(2)</strong> Thankfully, we aren’t going to be working with <em>all</em> the data today. Instead, everyone should pick three weather stations to examine during this analysis.</p>
<p>To pick your stations, we’ll need to open the <code class="docutils literal notranslate"><span class="pre">ghcnd-stations.txt</span></code> file in the directory you’ve downloaded. It includes both station codes (which is what we’ll find in the <code class="docutils literal notranslate"><span class="pre">ghcnd_daily.csv</span></code> data, as well as the name and location of each station).</p>
<p>When picking a weather station, make sure to pick one flagged as being in either GSN, HCN, or CRN (these designate more formalized stations that have been around a long time, ensuring you’ll get a station with data that has been recorded over a longer period).</p>
<p>Note that Station IDs start with the two-letter code of the country in which they are located, and the “NAME” column often constains city names.</p>
<p><strong>The <code class="docutils literal notranslate"><span class="pre">ghcnd-stations.txt</span></code> is a “fixed-width” dataset,</strong> meaning that instead of putting commas or tabs between observations, all columns have the same width (in terms of number of characters). So to import this data you’ll have to (a) read the notes about the data in the project README.txt, and (b) read about how to read in fixed-width data in pandas. When entering column specifications, remember that normal people count from 1 and include end points, while Python counts from 0 and doesn’t include end points (so if the readme says data is in columns 10-20, in Python that’d be 9 through 20).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;/users/nick/downloads/global_climate_data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">72</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">76</span><span class="p">,</span> <span class="mi">79</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">85</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span>
    <span class="s2">&quot;ghcnd-stations.txt&quot;</span><span class="p">,</span>
    <span class="n">colspecs</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span>
    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LATITUDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LONGITUDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ELEVATION&quot;</span><span class="p">,</span>
        <span class="s2">&quot;STATE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
        <span class="s2">&quot;GSN FLAG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HCN/CRN FLAG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;WMO ID&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stations</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">stations</span><span class="p">[</span>
    <span class="n">stations</span><span class="p">[</span><span class="s2">&quot;HCN/CRN FLAG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;HCN&quot;</span><span class="p">,</span> <span class="s2">&quot;CRN&quot;</span><span class="p">])</span> <span class="o">|</span> <span class="n">stations</span><span class="p">[</span><span class="s2">&quot;GSN FLAG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;GSN&quot;</span><span class="p">])</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stations</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>NAME</th>
      <th>GSN FLAG</th>
      <th>HCN/CRN FLAG</th>
      <th>WMO ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>AE000041196</td>
      <td>25.3330</td>
      <td>55.5170</td>
      <td>34.0</td>
      <td>NaN</td>
      <td>SHARJAH INTER. AIRP</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>41196.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>AF000040930</td>
      <td>35.3170</td>
      <td>69.0170</td>
      <td>3366.0</td>
      <td>NaN</td>
      <td>NORTH-SALANG</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>40930.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AG000060390</td>
      <td>36.7167</td>
      <td>3.2500</td>
      <td>24.0</td>
      <td>NaN</td>
      <td>ALGER-DAR EL BEIDA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>60390.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>AG000060590</td>
      <td>30.5667</td>
      <td>2.8667</td>
      <td>397.0</td>
      <td>NaN</td>
      <td>EL-GOLEA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>60590.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>AG000060611</td>
      <td>28.0500</td>
      <td>9.6331</td>
      <td>561.0</td>
      <td>NaN</td>
      <td>IN-AMENAS</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>60611.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stations</span><span class="p">[</span><span class="n">stations</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;^IN&quot;</span><span class="p">)]</span>  <span class="c1"># Let&#39;s do one from  New Delhi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>NAME</th>
      <th>GSN FLAG</th>
      <th>HCN/CRN FLAG</th>
      <th>WMO ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35873</th>
      <td>IN001080500</td>
      <td>17.450</td>
      <td>78.470</td>
      <td>527.0</td>
      <td>NaN</td>
      <td>BEGUMPET        OBSY</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43128.0</td>
    </tr>
    <tr>
      <th>36198</th>
      <td>IN003041800</td>
      <td>26.100</td>
      <td>91.583</td>
      <td>54.0</td>
      <td>NaN</td>
      <td>GAUHATI</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42410.0</td>
    </tr>
    <tr>
      <th>36402</th>
      <td>IN004091000</td>
      <td>24.050</td>
      <td>84.067</td>
      <td>221.0</td>
      <td>NaN</td>
      <td>DALTONGANJ</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42587.0</td>
    </tr>
    <tr>
      <th>36607</th>
      <td>IN005030100</td>
      <td>24.200</td>
      <td>72.200</td>
      <td>136.0</td>
      <td>NaN</td>
      <td>DEESA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42539.0</td>
    </tr>
    <tr>
      <th>36670</th>
      <td>IN005090100</td>
      <td>22.367</td>
      <td>69.083</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>DWARKA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42731.0</td>
    </tr>
    <tr>
      <th>36917</th>
      <td>IN007101600</td>
      <td>31.100</td>
      <td>77.167</td>
      <td>2202.0</td>
      <td>NaN</td>
      <td>SHIMLA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42083.0</td>
    </tr>
    <tr>
      <th>36926</th>
      <td>IN008010200</td>
      <td>34.083</td>
      <td>74.833</td>
      <td>1587.0</td>
      <td>NaN</td>
      <td>SRINAGAR</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42027.0</td>
    </tr>
    <tr>
      <th>36980</th>
      <td>IN009010100</td>
      <td>12.967</td>
      <td>77.583</td>
      <td>921.0</td>
      <td>NaN</td>
      <td>BANGALORE</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43295.0</td>
    </tr>
    <tr>
      <th>37477</th>
      <td>IN011020300</td>
      <td>19.083</td>
      <td>82.033</td>
      <td>553.0</td>
      <td>NaN</td>
      <td>JAGDALPUR</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43041.0</td>
    </tr>
    <tr>
      <th>37513</th>
      <td>IN011060800</td>
      <td>22.767</td>
      <td>81.900</td>
      <td>625.0</td>
      <td>NaN</td>
      <td>PENDRA ROAD</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42779.0</td>
    </tr>
    <tr>
      <th>37733</th>
      <td>IN011330900</td>
      <td>23.850</td>
      <td>78.750</td>
      <td>551.0</td>
      <td>NaN</td>
      <td>SAGAR</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42671.0</td>
    </tr>
    <tr>
      <th>38003</th>
      <td>IN012190100</td>
      <td>18.533</td>
      <td>73.850</td>
      <td>559.0</td>
      <td>NaN</td>
      <td>POONA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43063.0</td>
    </tr>
    <tr>
      <th>38119</th>
      <td>IN014020800</td>
      <td>25.250</td>
      <td>91.733</td>
      <td>1313.0</td>
      <td>NaN</td>
      <td>CHERRAPUNJI</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42515.0</td>
    </tr>
    <tr>
      <th>38451</th>
      <td>IN019070100</td>
      <td>28.000</td>
      <td>73.300</td>
      <td>224.0</td>
      <td>NaN</td>
      <td>BIKANER</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42165.0</td>
    </tr>
    <tr>
      <th>38778</th>
      <td>IN020040900</td>
      <td>13.000</td>
      <td>80.183</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>MADRAS/MINAMBAKKAM</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43279.0</td>
    </tr>
    <tr>
      <th>38847</th>
      <td>IN020081000</td>
      <td>10.233</td>
      <td>77.467</td>
      <td>2343.0</td>
      <td>NaN</td>
      <td>KODAIKANAL</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43339.0</td>
    </tr>
    <tr>
      <th>38879</th>
      <td>IN020100400</td>
      <td>9.267</td>
      <td>79.300</td>
      <td>11.0</td>
      <td>NaN</td>
      <td>PAMBAN</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43363.0</td>
    </tr>
    <tr>
      <th>39039</th>
      <td>IN022021900</td>
      <td>28.583</td>
      <td>77.200</td>
      <td>216.0</td>
      <td>NaN</td>
      <td>NEW DELHI/SAFDARJUN</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42182.0</td>
    </tr>
    <tr>
      <th>39414</th>
      <td>IN024050100</td>
      <td>27.050</td>
      <td>88.267</td>
      <td>2128.0</td>
      <td>NaN</td>
      <td>DARJEELING</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>42295.0</td>
    </tr>
    <tr>
      <th>39503</th>
      <td>IN025010100</td>
      <td>8.300</td>
      <td>73.000</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>MINICOY         OBSY</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43369.0</td>
    </tr>
    <tr>
      <th>39512</th>
      <td>IN099999901</td>
      <td>11.667</td>
      <td>92.717</td>
      <td>79.0</td>
      <td>NaN</td>
      <td>PORT BLAIR</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>43333.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s do IN022021900. I used to live in Safdarjung Enclave in delhi!</span>
<span class="c1"># IN007101600</span>

<span class="c1"># and one from argentina</span>
<span class="n">stations</span><span class="p">[</span><span class="n">stations</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;^AR&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>NAME</th>
      <th>GSN FLAG</th>
      <th>HCN/CRN FLAG</th>
      <th>WMO ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>261</th>
      <td>AR000087007</td>
      <td>-22.100</td>
      <td>-65.600</td>
      <td>3479.0</td>
      <td>NaN</td>
      <td>LA QUIACA OBSERVATO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87007.0</td>
    </tr>
    <tr>
      <th>262</th>
      <td>AR000087065</td>
      <td>-24.167</td>
      <td>-62.900</td>
      <td>205.0</td>
      <td>NaN</td>
      <td>RIVADAVIA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87065.0</td>
    </tr>
    <tr>
      <th>263</th>
      <td>AR000087078</td>
      <td>-24.700</td>
      <td>-60.583</td>
      <td>130.0</td>
      <td>NaN</td>
      <td>LAS LOMITAS</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87078.0</td>
    </tr>
    <tr>
      <th>265</th>
      <td>AR000087155</td>
      <td>-27.450</td>
      <td>-59.050</td>
      <td>53.0</td>
      <td>NaN</td>
      <td>RESISTENCIA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87155.0</td>
    </tr>
    <tr>
      <th>266</th>
      <td>AR000087217</td>
      <td>-29.383</td>
      <td>-66.817</td>
      <td>438.0</td>
      <td>NaN</td>
      <td>LA RIOJA AERO.</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87217.0</td>
    </tr>
    <tr>
      <th>267</th>
      <td>AR000087257</td>
      <td>-29.883</td>
      <td>-61.950</td>
      <td>88.0</td>
      <td>NaN</td>
      <td>CERES AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87257.0</td>
    </tr>
    <tr>
      <th>268</th>
      <td>AR000087270</td>
      <td>-29.183</td>
      <td>-59.700</td>
      <td>53.0</td>
      <td>NaN</td>
      <td>RECONQUISTA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87270.0</td>
    </tr>
    <tr>
      <th>269</th>
      <td>AR000087344</td>
      <td>-31.317</td>
      <td>-64.217</td>
      <td>489.0</td>
      <td>NaN</td>
      <td>CORDOBA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87344.0</td>
    </tr>
    <tr>
      <th>270</th>
      <td>AR000087374</td>
      <td>-31.783</td>
      <td>-60.483</td>
      <td>74.0</td>
      <td>NaN</td>
      <td>PARANA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87374.0</td>
    </tr>
    <tr>
      <th>271</th>
      <td>AR000087418</td>
      <td>-32.833</td>
      <td>-68.783</td>
      <td>704.0</td>
      <td>NaN</td>
      <td>MENDOZA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87418.0</td>
    </tr>
    <tr>
      <th>272</th>
      <td>AR000087534</td>
      <td>-34.133</td>
      <td>-63.367</td>
      <td>137.0</td>
      <td>NaN</td>
      <td>LABOULAYE AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87534.0</td>
    </tr>
    <tr>
      <th>273</th>
      <td>AR000087623</td>
      <td>-36.567</td>
      <td>-64.266</td>
      <td>192.0</td>
      <td>NaN</td>
      <td>SANTA ROSA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87623.0</td>
    </tr>
    <tr>
      <th>274</th>
      <td>AR000087692</td>
      <td>-37.933</td>
      <td>-57.583</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>MAR DEL PLATA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87692.0</td>
    </tr>
    <tr>
      <th>275</th>
      <td>AR000087715</td>
      <td>-38.950</td>
      <td>-68.133</td>
      <td>273.0</td>
      <td>NaN</td>
      <td>NEUQUEN AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87715.0</td>
    </tr>
    <tr>
      <th>276</th>
      <td>AR000087803</td>
      <td>-42.933</td>
      <td>-71.150</td>
      <td>799.0</td>
      <td>NaN</td>
      <td>ESQUEL AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87803.0</td>
    </tr>
    <tr>
      <th>277</th>
      <td>AR000087828</td>
      <td>-43.200</td>
      <td>-65.266</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>TRELEW AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87828.0</td>
    </tr>
    <tr>
      <th>278</th>
      <td>AR000087860</td>
      <td>-45.783</td>
      <td>-67.500</td>
      <td>58.0</td>
      <td>NaN</td>
      <td>COMODORO RIVADAVIA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87860.0</td>
    </tr>
    <tr>
      <th>279</th>
      <td>AR000087925</td>
      <td>-51.617</td>
      <td>-69.283</td>
      <td>19.0</td>
      <td>NaN</td>
      <td>RIO GALLEGOS AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87925.0</td>
    </tr>
    <tr>
      <th>280</th>
      <td>AR000870470</td>
      <td>-24.850</td>
      <td>-65.483</td>
      <td>1246.0</td>
      <td>NaN</td>
      <td>SALTA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87047.0</td>
    </tr>
    <tr>
      <th>281</th>
      <td>AR000873050</td>
      <td>-30.250</td>
      <td>-68.750</td>
      <td>1175.0</td>
      <td>NaN</td>
      <td>JACHAL</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87305.0</td>
    </tr>
    <tr>
      <th>282</th>
      <td>AR000875440</td>
      <td>-35.867</td>
      <td>-61.900</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>PEHUAJO AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87544.0</td>
    </tr>
    <tr>
      <th>284</th>
      <td>AR000877500</td>
      <td>-38.733</td>
      <td>-62.167</td>
      <td>75.0</td>
      <td>NaN</td>
      <td>BAHIA BLANCA AERO</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87750.0</td>
    </tr>
    <tr>
      <th>292</th>
      <td>ARM00087178</td>
      <td>-27.386</td>
      <td>-55.971</td>
      <td>131.1</td>
      <td>NaN</td>
      <td>POSADAS</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87178.0</td>
    </tr>
    <tr>
      <th>296</th>
      <td>ARM00087289</td>
      <td>-29.689</td>
      <td>-57.152</td>
      <td>70.1</td>
      <td>NaN</td>
      <td>PASO DE LOS LIBRES</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87289.0</td>
    </tr>
    <tr>
      <th>311</th>
      <td>ARM00087497</td>
      <td>-33.010</td>
      <td>-58.613</td>
      <td>22.9</td>
      <td>NaN</td>
      <td>GUALEGUAYCHU</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87497.0</td>
    </tr>
    <tr>
      <th>312</th>
      <td>ARM00087506</td>
      <td>-35.494</td>
      <td>-69.574</td>
      <td>1430.1</td>
      <td>NaN</td>
      <td>MALARGUE</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87506.0</td>
    </tr>
    <tr>
      <th>320</th>
      <td>ARM00087593</td>
      <td>-34.972</td>
      <td>-57.895</td>
      <td>21.9</td>
      <td>NaN</td>
      <td>LA PLATA</td>
      <td>GSN</td>
      <td>NaN</td>
      <td>87593.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ARM00087593 (I also briefly lived in La Plata!)</span>
<span class="c1"># AR000087007</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stations</span><span class="p">[</span><span class="n">stations</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;USC00050848&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>NAME</th>
      <th>GSN FLAG</th>
      <th>HCN/CRN FLAG</th>
      <th>WMO ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>89825</th>
      <td>USC00050848</td>
      <td>39.9919</td>
      <td>-105.2667</td>
      <td>1671.5</td>
      <td>CO</td>
      <td>BOULDER</td>
      <td>NaN</td>
      <td>HCN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>(3)</strong> Now that we something about the observations we want to work with, we can now turn to our actual weather data.</p>
<p>Our daily weather can be found in <code class="docutils literal notranslate"><span class="pre">ghcnd_daily.csv</span></code>, which you get by unzipping <code class="docutils literal notranslate"><span class="pre">ghcnd_daily.tar.gz</span></code>. Note that the README.txt talks about this being a fixed-width file. Since you’ve already dealt with one fixed-width file, I’ve just converted this to a CSV, and dropped all the data that isn’t “daily max temperatures”.</p>
<p>Let’s start with the fun part. <strong>SAVE YOUR NOTEBOOK AND ANY OTHER OPEN FILES!</strong>. Then just try and import the data (<code class="docutils literal notranslate"><span class="pre">ghcnd_daily.csv</span></code>) while watching your Activity Monitor (Mac) or Resource Monitor (Windows) to see what happens.</p>
<p>If you have 8GB of RAM, this should fail miserably.</p>
<p>If you have 16GB of RAM, you might just get away with this. But if it <em>does</em> load, try sorting the data by year and see how things go.</p>
<p>(If you have 32GB of RAM: you’re actually probably fine with data this size. Sorry – datasets big enough to cause big problems for people with 32GB take a long time to chunk on an 8GB computer, and these exercises have to be fast enough to finish in a class period! There are some exercises at the bottom with a REALLY big dataset you can work with.)</p>
<p>You may have to kill your kernel, kill Jupyter Lab, and start over when this explodes…</p>
<p><strong>(4)</strong> Now that we know that we can’t work with this directly, it’s good with these big datasets to just import ~200 lines so you can get a feel for the data. So load <em>just 200 lines</em> of <code class="docutils literal notranslate"><span class="pre">ghcnd_daily.csv</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/users/nick/downloads/global_climate_data/ghcnd_daily.csv&quot;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>year</th>
      <th>month</th>
      <th>element</th>
      <th>value1</th>
      <th>mflag1</th>
      <th>qflag1</th>
      <th>sflag1</th>
      <th>value2</th>
      <th>mflag2</th>
      <th>...</th>
      <th>qflag29</th>
      <th>sflag29</th>
      <th>value30</th>
      <th>mflag30</th>
      <th>qflag30</th>
      <th>sflag30</th>
      <th>value31</th>
      <th>mflag31</th>
      <th>qflag31</th>
      <th>sflag31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ACW00011604</td>
      <td>1949</td>
      <td>1</td>
      <td>TMAX</td>
      <td>289</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>289</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>X</td>
      <td>272</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>272</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ACW00011604</td>
      <td>1949</td>
      <td>2</td>
      <td>TMAX</td>
      <td>267</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>278</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ACW00011604</td>
      <td>1949</td>
      <td>3</td>
      <td>TMAX</td>
      <td>272</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>289</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>X</td>
      <td>278</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>267</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ACW00011604</td>
      <td>1949</td>
      <td>4</td>
      <td>TMAX</td>
      <td>278</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>283</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>X</td>
      <td>289</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ACW00011604</td>
      <td>1949</td>
      <td>5</td>
      <td>TMAX</td>
      <td>283</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>283</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>X</td>
      <td>294</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
      <td>300</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>X</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 128 columns</p>
</div></div></div>
</div>
<p><strong>(5)</strong> Once you have a sense of the data, write code to chunk your data: i.e. code that reads in all blocks of the data that will fit in ram, keeps only the observations for the weather stations you’ve selected to focus on, and throws away everything else.</p>
<p>In addition to your own 4 weather stations, please also include station USC00050848 (a weather station from near my home!) so you can generate results that we can all compare (to check for accuracy).</p>
<p>Note you will probably have to play with your chunk sizes (probably while watching your RAM usage?) to find a chunk size that’s big enough you aren’t running chunks all day, but small enough you can work with it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_stations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;USC00050848&quot;</span><span class="p">,</span>
    <span class="s2">&quot;IN007101600&quot;</span><span class="p">,</span>
    <span class="s2">&quot;IN022021900&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ARM00087593&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AR000087007&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Setup chunking load</span>
<span class="n">df_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;/users/nick/dropbox/MIDS_Data_Prep/ClimateData/ghcnd_daily.csv&quot;</span><span class="p">,</span>
    <span class="n">iterator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="o">=</span><span class="mi">5_000_000</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># OK,small enough for me, but not ridiculously small.</span>
<span class="n">keeping</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_full</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;starting chunk </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">my_stations</span><span class="p">)]</span>
    <span class="n">keeping</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3364: DtypeWarning: Columns (6,10,14,18,22,26,30,34,38,42,46,50,54,58,62,66,70,74,78,82,86,90,94,98,102,106,110,114,118,122,126) have mixed types.Specify dtype option on import or set low_memory=False.
  if (await self.run_code(code, result,  async_=asy)):
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting chunk 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3364: DtypeWarning: Columns (6,7,10,11,14,15,18,19,22,23,26,27,30,31,34,35,38,39,42,43,46,47,50,51,54,55,58,59,62,63,66,67,70,71,74,75,78,79,82,83,86,87,90,91,94,95,98,99,102,103,106,107,110,111,114,115,118,119,122,123,126,127) have mixed types.Specify dtype option on import or set low_memory=False.
  if (await self.run_code(code, result,  async_=asy)):
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting chunk 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3364: DtypeWarning: Columns (5,6,7,9,10,11,13,14,15,17,18,19,21,22,23,25,26,27,29,30,31,33,34,35,37,38,39,41,42,43,45,46,47,49,50,51,53,54,55,57,58,59,61,62,63,65,66,67,69,70,71,73,74,75,77,78,79,81,82,83,85,86,87,89,90,91,93,94,95,97,98,99,101,102,103,105,106,107,109,110,111,113,114,115,117,118,119,121,122,123,125,126,127) have mixed types.Specify dtype option on import or set low_memory=False.
  if (await self.run_code(code, result,  async_=asy)):
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting chunk 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weather_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">keeping</span><span class="p">)</span>
<span class="k">del</span> <span class="n">keeping</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weather_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>year</th>
      <th>month</th>
      <th>element</th>
      <th>value1</th>
      <th>mflag1</th>
      <th>qflag1</th>
      <th>sflag1</th>
      <th>value2</th>
      <th>mflag2</th>
      <th>...</th>
      <th>qflag29</th>
      <th>sflag29</th>
      <th>value30</th>
      <th>mflag30</th>
      <th>qflag30</th>
      <th>sflag30</th>
      <th>value31</th>
      <th>mflag31</th>
      <th>qflag31</th>
      <th>sflag31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>58411</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>4</td>
      <td>TMAX</td>
      <td>230</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>242</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>171</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58412</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>5</td>
      <td>TMAX</td>
      <td>180</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>172</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>138</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>148</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
    </tr>
    <tr>
      <th>58413</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>6</td>
      <td>TMAX</td>
      <td>156</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>136</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>138</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58414</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>7</td>
      <td>TMAX</td>
      <td>132</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>136</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>128</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>128</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
    </tr>
    <tr>
      <th>58415</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>8</td>
      <td>TMAX</td>
      <td>138</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>138</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>158</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>164</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 128 columns</p>
</div></div></div>
</div>
<p><strong>(6)</strong> Now, for each weather station, figure out the <em>earliest</em> year with data. Keep <code class="docutils literal notranslate"><span class="pre">USC00050848</span></code> and the two of the three weather stations you picked with the best data (i.e., you should have 3 total, two you picked and <code class="docutils literal notranslate"><span class="pre">USC00050848</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">weather_data</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">min_year</span> <span class="o">=</span> <span class="n">weather_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">weather_data</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; for </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">, earliest year is </span><span class="si">{</span><span class="n">min_year</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> for AR000087007, earliest year is 1956
 for ARM00087593, earliest year is 1974
 for IN007101600, earliest year is 1973
 for IN022021900, earliest year is 1944
 for USC00050848, earliest year is 1893
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weather_data</span> <span class="o">=</span> <span class="n">weather_data</span><span class="p">[</span>
    <span class="n">weather_data</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;USC00050848&quot;</span><span class="p">,</span> <span class="s2">&quot;IN022021900&quot;</span><span class="p">,</span> <span class="s2">&quot;AR000087007&quot;</span><span class="p">])</span>
<span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">weather_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>year</th>
      <th>month</th>
      <th>element</th>
      <th>value1</th>
      <th>mflag1</th>
      <th>qflag1</th>
      <th>sflag1</th>
      <th>value2</th>
      <th>mflag2</th>
      <th>...</th>
      <th>qflag29</th>
      <th>sflag29</th>
      <th>value30</th>
      <th>mflag30</th>
      <th>qflag30</th>
      <th>sflag30</th>
      <th>value31</th>
      <th>mflag31</th>
      <th>qflag31</th>
      <th>sflag31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>58411</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>4</td>
      <td>TMAX</td>
      <td>230</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>242</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>171</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58412</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>5</td>
      <td>TMAX</td>
      <td>180</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>172</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>138</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>148</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
    </tr>
    <tr>
      <th>58413</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>6</td>
      <td>TMAX</td>
      <td>156</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>136</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>138</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>-9999</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58414</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>7</td>
      <td>TMAX</td>
      <td>132</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>136</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>128</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>128</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
    </tr>
    <tr>
      <th>58415</th>
      <td>AR000087007</td>
      <td>1956</td>
      <td>8</td>
      <td>TMAX</td>
      <td>138</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>138</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>G</td>
      <td>158</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
      <td>164</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>G</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 128 columns</p>
</div></div></div>
</div>
<p><strong>(7)</strong> Now calculate the average max temp for each weather station / month in the data. Note that in a few weeks, we’ll have the skills to do this by reshaping our data so each row is a single day, rather than a month. But for the moment, just sum the columns, watching out for weird values.</p>
<p>To sum across the value columns, we can combine:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">weather_data</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(to just get the columns whose names start with “value”) with <code class="docutils literal notranslate"><span class="pre">.mean(axis='columns')</span></code> (which averages across columns (along rows) rather than the usual averaging across rows (along columns).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;value1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-9999    150
 189      39
 300      39
 200      39
 128      38
        ... 
 412       1
 248       1
 362       1
 345       1
-133       1
Name: value1, Length: 336, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First get rid of garbarge entries.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
    <span class="n">weather_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;value</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weather_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;value</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="o">-</span><span class="mi">9999</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weather_data</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;avg_C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;avg&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<p><strong>(6)</strong> Now for each weather station, generate a separate plot of the daily temperatures over time. You should end up with a plot that looks something like this:</p>
<p><img alt="temp_plots_Colorado" src="ids720_specific/images/temp_plots_Boulder_CO.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">weather_data</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;USC00050848&quot;</span><span class="p">:</span> <span class="s2">&quot;Boulder, CO&quot;</span><span class="p">,</span>
    <span class="s2">&quot;IN022021900&quot;</span><span class="p">:</span> <span class="s2">&quot;Safdarjung, New Delhi, India&quot;</span><span class="p">,</span>
    <span class="s2">&quot;AR000087007&quot;</span><span class="p">:</span> <span class="s2">&quot;Jujuy, Argentina&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">weather_data</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">g</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ggplot</span><span class="p">(</span><span class="n">weather_data</span><span class="p">[</span><span class="n">weather_data</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">station</span><span class="p">],</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;avg_C&quot;</span><span class="p">))</span>
        <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span>
        <span class="o">+</span> <span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;lm&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">labs</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Monthly Avg of Daily High Temps, </span><span class="si">{</span><span class="n">names</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Monthly Average of Daily High in Centigrade&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">name_no_comma</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">station</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name_no_comma</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;/users/nick/github/practicaldatascience/source/images/temp_plots_</span><span class="si">{</span><span class="n">name_no_comma</span><span class="si">}</span><span class="s2">.png&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jujuy_Argentina
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/plotnine/ggplot.py:719: PlotnineWarning: Saving 6.4 x 4.8 in image.
/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/plotnine/ggplot.py:722: PlotnineWarning: Filename: /users/nick/github/practicaldatascience/source/images/temp_plots_Jujuy_Argentina.png
</pre></div>
</div>
<img alt="../../_images/5a0fce478b556c1f4784b74355597a875a7638d3782c11e21584a4608fd56b32.png" src="../../_images/5a0fce478b556c1f4784b74355597a875a7638d3782c11e21584a4608fd56b32.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Safdarjung_New_Delhi_India
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/plotnine/ggplot.py:719: PlotnineWarning: Saving 6.4 x 4.8 in image.
/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/plotnine/ggplot.py:722: PlotnineWarning: Filename: /users/nick/github/practicaldatascience/source/images/temp_plots_Safdarjung_New_Delhi_India.png
</pre></div>
</div>
<img alt="../../_images/34ed8d093b074d6cfb82c6357d82ae7d22398e99afeca49e62a3f9267a92eda0.png" src="../../_images/34ed8d093b074d6cfb82c6357d82ae7d22398e99afeca49e62a3f9267a92eda0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Boulder_CO
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/plotnine/ggplot.py:719: PlotnineWarning: Saving 6.4 x 4.8 in image.
/Users/Nick/opt/miniconda3/lib/python3.9/site-packages/plotnine/ggplot.py:722: PlotnineWarning: Filename: /users/nick/github/practicaldatascience/source/images/temp_plots_Boulder_CO.png
</pre></div>
</div>
<img alt="../../_images/7f9ad3791f2d3cd49467930fd6e7ce9760de278999bfe1c0412a078843aa5f92.png" src="../../_images/7f9ad3791f2d3cd49467930fd6e7ce9760de278999bfe1c0412a078843aa5f92.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<section id="want-more-practice">
<h2>Want More Practice?<a class="headerlink" href="#want-more-practice" title="Link to this heading">#</a></h2>
<p>If you <em>really</em> want a challenge, the file <code class="docutils literal notranslate"><span class="pre">ghcnd_daily_30gb.tar.gz</span></code> will decompress into <code class="docutils literal notranslate"><span class="pre">ghcnd_daily.dat</span></code>, the full version of the GHCND daily data. It contains not only daily high temps, but also daily low temps, preciptionation, etc. Moreover, it is still in fixed-width format, and is about 30gb in raw form.</p>
<p>Importing and chunking this data (with moderate optimizations) took about 2 hours on my computer.</p>
<p>If you’re up for it, it’s a great dataset to wrestling with data in weird formats and chunking.</p>
<p><strong>Pro-tip:</strong> strings take up <em>way</em> more space in RAM than numbers, so some columns can be converted to keep the memory footprint of the data down.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ids720_specific/exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-more-practice">Want More Practice?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Bradbury & Nick Eubank
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>