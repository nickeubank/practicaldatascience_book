
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EXERCISE SOLUTIONS: NOT FOR POSTING &#8212; Practical Data Science with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-MC77BKR89Z"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MC77BKR89Z');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-MC77BKR89Z');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/class_3/week_4/16S_Exercise_merging_solutions';</script>
    <link rel="icon" href="../../../_static/mids_logo.svg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Practical Data Science with Python - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Practical Data Science with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Practical Data Science in Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">IDS 720</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../ids720_specific/class_schedule.html">Class Schedule</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Setting Up Your Environment</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_python.html">Setting Up Python and conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_vscode.html">Setting Up VS Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/setup_augmented_commandline.html">Augmenting Your Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/jupyter_in_vscode.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/00_setup_env/jupyter_r_notebooks.html">VS Code, R, and Jupyter</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Command Line</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/commandline_part1.html">Command Line Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/commandline_part2.html">Advanced Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/10_commandline/git_and_github.html">Git and Github</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numpy</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_2/10_why_numpy.html">Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/20_intro_to_vectors.html">Working with Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/21_math_with_vectors.html">Doing Math With Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/23_type_promotion_in_vectors.html">Type Promotion in numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/10_speed_and_ease_of_use.html">The Python Ease of Use / Speed Tradeoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/11_vectorization.html">Vectorization in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/24_vector_recap.html">Vector Recap</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_2/30_subsetting_vectors.html">Subsetting Vectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/35_modifying_subsets_of_vectors.html">Modifying Subsets of Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_2/37_vector_subsets_recap.html">Recap</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_3/10_views_and_copies.html">Views and Copies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/11_when_do_I_get_a_view.html">When Do I Get a View and When Do I Get a Copy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/13_objects_and_variables.html">Variables are pointers to objects</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/12_views_and_copies_recap.html">Review of Views and Copies</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_3/00_welcome_to_week_3.html">Matrices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/20_matrices.html">Intro to Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/22_reshaping_matrices.html">Folding and Reshaping Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/25_images_as_matrices.html">Matrices as Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/30_subsetting_matrices.html">Subsetting Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/32_modifying_subsets.html">Editing Subsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/33_matrix_recaps.html">Review of Matrices</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_2/week_3/40_nd_arrays.html">Arrays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/41_broadcasting.html">Broadcasting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_3/42_nd_array_review.html">Review of ND-Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/03_summarizing_arrays.html">Summarizing Arrays</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/04_summarizing_arrays_example.html">Practical Example: comparing weather by counting like-values</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_2/week_4/04.1_color_images_as_arrays.html">Color Images as Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_2/week_4/20_random_numbers.html">Random numbers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pandas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_2/00_intro_to_pandas.html">Welcome to Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_2/10_pandas_series.html">Pandas Series</a></li>

<li class="toctree-l2"><a class="reference internal" href="../week_2/15_manipulating_series.html">Subsetting and Indexing Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/16_indexing_with_brackets.html">(OPTIONAL) Subsetting and Indexing with Single Square Brackets (<code class="docutils literal notranslate"><span class="pre">[]</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/18_object_dtype.html">The <code class="docutils literal notranslate"><span class="pre">object</span></code> Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/30_pandas_dataframes.html">Working with tabular data through Dataframes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/35_pandas_dataframe_gotchas.html">Subsetting DataFrame Tricks and Gotchas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/45_categorical_dtype.html">The Categorical Data Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_2/50_pandas_pyarrow.html">PyArrow: An Alternative to Numpy as Pandas Backend</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../week_3/07_indices.html">Indexes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_3/10_views_and_copies_numpy_review.html">Views and Copies in Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_3/15_views_and_copies_in_pandas.html">Views and Copies in pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_3/17_views_and_copies_in_pandas_wo_CoW.html">The View/Copy Headache in pandas without Copy on Write</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_3/03_plaintext_files.html">Reading Data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_3/05_binary_files.html">Binary Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../week_3/20_cleaning_identifying.html">Data Cleaning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../week_3/30_cleaning_editing_globally.html">Fixing Data Value Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_3/32_cleaning_editing_specific_locations.html">Editing Specific Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_3/33_cleaning_datatypes.html">Cleaning Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../week_3/35_cleaning_missing_data.html">Missing Data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="00_intro_to_querying_data.html">Data Manipulations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="10_combining_concatenating.html">Concatenating</a></li>
<li class="toctree-l2"><a class="reference internal" href="15_combining_merging.html">Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="15.1_combining_merging_continued.html">Combining datasets: merging</a></li>

<li class="toctree-l2"><a class="reference internal" href="15.2_combining_merging_practical_example.html">Practical Example</a></li>

<li class="toctree-l2"><a class="reference internal" href="15.3_validating_a_merge.html">Validating Merges</a></li>
<li class="toctree-l2"><a class="reference internal" href="20_grouping.html">Grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="30_queries.html">Querying</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_5/week_1/1.1.2_effective_plotting_practices.html">Matplotlib Fundamentals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.1_basic_plotting_with_matplotlib.html">Plotting with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.2_ten_figure_pieces.html">A figure in 10 pieces</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.4.5_explicit_vs_implicit_syntax.html">Implicit vs explicit syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.4.4_saving_to_file.html">Saving to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.5.1_plotting_zoo.html">Plotting Zoo: multiple ways to visualize the same set of data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.6.1_plotting_with_pandas.html">Plotting with Pandas</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_5/week_1/1.2.4_bar_plots_deep_dive.html">Different Types of Plots</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.3_text.html">Plotting text (and a side note on axis scaling)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.5_stack_plots.html">Stack Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.6_pie_charts.html">Pie charts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.7.1_subplots.html">Subplots</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.7.2_subplots_deep_dive.html">Subplots: a deeper dive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.7.EXS_timeseries_worked_example.html">Exercise: Creating a subplot of timeseries (solution)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.7.EX_timeseries_worked_example.html">Exercise: Creating a subplot of timeseries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.7_scatter_plots_deep_dive.html">Doing more with scatter plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.8_errorbars.html">Visualizing ranges and uncertainty</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.2.9_heat_maps.html">Heat maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.3.1.EXS_histograms_solutions.html">Exercise: Analyzing Poker Hand Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.3.1.EX_histograms.html">Exercise: Analyzing Poker Hand Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.3.1_histograms.html">Histograms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/1.3.2_2d_histograms.html">Two Dimensional Histograms</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_5/week_1/2.1.1_the_matplotlib_model.html">Advanced Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/2.1.2_customizing_plot_styles.html">Customizing styles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/2.1.3_plotting_zoo_restyled.html">Plotting Zoo - with style!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/2.2.1_making_plots_pretty_1.html">Making Plots Pretty Part 1: laying the foundation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/2.2.2_making_plots_pretty_2.html">Making pretty plots in Python: customizing plots in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../class_5/week_1/2.3.1_plotting_with_seaborn.html">Seaborn Objects and GoG</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class_5/week_1/2.3.2_seaborn_recipes.html">Seaborn Object Recipes</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Big Data &amp; Performance</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/30_big_data/10_big_data_what_is_it.html">What is Big Data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/30_big_data/20_big_data_strategies.html">Big Data Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/30_big_data/30_parquet.html">Parquet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/object_vectors.html">Object dtypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/30_big_data/50_performance_solutions.html">Solving Performance Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/30_big_data/60_parallelism.html">Parallel Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/30_big_data/70_dask.html">Distributed Computing with dask</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical Skills and Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/10_debugging_principles.html">Debugging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/20_debugging_in_vscode.html">Debugging Python in VS Code</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming.html">Defensive Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_tests.html">Testing in a Data Analysis Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_readability.html">Readability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_duplicate.html">Don’t Duplicate Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/defensive_programming_collaboration.html">Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/iceberg_principle.html">The Iceberg Principle</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/workflow.html">Workflow Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/getting_help.html">Getting Help Online</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/vars_v_objects.html">Python: Variables vs. Objects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/python_v_r.html">Python vs. R: Important Differences To Be Aware Of</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/backwards_design.html">Backwards Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/ints_and_floats.html">Numbers in Computers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/writing_good_jupyter_notebooks.html">Writing Good Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/pr_review.html">Reviewing Code on Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/20_programming_concepts/conda_environments.html">conda Environments</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Modelling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../class_5/week_3/20_inference_v_prediction.html">Inference vs. Prediction Data Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_5/week_3/30_linear_regression_in_python.html">Linear Regression in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_5/week_3/15_brief_intro_categorical_variables.html">Categorical Variables, Indicator Variables and Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_5/week_3/35_pandas_to_numpy_with_patsy.html">Pulling Back the Curtain: Pandas to Numpy with patsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_5/week_3/40_linear_regression_extensions.html">OPTIONAL: Beyond The Basic Model</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Professional Advice</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/buying_datascience_computer.html">How To Buy A Computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/llms.html">chatGPT and You</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/PhD_Advice.html">So You’re Thinking About a PhD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/ergonomics_and_adaptive_tech.html">Ergonomics and Adaptive Tech</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PDS_not_yet_in_coursera/99_advice/mids_electives.html">Duke Data Science Electives</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../class_2/week_1/00_interactive_console.html">Running Python in the VS Code Interactive Window</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class_2/week_4/30_managing_python_packages.html">Understanding and Managing Python Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other/fstrings.html">Combining numbers and text into strings: f-strings</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/nickeubank/practicaldatascience_book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/class_3/week_4/16S_Exercise_merging_solutions.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/class_3/week_4/16S_Exercise_merging_solutions.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EXERCISE SOLUTIONS: NOT FOR POSTING</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">EXERCISE SOLUTIONS: NOT FOR POSTING</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-data-to-understand-the-relationship-between-drug-legalization-and-violent-crime">Merging Data to Understand the Relationship between Drug Legalization and Violent Crime</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-our-data-pre-legalization">Loading our data pre-legalization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-our-data">Merging our data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-arrest-rates-and-gathering-2018-data">Calculating arrest rates and gathering 2018 data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-2009-with-2018-arrests-repeating-your-merge-from-the-2009-data">Comparing 2009 with 2018 Arrests: Repeating your merge from the 2009 data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13">Exercise 13</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diving-deeper-into-the-post-legalization-changes">Diving deeper into the post-legalization changes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14">Exercise 14</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15">Exercise 15</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execise-16">Execise 16</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-17">Exercise 17</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-solutions-not-for-posting">
<h1>EXERCISE SOLUTIONS: NOT FOR POSTING<a class="headerlink" href="#exercise-solutions-not-for-posting" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="merging-data-to-understand-the-relationship-between-drug-legalization-and-violent-crime">
<h1>Merging Data to Understand the Relationship between Drug Legalization and Violent Crime<a class="headerlink" href="#merging-data-to-understand-the-relationship-between-drug-legalization-and-violent-crime" title="Link to this heading">#</a></h1>
<p>In recent years, many US states have decided to legalize the use of marijuana.</p>
<p>When these ideas were first proposed, there were many theories about the relationship between crime and the “War on Drugs” (the term given to US efforts to arrest drug users and dealers over the past several decades).</p>
<p>In this exercise, we’re going to test a few of those theories using drug arrest data from the state of California.</p>
<p><strong>Note: this is one of the most ambitious exercises in this Coursera course! It is quite involved, and requires you to think not just about how to get your pandas code to work, but also to think about where the data comes from what and what you are trying to accomplish!</strong></p>
<p>Though California has passed a number of laws lessening penalties for marijuana possession over the years, arguably the biggest changes were in  2010, when the state changed the penalty for possessing a small amount of marijuana from a criminal crime to a “civil” penality (meaning those found guilty only had to pay a fine, not go to jail), though possessing, selling, or producing larger quantities remained illegal. Then in 2016, the state fully legalized marijuana for recreational use, not only making possession of small amounts legal, but also creating a regulatory system for producing marijuana for sale.</p>
<p>Proponents of drug legalization have long argued that the war on drugs contributes to violent crime by creating an opportunity for drug dealers and organized crime to sell and distribute drugs, a business which tends to generate violence when gangs battle over territory. According to this theory, with drug legalization, we should see violent crime decrease after legalization in places where drug arrests had previously been common. In this exercise, we will explore this argument and explore the relationship between drug legalization and violent crime.</p>
<p><strong>To be clear,</strong> drug legalization is a complex issue and far more study than what we will do here is required to understand its complexities! This exercise is meant to help you think through how to address data science questions programmatically.</p>
<section id="loading-our-data-pre-legalization">
<h2>Loading our data pre-legalization<a class="headerlink" href="#loading-our-data-pre-legalization" title="Link to this heading">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>We will begin by examining <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/tree/master/Example_Data/ca">county-level data on arrests from California in 2009</a>, which is derived from data provided by the Office of the California State Attorney General <a class="reference external" href="https://openjustice.doj.ca.gov/data">here</a>. Load the file <code class="docutils literal notranslate"><span class="pre">ca_arrests_2009.csv</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;mode.copy_on_write&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_rows&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">file2009</span> <span class="o">=</span> <span class="s2">&quot;data/ca_arrests_2009.csv&quot;</span>
<span class="n">df_arrests_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file2009</span><span class="p">)</span>
<span class="n">df_arrests_2009</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1682</td>
      <td>Alameda County</td>
      <td>4318</td>
      <td>4640</td>
      <td>5749</td>
      <td>260</td>
      <td>3502</td>
      <td>18469</td>
      <td>37247</td>
      <td>431</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1683</td>
      <td>Alpine County</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>83</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1684</td>
      <td>Amador County</td>
      <td>100</td>
      <td>59</td>
      <td>101</td>
      <td>5</td>
      <td>199</td>
      <td>464</td>
      <td>801</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1685</td>
      <td>Butte County</td>
      <td>641</td>
      <td>602</td>
      <td>542</td>
      <td>34</td>
      <td>429</td>
      <td>2248</td>
      <td>9026</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1686</td>
      <td>Calaveras County</td>
      <td>211</td>
      <td>83</td>
      <td>123</td>
      <td>14</td>
      <td>70</td>
      <td>501</td>
      <td>968</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1735</td>
      <td>Tulare County</td>
      <td>2183</td>
      <td>2080</td>
      <td>1681</td>
      <td>170</td>
      <td>1767</td>
      <td>7881</td>
      <td>15368</td>
      <td>301</td>
    </tr>
    <tr>
      <th>54</th>
      <td>1736</td>
      <td>Tuolumne County</td>
      <td>160</td>
      <td>252</td>
      <td>209</td>
      <td>14</td>
      <td>261</td>
      <td>896</td>
      <td>2062</td>
      <td>83</td>
    </tr>
    <tr>
      <th>55</th>
      <td>1737</td>
      <td>Ventura County</td>
      <td>2275</td>
      <td>2425</td>
      <td>2040</td>
      <td>120</td>
      <td>2083</td>
      <td>8943</td>
      <td>25762</td>
      <td>1734</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1738</td>
      <td>Yolo County</td>
      <td>585</td>
      <td>634</td>
      <td>614</td>
      <td>39</td>
      <td>662</td>
      <td>2534</td>
      <td>5426</td>
      <td>73</td>
    </tr>
    <tr>
      <th>57</th>
      <td>1739</td>
      <td>Yuba County</td>
      <td>354</td>
      <td>368</td>
      <td>211</td>
      <td>39</td>
      <td>257</td>
      <td>1229</td>
      <td>2967</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 10 columns</p>
</div></div></div>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<p>Use your data exploration skills to get a feel for this data. If you need to, you can find the <a class="reference external" href="https://data-openjustice.doj.ca.gov/sites/default/files/dataset/2019-07/Arrests%20Context_062119.pdf">original codebook here</a> (This data are similar, but have been collapsed to one observation per county.)</p>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<p>Figuring out what county has the most violent arrests isn’t very meaningful if we don’t normalize for size. A county with 10 people and 10 arrests for violent crimes is obviously worse than a county with 1,000,000 people an 11 arrests for violent crime.</p>
<p>To address this, also import <code class="docutils literal notranslate"><span class="pre">nhgis_county_populations.csv</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_file</span> <span class="o">=</span> <span class="s2">&quot;data/nhgis_county_populations.csv&quot;</span>
<span class="n">df_pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">pop_file</span><span class="p">)</span>
<span class="n">df_pop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Autauga County</td>
      <td>49584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Baldwin County</td>
      <td>171997</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Barbour County</td>
      <td>29663</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Bibb County</td>
      <td>21464</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2005-2009</td>
      <td>Alabama</td>
      <td>Blount County</td>
      <td>56804</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6436</th>
      <td>3215</td>
      <td>2013-2017</td>
      <td>Puerto Rico</td>
      <td>Vega Baja Municipio</td>
      <td>54754</td>
    </tr>
    <tr>
      <th>6437</th>
      <td>3216</td>
      <td>2013-2017</td>
      <td>Puerto Rico</td>
      <td>Vieques Municipio</td>
      <td>8931</td>
    </tr>
    <tr>
      <th>6438</th>
      <td>3217</td>
      <td>2013-2017</td>
      <td>Puerto Rico</td>
      <td>Villalba Municipio</td>
      <td>23659</td>
    </tr>
    <tr>
      <th>6439</th>
      <td>3218</td>
      <td>2013-2017</td>
      <td>Puerto Rico</td>
      <td>Yabucoa Municipio</td>
      <td>35025</td>
    </tr>
    <tr>
      <th>6440</th>
      <td>3219</td>
      <td>2013-2017</td>
      <td>Puerto Rico</td>
      <td>Yauco Municipio</td>
      <td>37585</td>
    </tr>
  </tbody>
</table>
<p>6441 rows × 5 columns</p>
</div></div></div>
</div>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h3>
<p>Use your data exploration skills to get used to these data and figure out how they relates to your 2009 arrest data. Determine the meaning of the various columns and check the data for completeness</p>
</section>
</section>
<section id="merging-our-data">
<h2>Merging our data<a class="headerlink" href="#merging-our-data" title="Link to this heading">#</a></h2>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h3>
<p>Once you feel like you have a good sense of the relation between our arrest and population data, merge the two datasets. You may need to filter the data first. Do both datasets cover all states or just some or just one? Which years do you care about in this case?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter the data so we&#39;re only using data from the correct year and the correct State</span>
<span class="n">df_pop_filtered_2009</span> <span class="o">=</span> <span class="n">df_pop</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pop</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2005-2009&quot;</span><span class="p">]</span>
<span class="n">df_pop_filtered_2009</span> <span class="o">=</span> <span class="n">df_pop_filtered_2009</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">df_pop_filtered_2009</span><span class="p">[</span><span class="s2">&quot;STATE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;California&quot;</span>
<span class="p">]</span>
<span class="n">df_pop_filtered_2009</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pop_filtered_2009</span><span class="p">[</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Alameda County&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>186</th>
      <td>186</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Alameda County</td>
      <td>1457095</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h3>
<p>Now repeat your previous merge using <em>both</em> the <code class="docutils literal notranslate"><span class="pre">validate</span></code> keyword <em>and</em> the <code class="docutils literal notranslate"><span class="pre">indicator</span></code> keyword with <code class="docutils literal notranslate"><span class="pre">how=&quot;outer&quot;</span></code> as discussed in the last reading to help you debug your merge. (Hint: your merge should end up being a one to one merge)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_arrests_2009</span><span class="p">,</span> <span class="n">df_pop_filtered_2009</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span>
<span class="p">)</span>
<span class="n">df_2009</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
      <th>Unnamed: 0_y</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1682</td>
      <td>Alameda County</td>
      <td>4318</td>
      <td>4640</td>
      <td>5749</td>
      <td>260</td>
      <td>3502</td>
      <td>18469</td>
      <td>37247</td>
      <td>431</td>
      <td>186.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>1457095.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1683</td>
      <td>Alpine County</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>83</td>
      <td>0</td>
      <td>187.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>1153.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1684</td>
      <td>Amador County</td>
      <td>100</td>
      <td>59</td>
      <td>101</td>
      <td>5</td>
      <td>199</td>
      <td>464</td>
      <td>801</td>
      <td>2</td>
      <td>188.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>38039.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1685</td>
      <td>Butte County</td>
      <td>641</td>
      <td>602</td>
      <td>542</td>
      <td>34</td>
      <td>429</td>
      <td>2248</td>
      <td>9026</td>
      <td>1</td>
      <td>189.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>217917.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1686</td>
      <td>Calaveras County</td>
      <td>211</td>
      <td>83</td>
      <td>123</td>
      <td>14</td>
      <td>70</td>
      <td>501</td>
      <td>968</td>
      <td>3</td>
      <td>190.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>46548.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1735</td>
      <td>Tulare County</td>
      <td>2183</td>
      <td>2080</td>
      <td>1681</td>
      <td>170</td>
      <td>1767</td>
      <td>7881</td>
      <td>15368</td>
      <td>301</td>
      <td>239.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>416299.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>1736</td>
      <td>Tuolumne County</td>
      <td>160</td>
      <td>252</td>
      <td>209</td>
      <td>14</td>
      <td>261</td>
      <td>896</td>
      <td>2062</td>
      <td>83</td>
      <td>240.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>55761.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>1737</td>
      <td>Ventura County</td>
      <td>2275</td>
      <td>2425</td>
      <td>2040</td>
      <td>120</td>
      <td>2083</td>
      <td>8943</td>
      <td>25762</td>
      <td>1734</td>
      <td>241.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>792313.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1738</td>
      <td>Yolo County</td>
      <td>585</td>
      <td>634</td>
      <td>614</td>
      <td>39</td>
      <td>662</td>
      <td>2534</td>
      <td>5426</td>
      <td>73</td>
      <td>242.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>192974.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>1739</td>
      <td>Yuba County</td>
      <td>354</td>
      <td>368</td>
      <td>211</td>
      <td>39</td>
      <td>257</td>
      <td>1229</td>
      <td>2967</td>
      <td>4</td>
      <td>243.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>70906.0</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 14 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_arrests_2009</span><span class="p">,</span>
    <span class="n">df_pop_filtered_2009</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span>
    <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df_2009</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          56
left_only      2
right_only     2
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span><span class="p">[</span><span class="n">df_2009</span><span class="o">.</span><span class="n">_merge</span> <span class="o">!=</span> <span class="s2">&quot;both&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
      <th>Unnamed: 0_y</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>total_population</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>1689.0</td>
      <td>Del Norte County</td>
      <td>144.0</td>
      <td>104.0</td>
      <td>79.0</td>
      <td>13.0</td>
      <td>97.0</td>
      <td>437.0</td>
      <td>1268.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>DelNorte County</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>193.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>28729.0</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NaN</td>
      <td>Injo County</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>199.0</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>17438.0</td>
      <td>right_only</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1695.0</td>
      <td>Inyo County</td>
      <td>81.0</td>
      <td>44.0</td>
      <td>39.0</td>
      <td>3.0</td>
      <td>38.0</td>
      <td>205.0</td>
      <td>851.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>left_only</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercise-7">
<h3>Exercise 7<a class="headerlink" href="#exercise-7" title="Link to this heading">#</a></h3>
<p>You <em>should</em> be able to get to the point that all counties in our arrest data merge with population data. Can you figure out why that did not happen? Using the tools we just discussed, look for any inconsistencies across the two datasets to see if anything did not match when it should have.</p>
<p><strong>You will need to fix the data so that all 58 counties in the arrest data merge with population data for your subsequent answers to be correct.</strong></p>
<p>The type of data edit we’re asking you to make may make you feel a little uncomfortable — who are you to edit the data, after all?! The answer is: you’re the data scientist who has to make sense of this data! When merging data — especially data that uses names stored as strings — you will often discover different datasets have found slightly different ways to label observations. It’s up to you to use your critical thinking skills, context clues, and domain knowledge to evaluate whether you think observations in different datasets are actually the same entity.</p>
<p><em>Hint: what are the DataFrames being merged on? Does it match across both DataFrames?</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pop_fixed_2009</span> <span class="o">=</span> <span class="n">df_pop_filtered_2009</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="n">to_replace</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DelNorte County&quot;</span><span class="p">,</span> <span class="s2">&quot;Injo County&quot;</span><span class="p">],</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Del Norte County&quot;</span><span class="p">,</span> <span class="s2">&quot;Inyo County&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df_pop_fixed_2009</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>186</th>
      <td>186</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Alameda County</td>
      <td>1457095</td>
    </tr>
    <tr>
      <th>187</th>
      <td>187</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Alpine County</td>
      <td>1153</td>
    </tr>
    <tr>
      <th>188</th>
      <td>188</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Amador County</td>
      <td>38039</td>
    </tr>
    <tr>
      <th>189</th>
      <td>189</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Butte County</td>
      <td>217917</td>
    </tr>
    <tr>
      <th>190</th>
      <td>190</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Calaveras County</td>
      <td>46548</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>239</th>
      <td>239</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Tulare County</td>
      <td>416299</td>
    </tr>
    <tr>
      <th>240</th>
      <td>240</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Tuolumne County</td>
      <td>55761</td>
    </tr>
    <tr>
      <th>241</th>
      <td>241</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Ventura County</td>
      <td>792313</td>
    </tr>
    <tr>
      <th>242</th>
      <td>242</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Yolo County</td>
      <td>192974</td>
    </tr>
    <tr>
      <th>243</th>
      <td>243</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>Yuba County</td>
      <td>70906</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_arrests_2009</span><span class="p">,</span>
    <span class="n">df_pop_fixed_2009</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span>
    <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df_2009</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          58
left_only      0
right_only     0
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
      <th>Unnamed: 0_y</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>total_population</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1682</td>
      <td>Alameda County</td>
      <td>4318</td>
      <td>4640</td>
      <td>5749</td>
      <td>260</td>
      <td>3502</td>
      <td>18469</td>
      <td>37247</td>
      <td>431</td>
      <td>186</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>1457095</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1683</td>
      <td>Alpine County</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>83</td>
      <td>0</td>
      <td>187</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>1153</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1684</td>
      <td>Amador County</td>
      <td>100</td>
      <td>59</td>
      <td>101</td>
      <td>5</td>
      <td>199</td>
      <td>464</td>
      <td>801</td>
      <td>2</td>
      <td>188</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>38039</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1685</td>
      <td>Butte County</td>
      <td>641</td>
      <td>602</td>
      <td>542</td>
      <td>34</td>
      <td>429</td>
      <td>2248</td>
      <td>9026</td>
      <td>1</td>
      <td>189</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>217917</td>
      <td>both</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1686</td>
      <td>Calaveras County</td>
      <td>211</td>
      <td>83</td>
      <td>123</td>
      <td>14</td>
      <td>70</td>
      <td>501</td>
      <td>968</td>
      <td>3</td>
      <td>190</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>46548</td>
      <td>both</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1735</td>
      <td>Tulare County</td>
      <td>2183</td>
      <td>2080</td>
      <td>1681</td>
      <td>170</td>
      <td>1767</td>
      <td>7881</td>
      <td>15368</td>
      <td>301</td>
      <td>239</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>416299</td>
      <td>both</td>
    </tr>
    <tr>
      <th>54</th>
      <td>1736</td>
      <td>Tuolumne County</td>
      <td>160</td>
      <td>252</td>
      <td>209</td>
      <td>14</td>
      <td>261</td>
      <td>896</td>
      <td>2062</td>
      <td>83</td>
      <td>240</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>55761</td>
      <td>both</td>
    </tr>
    <tr>
      <th>55</th>
      <td>1737</td>
      <td>Ventura County</td>
      <td>2275</td>
      <td>2425</td>
      <td>2040</td>
      <td>120</td>
      <td>2083</td>
      <td>8943</td>
      <td>25762</td>
      <td>1734</td>
      <td>241</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>792313</td>
      <td>both</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1738</td>
      <td>Yolo County</td>
      <td>585</td>
      <td>634</td>
      <td>614</td>
      <td>39</td>
      <td>662</td>
      <td>2534</td>
      <td>5426</td>
      <td>73</td>
      <td>242</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>192974</td>
      <td>both</td>
    </tr>
    <tr>
      <th>57</th>
      <td>1739</td>
      <td>Yuba County</td>
      <td>354</td>
      <td>368</td>
      <td>211</td>
      <td>39</td>
      <td>257</td>
      <td>1229</td>
      <td>2967</td>
      <td>4</td>
      <td>243</td>
      <td>2005-2009</td>
      <td>California</td>
      <td>70906</td>
      <td>both</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 15 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="calculating-arrest-rates-and-gathering-2018-data">
<h2>Calculating arrest rates and gathering 2018 data<a class="headerlink" href="#calculating-arrest-rates-and-gathering-2018-data" title="Link to this heading">#</a></h2>
<section id="exercise-8">
<h3>Exercise 8<a class="headerlink" href="#exercise-8" title="Link to this heading">#</a></h3>
<p>Now that we have arrest counts and population data, we can calculate arrest <em>rates</em>. For each county, create a new variable called <code class="docutils literal notranslate"><span class="pre">violent_arrest_rate_2009</span></code> that is the number of violent arrests for 2009 divided by the population of the county from 2005-2009, and an analogous variable for drug offenses (<code class="docutils literal notranslate"><span class="pre">F_DRUGOFF</span></code>) called <code class="docutils literal notranslate"><span class="pre">f_drugoff_arrest_rate_2009</span></code>.</p>
<p>In general, people tend not to be arrested that often as a share of population, so to avoid working with tiny numbers, statistics like arrest rates are often reported as arrests per X people (rather than arrests per capita, which is just arrests divided by population).</p>
<p><strong>For this and all following exercises, please calculate arrest rates as arrests per 1,000 people</strong>.</p>
<p>Calculate the average county-level felony drug arrest rate for 2009 (in arrests per 1,000) rounded to three significant places. <strong>Note this average value - you will need to submit this at the end of this week for the final Quiz.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_2009</span><span class="p">[</span><span class="s2">&quot;VIOLENT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_2009</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1_000</span>
<span class="p">)</span>
<span class="n">df_2009</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_2009</span><span class="p">[</span><span class="s2">&quot;F_DRUGOFF&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_2009</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1_000</span>
<span class="p">)</span>


<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Avg Felongy arrest rate in 2009 / 1,000&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; is </span><span class="si">{</span><span class="n">df_2009</span><span class="p">[</span><span class="s1">&#39;f_drugoff_arrest_rate_2009&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">df_2009</span><span class="p">[</span><span class="s1">&#39;f_drugoff_arrest_rate_2009&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> is wrong num sig figs&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Avg Felongy arrest rate in 2009 / 1,000 is 3.19.
3.191 is wrong num sig figs
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-9">
<h3>Exercise 9<a class="headerlink" href="#exercise-9" title="Link to this heading">#</a></h3>
<p>Just as we created violent arrest rates and drug arrest rates for 2009, now we want to do it for 2018, so we can work towards comparing the two. Using the data on 2018 arrests (ca_arrests_2018.csv) and the same dataset of population data (you’ll use population from 2013-2017 this time), create a dataset of arrest rates.</p>
<p>As before, be careful with your merges! The same issues you uncovered with the 2009 data are likely to also be present here, <strong>and if you don’t correct them again, your following answers will be incorrect.</strong></p>
<p>If you:</p>
<p>(a) don’t end up with population data for all 58 counties, or</p>
<p>(b) don’t get your merge to be 1-to-1</p>
<p>something is wrong.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;data/ca_arrests_2018.csv&quot;</span>
<span class="n">df_arrests_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">df_arrests_2018</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>COUNTY</th>
      <th>VIOLENT</th>
      <th>PROPERTY</th>
      <th>F_DRUGOFF</th>
      <th>F_SEXOFF</th>
      <th>F_ALLOTHER</th>
      <th>F_TOTAL</th>
      <th>M_TOTAL</th>
      <th>S_TOTAL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2204</td>
      <td>Alameda County</td>
      <td>4132</td>
      <td>3051</td>
      <td>1062</td>
      <td>173</td>
      <td>2619</td>
      <td>11037</td>
      <td>28305</td>
      <td>82</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2205</td>
      <td>Alpine County</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>11</td>
      <td>41</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2206</td>
      <td>Amador County</td>
      <td>72</td>
      <td>40</td>
      <td>31</td>
      <td>3</td>
      <td>142</td>
      <td>288</td>
      <td>701</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2207</td>
      <td>Butte County</td>
      <td>785</td>
      <td>437</td>
      <td>229</td>
      <td>47</td>
      <td>741</td>
      <td>2239</td>
      <td>8853</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2208</td>
      <td>Calaveras County</td>
      <td>147</td>
      <td>42</td>
      <td>29</td>
      <td>6</td>
      <td>96</td>
      <td>320</td>
      <td>897</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2257</td>
      <td>Tulare County</td>
      <td>2322</td>
      <td>1495</td>
      <td>931</td>
      <td>107</td>
      <td>1741</td>
      <td>6596</td>
      <td>15163</td>
      <td>360</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2258</td>
      <td>Tuolumne County</td>
      <td>203</td>
      <td>122</td>
      <td>87</td>
      <td>9</td>
      <td>311</td>
      <td>732</td>
      <td>2019</td>
      <td>12</td>
    </tr>
    <tr>
      <th>55</th>
      <td>2259</td>
      <td>Ventura County</td>
      <td>2271</td>
      <td>1535</td>
      <td>732</td>
      <td>80</td>
      <td>2193</td>
      <td>6811</td>
      <td>26612</td>
      <td>630</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2260</td>
      <td>Yolo County</td>
      <td>575</td>
      <td>351</td>
      <td>120</td>
      <td>22</td>
      <td>518</td>
      <td>1586</td>
      <td>4602</td>
      <td>6</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2261</td>
      <td>Yuba County</td>
      <td>391</td>
      <td>188</td>
      <td>164</td>
      <td>13</td>
      <td>257</td>
      <td>1013</td>
      <td>1942</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pop_filtered_2018</span> <span class="o">=</span> <span class="n">df_pop</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pop</span><span class="p">[</span><span class="s2">&quot;YEAR&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;2013-2017&quot;</span><span class="p">]</span>
<span class="n">df_pop_filtered_2018</span> <span class="o">=</span> <span class="n">df_pop_filtered_2018</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">df_pop_filtered_2018</span><span class="p">[</span><span class="s2">&quot;STATE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;California&quot;</span>
<span class="p">]</span>
<span class="n">df_pop_filtered_2018</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_pop_filtered_2018</span><span class="p">[</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Alameda County&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3407</th>
      <td>186</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Alameda County</td>
      <td>1629615</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pop_fixed_2018</span> <span class="o">=</span> <span class="n">df_pop_filtered_2018</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
    <span class="n">to_replace</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DelNorte County&quot;</span><span class="p">,</span> <span class="s2">&quot;Injo County&quot;</span><span class="p">],</span>
    <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Del Norte County&quot;</span><span class="p">,</span> <span class="s2">&quot;Inyo County&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">df_pop_fixed_2018</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>YEAR</th>
      <th>STATE</th>
      <th>COUNTY</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3407</th>
      <td>186</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Alameda County</td>
      <td>1629615</td>
    </tr>
    <tr>
      <th>3408</th>
      <td>187</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Alpine County</td>
      <td>1203</td>
    </tr>
    <tr>
      <th>3409</th>
      <td>188</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Amador County</td>
      <td>37306</td>
    </tr>
    <tr>
      <th>3410</th>
      <td>189</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Butte County</td>
      <td>225207</td>
    </tr>
    <tr>
      <th>3411</th>
      <td>190</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Calaveras County</td>
      <td>45057</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3460</th>
      <td>239</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Tulare County</td>
      <td>458809</td>
    </tr>
    <tr>
      <th>3461</th>
      <td>240</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Tuolumne County</td>
      <td>53899</td>
    </tr>
    <tr>
      <th>3462</th>
      <td>241</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Ventura County</td>
      <td>847834</td>
    </tr>
    <tr>
      <th>3463</th>
      <td>242</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Yolo County</td>
      <td>212605</td>
    </tr>
    <tr>
      <th>3464</th>
      <td>243</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>Yuba County</td>
      <td>74644</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_arrests_2018</span><span class="p">,</span>
    <span class="n">df_pop_fixed_2018</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span>
    <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df_2018</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          58
left_only      0
right_only     0
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-10">
<h3>Exercise 10<a class="headerlink" href="#exercise-10" title="Link to this heading">#</a></h3>
<p>Go ahead and calculate the arrest rates for the 2018 dataset as well. For each county, create a new variable called <code class="docutils literal notranslate"><span class="pre">violent_arrest_rate_2018</span></code> that is the number of violent arrests for 2018 divided by the population of the county from 2013-2017, and an analogous variable for drug offenses (<code class="docutils literal notranslate"><span class="pre">F_DRUGOFF</span></code>) called <code class="docutils literal notranslate"><span class="pre">f_drugoff_arrest_rate_2018</span></code>.</p>
<p><strong>For this and all following exercises, please calculate arrest rates as arrests per 1,000 people</strong>.</p>
<p>Calculate the average county-level felony drug arrest rate for 2018 (in arrests per 1,000) rounded to three significant places. <strong>Note this average value - you will need to submit this at the end of this week for the final Quiz.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2018</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_2018</span><span class="p">[</span><span class="s2">&quot;VIOLENT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_2018</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1_000</span>
<span class="p">)</span>
<span class="n">df_2018</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2018&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">df_2018</span><span class="p">[</span><span class="s2">&quot;F_DRUGOFF&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_2018</span><span class="p">[</span><span class="s2">&quot;total_population&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1_000</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Avg Felongy arrest rate in 2018 / 1,000&quot;</span>
    <span class="sa">f</span><span class="s2">&quot; is </span><span class="si">{</span><span class="n">df_2018</span><span class="p">[</span><span class="s1">&#39;f_drugoff_arrest_rate_2018&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Avg Felongy arrest rate in 2018 / 1,000 is 0.978
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="comparing-2009-with-2018-arrests-repeating-your-merge-from-the-2009-data">
<h2>Comparing 2009 with 2018 Arrests: Repeating your merge from the 2009 data<a class="headerlink" href="#comparing-2009-with-2018-arrests-repeating-your-merge-from-the-2009-data" title="Link to this heading">#</a></h2>
<p>If we plotted our rate data for 2009 (violent crime arrest rate vs felony drug arrest rate) it would show that drug arrests and violent crime arrests tend to be positively correlated, but that does not tell us much about whether they are <em>causally</em> related. It <em>could</em> be the case that people dealing drugs <em>causes</em> more violent crime, but it could also be that certain communities, for some other reason, tend to have <em>both</em> more drug sales <em>and</em> more violent crime.</p>
<p>So to test for this, we went to see if the same communities that had violent crime in 2009 <em>also</em> have violent crime in 2019 (after marijuana legalization). If these communities have just as much crime in 2018, that would suggest that violent crime is being driven by a third factor, and not drug sales of marijuana.</p>
<section id="exercise-11">
<h3>Exercise 11<a class="headerlink" href="#exercise-11" title="Link to this heading">#</a></h3>
<p>Merge the two county-level datasets so you have one row for each county, and variables for violent arrest rates in 2018, violent arrest rates in 2009, felony drug arrest rates in 2018, and felony drug arrest rates in 2009. You will need at least 5 columns from this going forward (you’re welcome to drop the rest for the remainder of the analysis):</p>
<ol class="arabic simple">
<li><p>COUNTY</p></li>
<li><p>violent_arrest_rate_2009</p></li>
<li><p>violent_arrest_rate_2018</p></li>
<li><p>f_drug_arrest_rate_2009</p></li>
<li><p>f_drug_arrest_rate_2018</p></li>
</ol>
<p><em>Hints and notes</em>:</p>
<ul class="simple">
<li><p>If you used <code class="docutils literal notranslate"><span class="pre">indicator</span> <span class="pre">=</span> <span class="pre">True</span></code>, you may need to drop the <code class="docutils literal notranslate"><span class="pre">_merge</span></code> columns before merging from each dataset</p></li>
<li><p>Since you’ll be merging two DataFrames with the same column names, when you merge them it will create two versions from each dataset, one from the first DataFrame you list in the merge (which will be appended with ‘_x’ in the column name and one from the second DataFrame you list in the merge which will be appended with ‘_y’ in the column name).</p></li>
<li><p>At any time you can use the <code class="docutils literal notranslate"><span class="pre">rename</span></code> method in pandas to adjust column names if it makes them easier for you to understand</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2009</span> <span class="o">=</span> <span class="n">df_2009</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;_merge&quot;</span><span class="p">)</span>
<span class="n">df_2018</span> <span class="o">=</span> <span class="n">df_2018</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;_merge&quot;</span><span class="p">)</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">df_2009</span><span class="p">,</span> <span class="n">df_2018</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s2">&quot;1:1&quot;</span><span class="p">,</span> <span class="n">indicator</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">df_all</span><span class="o">.</span><span class="n">_merge</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_merge
both          58
left_only      0
right_only     0
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0_x_x</th>
      <th>COUNTY</th>
      <th>VIOLENT_x</th>
      <th>PROPERTY_x</th>
      <th>F_DRUGOFF_x</th>
      <th>F_SEXOFF_x</th>
      <th>F_ALLOTHER_x</th>
      <th>F_TOTAL_x</th>
      <th>M_TOTAL_x</th>
      <th>S_TOTAL_x</th>
      <th>...</th>
      <th>F_TOTAL_y</th>
      <th>M_TOTAL_y</th>
      <th>S_TOTAL_y</th>
      <th>Unnamed: 0_y_y</th>
      <th>YEAR_y</th>
      <th>STATE_y</th>
      <th>total_population_y</th>
      <th>violent_arrest_rate_2018</th>
      <th>f_drugoff_arrest_rate_2018</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1682</td>
      <td>Alameda County</td>
      <td>4318</td>
      <td>4640</td>
      <td>5749</td>
      <td>260</td>
      <td>3502</td>
      <td>18469</td>
      <td>37247</td>
      <td>431</td>
      <td>...</td>
      <td>11037</td>
      <td>28305</td>
      <td>82</td>
      <td>186</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>1629615</td>
      <td>2.535568</td>
      <td>0.651688</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1683</td>
      <td>Alpine County</td>
      <td>8</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>16</td>
      <td>83</td>
      <td>0</td>
      <td>...</td>
      <td>11</td>
      <td>41</td>
      <td>0</td>
      <td>187</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>1203</td>
      <td>4.156276</td>
      <td>0.831255</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1684</td>
      <td>Amador County</td>
      <td>100</td>
      <td>59</td>
      <td>101</td>
      <td>5</td>
      <td>199</td>
      <td>464</td>
      <td>801</td>
      <td>2</td>
      <td>...</td>
      <td>288</td>
      <td>701</td>
      <td>1</td>
      <td>188</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>37306</td>
      <td>1.929984</td>
      <td>0.830966</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1685</td>
      <td>Butte County</td>
      <td>641</td>
      <td>602</td>
      <td>542</td>
      <td>34</td>
      <td>429</td>
      <td>2248</td>
      <td>9026</td>
      <td>1</td>
      <td>...</td>
      <td>2239</td>
      <td>8853</td>
      <td>1</td>
      <td>189</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>225207</td>
      <td>3.485682</td>
      <td>1.016842</td>
      <td>both</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1686</td>
      <td>Calaveras County</td>
      <td>211</td>
      <td>83</td>
      <td>123</td>
      <td>14</td>
      <td>70</td>
      <td>501</td>
      <td>968</td>
      <td>3</td>
      <td>...</td>
      <td>320</td>
      <td>897</td>
      <td>0</td>
      <td>190</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>45057</td>
      <td>3.262534</td>
      <td>0.643629</td>
      <td>both</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1735</td>
      <td>Tulare County</td>
      <td>2183</td>
      <td>2080</td>
      <td>1681</td>
      <td>170</td>
      <td>1767</td>
      <td>7881</td>
      <td>15368</td>
      <td>301</td>
      <td>...</td>
      <td>6596</td>
      <td>15163</td>
      <td>360</td>
      <td>239</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>458809</td>
      <td>5.060929</td>
      <td>2.029167</td>
      <td>both</td>
    </tr>
    <tr>
      <th>54</th>
      <td>1736</td>
      <td>Tuolumne County</td>
      <td>160</td>
      <td>252</td>
      <td>209</td>
      <td>14</td>
      <td>261</td>
      <td>896</td>
      <td>2062</td>
      <td>83</td>
      <td>...</td>
      <td>732</td>
      <td>2019</td>
      <td>12</td>
      <td>240</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>53899</td>
      <td>3.766304</td>
      <td>1.614130</td>
      <td>both</td>
    </tr>
    <tr>
      <th>55</th>
      <td>1737</td>
      <td>Ventura County</td>
      <td>2275</td>
      <td>2425</td>
      <td>2040</td>
      <td>120</td>
      <td>2083</td>
      <td>8943</td>
      <td>25762</td>
      <td>1734</td>
      <td>...</td>
      <td>6811</td>
      <td>26612</td>
      <td>630</td>
      <td>241</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>847834</td>
      <td>2.678590</td>
      <td>0.863377</td>
      <td>both</td>
    </tr>
    <tr>
      <th>56</th>
      <td>1738</td>
      <td>Yolo County</td>
      <td>585</td>
      <td>634</td>
      <td>614</td>
      <td>39</td>
      <td>662</td>
      <td>2534</td>
      <td>5426</td>
      <td>73</td>
      <td>...</td>
      <td>1586</td>
      <td>4602</td>
      <td>6</td>
      <td>242</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>212605</td>
      <td>2.704546</td>
      <td>0.564427</td>
      <td>both</td>
    </tr>
    <tr>
      <th>57</th>
      <td>1739</td>
      <td>Yuba County</td>
      <td>354</td>
      <td>368</td>
      <td>211</td>
      <td>39</td>
      <td>257</td>
      <td>1229</td>
      <td>2967</td>
      <td>4</td>
      <td>...</td>
      <td>1013</td>
      <td>1942</td>
      <td>0</td>
      <td>243</td>
      <td>2013-2017</td>
      <td>California</td>
      <td>74644</td>
      <td>5.238197</td>
      <td>2.197096</td>
      <td>both</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 32 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[</span>
    <span class="p">[</span>
        <span class="s2">&quot;COUNTY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">,</span>
        <span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">,</span>
        <span class="s2">&quot;f_drugoff_arrest_rate_2018&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTY</th>
      <th>violent_arrest_rate_2009</th>
      <th>violent_arrest_rate_2018</th>
      <th>f_drugoff_arrest_rate_2009</th>
      <th>f_drugoff_arrest_rate_2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alameda County</td>
      <td>2.963431</td>
      <td>2.535568</td>
      <td>3.945522</td>
      <td>0.651688</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alpine County</td>
      <td>6.938422</td>
      <td>4.156276</td>
      <td>1.734605</td>
      <td>0.831255</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Amador County</td>
      <td>2.628881</td>
      <td>1.929984</td>
      <td>2.655170</td>
      <td>0.830966</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Butte County</td>
      <td>2.941487</td>
      <td>3.485682</td>
      <td>2.487185</td>
      <td>1.016842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calaveras County</td>
      <td>4.532955</td>
      <td>3.262534</td>
      <td>2.642434</td>
      <td>0.643629</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Tulare County</td>
      <td>5.243827</td>
      <td>5.060929</td>
      <td>4.037963</td>
      <td>2.029167</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Tuolumne County</td>
      <td>2.869389</td>
      <td>3.766304</td>
      <td>3.748139</td>
      <td>1.614130</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Ventura County</td>
      <td>2.871340</td>
      <td>2.678590</td>
      <td>2.574740</td>
      <td>0.863377</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Yolo County</td>
      <td>3.031496</td>
      <td>2.704546</td>
      <td>3.181776</td>
      <td>0.564427</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Yuba County</td>
      <td>4.992525</td>
      <td>5.238197</td>
      <td>2.975771</td>
      <td>2.197096</td>
    </tr>
  </tbody>
</table>
<p>58 rows × 5 columns</p>
</div></div></div>
</div>
</section>
<section id="exercise-12">
<h3>Exercise 12<a class="headerlink" href="#exercise-12" title="Link to this heading">#</a></h3>
<p>Did drug arrests go down from 2009 to 2018? (they sure better! This is what’s called a “sanity check” of your data and analysis. If you find drug arrests went <em>up</em>, you know something went wrong with your code or your understanding of the situations. To verify this, compute the difference between the 2018 drug rate and that of 2009 and review those values sorted from smallest to largest. How many of the values were less than zero (meaning the rate decreased). For how many counties did the rate increase? Calculate the average percentage change in felony drug arrests across all counties.</p>
<p>As a reminder, percentage change can be calculated as follows where <span class="math notranslate nohighlight">\(x_{2018}\)</span> is the respective rate for the year 2018:
$<span class="math notranslate nohighlight">\(\frac{x_{2018} - x_{2009}}{x_{2009}} \times 100\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>COUNTY                        Alameda County
violent_arrest_rate_2009            2.963431
violent_arrest_rate_2018            2.535568
f_drugoff_arrest_rate_2009          3.945522
f_drugoff_arrest_rate_2018          0.651688
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percent_change</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2018&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">])</span>
    <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">]</span>
    <span class="o">*</span> <span class="mi">100</span>
<span class="p">)</span>
<span class="n">percent_change</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51   -94.758402
37   -89.374008
40   -85.903547
23   -85.745652
9    -85.495774
        ...    
16   -31.775924
57   -26.167177
24     1.608074
52    27.129014
17    28.153616
Length: 58, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Avg pct change in felony drug arrest rate: </span><span class="si">{</span><span class="n">percent_change</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Avg pct change in felony drug arrest rate: -66.31166718090417
</pre></div>
</div>
</div>
</div>
<p><strong>Note this average percentage change in the felony drug arrest rate value - you will need to submit this at the end of this week for the final Quiz.</strong></p>
</section>
<section id="exercise-13">
<h3>Exercise 13<a class="headerlink" href="#exercise-13" title="Link to this heading">#</a></h3>
<p>Now we want to look at whether violent crime decreased following drug legalization. Did the average violent arrest rate decrease? By how much? (Note: We’re assuming that arrest rates are proportionate to crime rates. If policing increased so that there were more arrests per crime committed, that would impact our interpretation of these results. But this is just an exercise, so we’ll keep it simple)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percent_change</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">])</span>
    <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">]</span>
    <span class="o">*</span> <span class="mi">100</span>
<span class="p">)</span>
<span class="n">percent_change</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21   -49.413863
37   -47.787617
12   -40.466548
1    -40.097672
14   -29.317117
        ...    
17    24.563705
13    26.602818
54    31.258036
24    42.683678
15    51.025472
Length: 58, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">percent_change</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-6.770989120747971)
</pre></div>
</div>
</div>
</div>
<p><strong>Note this average percentage change in the violent crime arrest rate value - you will need to submit this at the end of this week for the final Quiz.</strong></p>
</section>
</section>
<section id="diving-deeper-into-the-post-legalization-changes">
<h2>Diving deeper into the post-legalization changes<a class="headerlink" href="#diving-deeper-into-the-post-legalization-changes" title="Link to this heading">#</a></h2>
<section id="exercise-14">
<h3>Exercise 14<a class="headerlink" href="#exercise-14" title="Link to this heading">#</a></h3>
<p>So we’ve determined that both drug arrests and violent crime arrests were decreasing over this period. But maybe <em>all</em> crime was just falling, and this isn’t about drug legalization.</p>
<p>This is the problem with a “pre-to-post” analysis: yes, our results are <em>consistent</em> with the idea that drug legalization reduced violent crime, but lots of things happened between 2009 and 2018, not just drug legalization, so we don’t know that drug legalization <em>caused</em> the decline in violent crime.</p>
<p>So let’s do a kind of difference-in-difference analysis. We know that drug legalization should have had a bigger effect on counties that had higher drug arrest rates prior to drug legalization. After all, in a county that had no drug arrests, legalization wouldn’t do anything, would it?</p>
<p>So let’s split our sample into two groups: high drug arrests in 2009, and low drug arrests in 2009.</p>
<p>To decide who goes into each group, first calculate the average 2009 drug arrest rate across all counties. Then make the “high drug arrest” group counties whose 2009 drug arrest rate was above that mean value and make the “low drug arrest rate” counties whose 2009 drug arrest rate was above that mean value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">average</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">high_drug_arrests_2009</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">average</span><span class="p">]</span>
<span class="n">low_drug_arrests_2009</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;f_drugoff_arrest_rate_2009&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">average</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-15">
<h3>Exercise 15<a class="headerlink" href="#exercise-15" title="Link to this heading">#</a></h3>
<p>Now we can ask: did violent crime fall <em>more</em> from 2009 to 2018 in the counties that had lots of drug arrests in 2009 (where legalization likely had more of an effect) than in counties with fewer drug arrests in 2009 (where legalization likely mattered less)? Calculate this using what we call a difference-in-differences, which can be computed as follows:</p>
<p>(the change in violent crime rate for counties with lots of drug arrests in 2009) - (the change in violent crime rate for counties with few drug arrests in 2009)</p>
<p><strong>Please make sure to calculate arrest rates in arrests per 1,000 people.</strong></p>
<p><strong>Note this average value - you will need to submit this at the end of this week for the final Quiz.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">change_high</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">high_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">]</span>
    <span class="o">-</span> <span class="n">high_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">change_low</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">low_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">]</span>
    <span class="o">-</span> <span class="n">low_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">change_high</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">change_low</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Abs change for high: </span><span class="si">{</span><span class="n">change_high</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Abs change for low: </span><span class="si">{</span><span class="n">change_low</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diff in Diff: </span><span class="si">{</span><span class="n">change_high</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">change_low</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.43197415958967417
-0.18458037097611613
Abs change for high: -0.43197415958967417
Abs change for low: -0.18458037097611613
Diff in Diff: -0.24739378861355804
</pre></div>
</div>
</div>
</div>
<p><strong>Note your output here: the percentage change for the case of both the high and the low 2009 drug arrest rate groups in 2009 - you will need to submit this at the end of this week for the final Quiz.</strong></p>
</section>
<section id="execise-16">
<h3>Execise 16<a class="headerlink" href="#execise-16" title="Link to this heading">#</a></h3>
<p>Hmmm… we showed that there was a greater <em>absolute</em> decline in violent arrest rates in counties more impacted by drug legalization. But was there also a greater <em>proportionate</em> decline?</p>
<p>Repeat the above calculation but for percentage change:</p>
<p>(the percentage change in violent crime rate for counties with lots of drug arrests in 2009) - (the percentage change in violent crime rate for counties with few drug arrests in 2009)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">percent_change</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">x_base</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x_new</span> <span class="o">-</span> <span class="n">x_base</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_base</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pchange_high</span> <span class="o">=</span> <span class="n">percent_change</span><span class="p">(</span>
    <span class="n">high_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">],</span>
    <span class="n">high_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">pchange_low</span> <span class="o">=</span> <span class="n">percent_change</span><span class="p">(</span>
    <span class="n">low_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2018&quot;</span><span class="p">],</span>
    <span class="n">low_drug_arrests_2009</span><span class="p">[</span><span class="s2">&quot;violent_arrest_rate_2009&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pct change for high: </span><span class="si">{</span><span class="n">pchange_high</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pct change for low: </span><span class="si">{</span><span class="n">pchange_low</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Diff in Diff: </span><span class="si">{</span><span class="n">pchange_high</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pchange_low</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pct change for high: -9.736209750365193
Pct change for low: -4.822415564142366
Diff in Diff: -4.913794186222827
</pre></div>
</div>
</div>
</div>
<p><strong>Note your output here: the percentage change for the case of both the high and the low 2009 drug arrest rate groups in 2009 - you will need to submit this at the end of this week for the final Quiz.</strong></p>
</section>
<section id="exercise-17">
<h3>Exercise 17<a class="headerlink" href="#exercise-17" title="Link to this heading">#</a></h3>
<p>What are your conclusions about the relationship between violent crime and drug legalization, give your analysis above?</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/class_3/week_4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">EXERCISE SOLUTIONS: NOT FOR POSTING</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-data-to-understand-the-relationship-between-drug-legalization-and-violent-crime">Merging Data to Understand the Relationship between Drug Legalization and Violent Crime</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-our-data-pre-legalization">Loading our data pre-legalization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-our-data">Merging our data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-arrest-rates-and-gathering-2018-data">Calculating arrest rates and gathering 2018 data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-8">Exercise 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-9">Exercise 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10">Exercise 10</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-2009-with-2018-arrests-repeating-your-merge-from-the-2009-data">Comparing 2009 with 2018 Arrests: Repeating your merge from the 2009 data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11">Exercise 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-12">Exercise 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-13">Exercise 13</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diving-deeper-into-the-post-legalization-changes">Diving deeper into the post-legalization changes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-14">Exercise 14</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-15">Exercise 15</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#execise-16">Execise 16</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-17">Exercise 17</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kyle Bradbury & Nick Eubank
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>